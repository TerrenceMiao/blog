<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Terrence Miao&#39;s Adventures</title>
  
  <subtitle>A journey of a thousand miles begins with a single step</subtitle>
  <link href="https://terrencemiao.github.io/blog/atom.xml" rel="self"/>
  
  <link href="https://terrencemiao.github.io/blog/"/>
  <updated>2025-05-22T05:18:50.638Z</updated>
  <id>https://terrencemiao.github.io/blog/</id>
  
  <author>
    <name>Terrence Miao</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Proxmox over Bluetooth</title>
    <link href="https://terrencemiao.github.io/blog/2025/05/22/Proxmox-over-Bluetooth/"/>
    <id>https://terrencemiao.github.io/blog/2025/05/22/Proxmox-over-Bluetooth/</id>
    <published>2025-05-22T05:09:27.000Z</published>
    <updated>2025-05-22T05:18:50.638Z</updated>
    
    <content type="html"><![CDATA[<p>With <code>Proxmox</code> latest version <strong>8.4.1</strong> which has <em>WiFi 7 &#x2F; Bluetooth 5.4</em> support. A <strong>Intel® Wi-Fi 7 BE200</strong> network adapter <em><a href="https://www.intel.com/content/www/us/en/products/sku/230078/intel-wifi-7-be200/specifications.html">https://www.intel.com/content/www/us/en/products/sku/230078/intel-wifi-7-be200/specifications.html</a></em> is in action.</p><p>On <code>Proxmox</code> host, <strong>USB</strong> devices:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@mini:~# lsusb</span><br><span class="line">Bus 004 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub</span><br><span class="line">Bus 003 Device 006: ID 8087:0036 Intel Corp.</span><br><span class="line">Bus 003 Device 003: ID 0461:4e04 Primax Electronics, Ltd Lenovo Keyboard KB1021</span><br><span class="line">Bus 003 Device 002: ID 17ef:600e Lenovo Optical Mouse</span><br><span class="line">Bus 003 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</span><br><span class="line">Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub</span><br><span class="line">Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</span><br></pre></td></tr></table></figure><p><img src="/blog/img/Proxmox%20Bluetooth%20-%20USB%20mapping.png" alt="Proxmox Bluetooth - USB mapping" title="Proxmox Bluetooth - USB mapping"></p><p><img src="/blog/img/Proxmox%20Bluetooth%20-%20Resource%20Mappings.png" alt="Proxmox Bluetooth - Resource Mappings" title="Proxmox Bluetooth - Resource Mappings"></p><p><img src="/blog/img/Proxmox%20Bluetooth%20-%20USB%20Device.png" alt="Proxmox Bluetooth - USB Device" title="Proxmox Bluetooth - USB Device"></p><p><img src="/blog/img/Proxmox%20Bluetooth%20-%20Add%20Device.png" alt="Proxmox Bluetooth - Add Device" title="Proxmox Bluetooth - Add Device"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;With &lt;code&gt;Proxmox&lt;/code&gt; latest version &lt;strong&gt;8.4.1&lt;/strong&gt; which has &lt;em&gt;WiFi 7 &amp;#x2F; Bluetooth 5.4&lt;/em&gt; support. A &lt;strong&gt;Intel® </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Proxmox over Wireless</title>
    <link href="https://terrencemiao.github.io/blog/2025/05/21/Proxmox-over-Wireless/"/>
    <id>https://terrencemiao.github.io/blog/2025/05/21/Proxmox-over-Wireless/</id>
    <published>2025-05-21T01:16:37.000Z</published>
    <updated>2025-05-21T02:03:28.253Z</updated>
    
    <content type="html"><![CDATA[<p>With <code>Proxmox</code> latest version <strong>8.4.1</strong> which has <em>WiFi 7</em> support. A <strong>Intel® Wi-Fi 7 BE200</strong> network adapter <em><a href="https://www.intel.com/content/www/us/en/products/sku/230078/intel-wifi-7-be200/specifications.html">https://www.intel.com/content/www/us/en/products/sku/230078/intel-wifi-7-be200/specifications.html</a></em> is in action.</p><p>Setup wireless network as main network for <code>Proxmox</code>. <strong>TP-Link Deco BE85&#x2F;BE95 Mesh WiFi 7 System</strong> as the Access Point, with DHCP enabled for the clients.</p><p>On <code>Proxmox</code> host, PCI devices:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">root@mini:~# lspci</span><br><span class="line">00:00.0 Host bridge: Intel Corporation Device 4617</span><br><span class="line">00:02.0 VGA compatible controller: Intel Corporation Alder Lake-N [UHD Graphics]</span><br><span class="line">...</span><br><span class="line">00:02.7 VGA compatible controller: Intel Corporation Alder Lake-N [UHD Graphics]</span><br><span class="line">00:0d.0 USB controller: Intel Corporation Alder Lake-N Thunderbolt 4 USB Controller</span><br><span class="line">00:14.0 USB controller: Intel Corporation Alder Lake-N PCH USB 3.2 xHCI Host Controller</span><br><span class="line">00:14.2 RAM memory: Intel Corporation Alder Lake-N PCH Shared SRAM</span><br><span class="line">00:16.0 Communication controller: Intel Corporation Alder Lake-N PCH HECI Controller</span><br><span class="line">00:17.0 SATA controller: Intel Corporation Alder Lake-N SATA AHCI Controller</span><br><span class="line">00:1c.0 PCI bridge: Intel Corporation Alder Lake-N PCI Express Root Port</span><br><span class="line">00:1c.6 PCI bridge: Intel Corporation Alder Lake-N PCI Express Root Port</span><br><span class="line">00:1d.0 PCI bridge: Intel Corporation Alder Lake-N PCI Express Root Port</span><br><span class="line">00:1d.1 PCI bridge: Intel Corporation Alder Lake-N PCI Express Root Port</span><br><span class="line">00:1d.3 PCI bridge: Intel Corporation Alder Lake-N PCI Express Root Port</span><br><span class="line">00:1f.0 ISA bridge: Intel Corporation Alder Lake-N PCH eSPI Controller</span><br><span class="line">00:1f.3 Multimedia audio controller: Intel Corporation Alder Lake-N PCH High Definition Audio Controller</span><br><span class="line">00:1f.4 SMBus: Intel Corporation Alder Lake-N SMBus</span><br><span class="line">00:1f.5 Serial bus controller: Intel Corporation Alder Lake-N SPI (flash) Controller</span><br><span class="line">01:00.0 Ethernet controller: Intel Corporation 82599ES 10-Gigabit SFI/SFP+ Network Connection (rev 01)</span><br><span class="line">01:00.1 Ethernet controller: Intel Corporation 82599ES 10-Gigabit SFI/SFP+ Network Connection (rev 01)</span><br><span class="line">01:10.0 Ethernet controller: Intel Corporation 82599 Ethernet Controller Virtual Function (rev 01)</span><br><span class="line">...</span><br><span class="line">01:10.7 Ethernet controller: Intel Corporation 82599 Ethernet Controller Virtual Function (rev 01)</span><br><span class="line">01:11.0 Ethernet controller: Intel Corporation 82599 Ethernet Controller Virtual Function (rev 01)</span><br><span class="line">...</span><br><span class="line">01:11.7 Ethernet controller: Intel Corporation 82599 Ethernet Controller Virtual Function (rev 01)</span><br><span class="line">02:00.0 Ethernet controller: Intel Corporation Ethernet Controller I226-V (rev 04)</span><br><span class="line">03:00.0 Ethernet controller: Intel Corporation Ethernet Controller I226-V (rev 04)</span><br><span class="line">04:00.0 Network controller: Intel Corporation Wi-Fi 7(802.11be) AX1775*/AX1790*/BE20*/BE401/BE1750* 2x2 (rev 1a)</span><br><span class="line">05:00.0 Non-Volatile memory controller: Micron/Crucial Technology T500 NVMe PCIe SSD (rev 01)</span><br></pre></td></tr></table></figure><p>network interfaces:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">root@mini:~# cat /etc/network/interfaces</span><br><span class="line">auto lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line"></span><br><span class="line">iface enp2s0 inet manual</span><br><span class="line">iface enp3s0 inet manual</span><br><span class="line"></span><br><span class="line">iface enp1s0f0 inet manual</span><br><span class="line">iface enp1s0f1 inet manual</span><br><span class="line"></span><br><span class="line">iface enp1s0f0v0 inet manual</span><br><span class="line">...</span><br><span class="line">iface enp1s0f0v7 inet manual</span><br><span class="line"></span><br><span class="line">iface enp1s0f1v0 inet manual</span><br><span class="line">...</span><br><span class="line">iface enp1s0f1v7 inet manual</span><br><span class="line"></span><br><span class="line">auto wlp4s0f0</span><br><span class="line">iface wlp4s0f0 inet dhcp</span><br><span class="line">        wpa-ssid &quot;igloo studio&quot;</span><br><span class="line">        wpa-psk &quot;igloo studio password&quot;</span><br><span class="line"></span><br><span class="line">auto vmbr0</span><br><span class="line">iface vmbr0 inet static</span><br><span class="line">        address 10.0.1.1/24</span><br><span class="line">        bridge-ports none</span><br><span class="line">        bridge-stp off</span><br><span class="line">        bridge-fd 0</span><br><span class="line"></span><br><span class="line">        # Enable IP forwarding</span><br><span class="line">        post-up echo 1 &gt; /proc/sys/net/ipv4/ip_forward</span><br><span class="line"></span><br><span class="line">        # Allow all forwarding from VM network to WAN</span><br><span class="line">        post-up   iptables -A FORWARD -i vmbr0 -o wlp4s0f0 -j ACCEPT</span><br><span class="line">        post-down iptables -D FORWARD -i vmbr0 -o wlp4s0f0 -j ACCEPT</span><br><span class="line"></span><br><span class="line">        # Single NAT rule for all traffic</span><br><span class="line">        post-up   iptables -t nat -A POSTROUTING -s &#x27;10.0.1.0/24&#x27; -o wlp4s0f0 -j MASQUERADE</span><br><span class="line">        post-down iptables -t nat -D POSTROUTING -s &#x27;10.0.1.0/24&#x27; -o wlp4s0f0 -j MASQUERADE</span><br><span class="line"></span><br><span class="line">auto vmbr1</span><br><span class="line">iface vmbr1 inet manual</span><br><span class="line">        bridge-ports enp1s0f0</span><br><span class="line">        bridge-stp off</span><br><span class="line">        bridge-fd 0</span><br><span class="line"></span><br><span class="line">auto vmbr2</span><br><span class="line">iface vmbr2 inet manual</span><br><span class="line">        bridge-ports enp1s0f1</span><br><span class="line">        bridge-stp off</span><br><span class="line">        bridge-fd 0</span><br><span class="line"></span><br><span class="line">source /etc/network/interfaces.d/*</span><br></pre></td></tr></table></figure><p><code>dnsmasq</code> for VMs’ DNS and DHCP management:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@mini:~# cat /etc/dnsmasq.conf</span><br><span class="line">...</span><br><span class="line">## Proxmox</span><br><span class="line"># Hosts dnsmasq on vmbr0</span><br><span class="line">interface=vmbr0</span><br><span class="line"></span><br><span class="line"># The IP-address range that should be used for the clients (virtual machines/containers):</span><br><span class="line"># dhcp-range=first_available_ip, last_available_ip, net_mask, lease_time (&lt;number&gt;h)</span><br><span class="line">dhcp-range=10.0.1.100, 10.0.1.200, 255.255.255.0, 12h</span><br><span class="line"></span><br><span class="line"># Just making sure dnsmasq knows the routers IP-address</span><br><span class="line"># dhcp-option=3,vmbr0_ip</span><br><span class="line">dhcp-option=3,10.0.1.1</span><br></pre></td></tr></table></figure><p><code>Proxmox</code> host allocated wireless IP e.g. <code>192.168.68.58</code>. Set this IP in <strong>&#x2F;etc&#x2F;hosts</strong>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@mini:~# cat /etc/hosts</span><br><span class="line">127.0.0.1 localhost.localdomain localhost</span><br><span class="line">192.168.68.58 mini.local mini</span><br><span class="line"></span><br><span class="line"># The following lines are desirable for IPv6 capable hosts</span><br><span class="line"></span><br><span class="line">::1     ip6-localhost ip6-loopback</span><br><span class="line">fe00::0 ip6-localnet</span><br><span class="line">ff00::0 ip6-mcastprefix</span><br><span class="line">ff02::1 ip6-allnodes</span><br><span class="line">ff02::2 ip6-allrouters</span><br><span class="line">ff02::3 ip6-allhosts</span><br></pre></td></tr></table></figure><p>then access <code>Proxmox</code> web UI via URL <strong><a href="https://192.168.68.58:8006/">https://192.168.68.58:8006</a></strong>.</p><p>Reboot <code>Proxmox</code> host:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">root@mini:~# ip a</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host noprefixroute</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: enp2s0: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000</span><br><span class="line">    link/ether a8:b8:e0:05:96:4f brd ff:ff:ff:ff:ff:ff</span><br><span class="line">3: enp3s0: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000</span><br><span class="line">    link/ether a8:b8:e0:05:96:50 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">4: enp1s0f0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq master vmbr1 state UP group default qlen 1000</span><br><span class="line">    link/ether a8:b8:e0:05:96:4d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">5: enp1s0f1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq master vmbr2 state UP group default qlen 1000</span><br><span class="line">    link/ether a8:b8:e0:05:96:4e brd ff:ff:ff:ff:ff:ff</span><br><span class="line">7: enp1s0f0v1: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000</span><br><span class="line">    link/ether de:11:ed:5f:a6:d5 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">...</span><br><span class="line">13: enp1s0f0v7: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000</span><br><span class="line">    link/ether 3e:45:70:0c:fd:98 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">14: enp1s0f1v0: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000</span><br><span class="line">    link/ether 06:72:73:c2:7a:fc brd ff:ff:ff:ff:ff:ff</span><br><span class="line">...</span><br><span class="line">21: enp1s0f1v7: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000</span><br><span class="line">    link/ether 6a:06:68:af:7a:dc brd ff:ff:ff:ff:ff:ff</span><br><span class="line">22: wlp4s0f0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    link/ether e0:8f:4c:b2:58:95 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.68.58/22 brd 192.168.71.255 scope global dynamic wlp4s0f0</span><br><span class="line">       valid_lft 3800sec preferred_lft 3800sec</span><br><span class="line">    inet6 fda5:9d5d:ff57:10:e28f:4cff:feb2:5895/64 scope global dynamic mngtmpaddr</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 2403:5802:8c44:10:e28f:4cff:feb2:5895/64 scope global dynamic mngtmpaddr</span><br><span class="line">       valid_lft 5371sec preferred_lft 1768sec</span><br><span class="line">    inet6 fe80::e28f:4cff:feb2:5895/64 scope link</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">23: vmbr0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default qlen 1000</span><br><span class="line">    link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.0.1.1/24 scope global vmbr0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::643d:cdff:fe59:f79/64 scope link</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">24: vmbr1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    link/ether a8:b8:e0:05:96:4d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet6 fda5:9d5d:ff57:10:aab8:e0ff:fe05:964d/64 scope global dynamic mngtmpaddr</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 2403:5802:8c44:10:aab8:e0ff:fe05:964d/64 scope global dynamic mngtmpaddr</span><br><span class="line">       valid_lft 5372sec preferred_lft 1768sec</span><br><span class="line">    inet6 fe80::aab8:e0ff:fe05:964d/64 scope link</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">25: vmbr2: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    link/ether a8:b8:e0:05:96:4e brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet6 fda5:9d5d:ff57:10:aab8:e0ff:fe05:964e/64 scope global dynamic mngtmpaddr</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 2403:5802:8c44:10:aab8:e0ff:fe05:964e/64 scope global dynamic mngtmpaddr</span><br><span class="line">       valid_lft 5372sec preferred_lft 1768sec</span><br><span class="line">    inet6 fe80::aab8:e0ff:fe05:964e/64 scope link</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure><p><code>Proxmox</code> Network settings:</p><p><img src="/blog/img/Proxmox%20Wireless%20-%20Network.png" alt="Proxmox Wireless - Network" title="Proxmox Wireless - Network"></p><p><strong>Linux&#x2F;Ubuntu VM</strong> in <code>Proxmox</code>:</p><p><img src="/blog/img/Proxmox%20Wireless%20-%20Ubuntu%20VM.png" alt="Proxmox Wireless - Ubuntu VM" title="Proxmox Wireless - Ubuntu VM"></p><p><strong>Windows VM</strong> in <code>Proxmox</code>:</p><p><img src="/blog/img/Proxmox%20Wireless%20-%20Windows%20VM.png" alt="Proxmox Wireless - Windows VM" title="Proxmox Wireless - Windows VM"></p><p><strong>Windows VM</strong> in <code>Proxmox</code>‘s network:</p><p><img src="/blog/img/Proxmox%20Wireless%20-%20Windows%20VM%20Network.png" alt="Proxmox Wireless - Windows VM Network" title="Proxmox Wireless - Windows VM Network"></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>Setting Up Proxmox on a Laptop Without an Ethernet Port <em><a href="https://dev.to/varungujarathi9/setting-up-proxmox-on-a-laptop-without-an-ethernet-port-28n8">https://dev.to/varungujarathi9/setting-up-proxmox-on-a-laptop-without-an-ethernet-port-28n8</a></em></li><li>Setting up Proxmox over wifi <em><a href="https://github.com/ThomasRives/Proxmox-over-wifi">https://github.com/ThomasRives/Proxmox-over-wifi</a></em></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;With &lt;code&gt;Proxmox&lt;/code&gt; latest version &lt;strong&gt;8.4.1&lt;/strong&gt; which has &lt;em&gt;WiFi 7&lt;/em&gt; support. A &lt;strong&gt;Intel® Wi-Fi 7 BE200&lt;/strong</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ZeroTier on TrueNAS Scale</title>
    <link href="https://terrencemiao.github.io/blog/2025/01/25/ZeroTier-on-TrueNAS-Scale/"/>
    <id>https://terrencemiao.github.io/blog/2025/01/25/ZeroTier-on-TrueNAS-Scale/</id>
    <published>2025-01-25T02:01:25.000Z</published>
    <updated>2025-01-25T02:22:58.535Z</updated>
    
    <content type="html"><![CDATA[<p>Step by steyp to install <code>ZeroTier</code> on <code>TrueNAS Scale</code>.</p><p>Latest version <code>TrueNAS Scale</code> <strong>ElectricEel 24.10</strong>:</p><p><img src="/blog/img/ZeroTier%20-%20TrueNAS.png" alt="ZeroTier - TrueNAS" title="ZeroTier - TrueNAS"></p><p>Add <code>ZeroTier</code> <strong>Network ID</strong>; enable <strong>Host Network</strong>; leave <strong>Auth Token</strong>, <strong>Identity Public</strong> and <strong>Identity Secret</strong> empty:</p><p><img src="/blog/img/ZeroTier%20-%20Configuration.png" alt="ZeroTier - Configuration" title="ZeroTier - Configuration"></p><p>On <code>ZeroTier</code> console, authorise <code>TrueNAS</code> access the network:</p><p><img src="/blog/img/ZeroTier%20-%20Network.png" alt="ZeroTier - Network" title="ZeroTier - Network"></p><p><code>ZeroTier</code> is happily running in <code>TrueNAS</code>:</p><p><img src="/blog/img/ZeroTier%20-%20Running.png" alt="ZeroTier - Running" title="ZeroTier - Running"></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>How to install zerotier on TrueNas Scale? <em><a href="https://www.reddit.com/r/truenas/comments/1dvdp36/how_to_install_zerotier_on_truenas_scale/">https://www.reddit.com/r/truenas/comments/1dvdp36/how_to_install_zerotier_on_truenas_scale/</a></em></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Step by steyp to install &lt;code&gt;ZeroTier&lt;/code&gt; on &lt;code&gt;TrueNAS Scale&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Latest version &lt;code&gt;TrueNAS Scale&lt;/code&gt; &lt;strong&gt;El</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Xray, X-UI, Reality protocol, Vision flow on Oracle Cloud</title>
    <link href="https://terrencemiao.github.io/blog/2025/01/22/Xray-X-UI-Reality-protocol-Vision-flow-on-Oracle-Cloud/"/>
    <id>https://terrencemiao.github.io/blog/2025/01/22/Xray-X-UI-Reality-protocol-Vision-flow-on-Oracle-Cloud/</id>
    <published>2025-01-22T02:34:40.000Z</published>
    <updated>2025-01-22T12:00:01.897Z</updated>
    
    <content type="html"><![CDATA[<p><code>Oracle Cloud</code> instance, which runs <code>Oracle Linux</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -i .ssh/id_rsa_ -l opc 19.214.86.113</span><br><span class="line"></span><br><span class="line">$ sudo -i</span><br><span class="line">[root@apocalypse ~]#</span><br></pre></td></tr></table></figure><p>Install <code>X-UI</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">[root@apocalypse ~]# bash &lt;(curl -Ls https://raw.githubusercontent.com/FranzKafkaYu/x-ui/master/install_en.sh)</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">2025-01-21 23:05:50 (100 MB/s) - ‘/usr/bin/x-ui’ saved [25637/25637]</span><br><span class="line"></span><br><span class="line">Install/update finished need to modify panel settings out of security</span><br><span class="line">are you continue,if you type n will skip this at this time[y/n]: y</span><br><span class="line">please set up your username: admin</span><br><span class="line">your username will be: admin</span><br><span class="line">please set up your password: password</span><br><span class="line">your password will be: password</span><br><span class="line">please set up the panel port: 10080</span><br><span class="line">your panel port is: 10080</span><br><span class="line">initializing,wait some time here...</span><br><span class="line">set username and password success</span><br><span class="line">account name and password set down!</span><br><span class="line">set port 10080 successpanel port set down!</span><br><span class="line">x-ui v0.3.4.4 install finished,it is working now...</span><br><span class="line"></span><br><span class="line">x-ui control menu usages: </span><br><span class="line">----------------------------------------------</span><br><span class="line">x-ui              - Enter     control menu</span><br><span class="line">x-ui start        - Start     x-ui </span><br><span class="line">x-ui stop         - Stop      x-ui </span><br><span class="line">x-ui restart      - Restart   x-ui </span><br><span class="line">x-ui status       - Show      x-ui status</span><br><span class="line">x-ui enable       - Enable    x-ui on system startup</span><br><span class="line">x-ui disable      - Disable   x-ui on system startup</span><br><span class="line">x-ui log          - Check     x-ui logs</span><br><span class="line">x-ui update       - Update    x-ui </span><br><span class="line">x-ui install      - Install   x-ui </span><br><span class="line">x-ui uninstall    - Uninstall x-ui </span><br><span class="line">x-ui geo          - Update    geo  data</span><br><span class="line">----------------------------------------------</span><br></pre></td></tr></table></figure><p>Find the root path of <code>X-UI</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">[root@ip-237-45-6-183 ~]# x-ui</span><br><span class="line"></span><br><span class="line">  x-ui control menu</span><br><span class="line">  0. exit</span><br><span class="line">————————————————</span><br><span class="line">  1. install   x-ui</span><br><span class="line">  2. update    x-ui</span><br><span class="line">  3. uninstall x-ui</span><br><span class="line">————————————————</span><br><span class="line">  4. reset username</span><br><span class="line">  5. reset panel</span><br><span class="line">  6. reset panel port</span><br><span class="line">  7. check panel info</span><br><span class="line">————————————————</span><br><span class="line">  8. start x-ui</span><br><span class="line">  9. stop  x-ui</span><br><span class="line">  10. restart x-ui</span><br><span class="line">  11. check x-ui status</span><br><span class="line">  12. check x-ui logs</span><br><span class="line">————————————————</span><br><span class="line">  13. enable  x-ui on system startup</span><br><span class="line">  14. disable x-ui on system startup</span><br><span class="line">————————————————</span><br><span class="line">  15. enable bbr </span><br><span class="line">  16. issuse certs</span><br><span class="line">  17. x-ui cron jobs</span><br><span class="line"> </span><br><span class="line">x-ui status: running</span><br><span class="line">enable on system startup: yes</span><br><span class="line">xray status: running</span><br><span class="line"></span><br><span class="line">please input a legal number[0-16],input 7 for checking login info:7</span><br><span class="line">[INF] 当前面板信息[current panel info]:</span><br><span class="line">面板版本[version]: 0.3.4.4:20230717</span><br><span class="line">用户名[username]: admin</span><br><span class="line">密码[userpasswd]: password</span><br><span class="line">监听端口[port]: 10080</span><br><span class="line">根路径[rootPath]: /xui/ </span><br></pre></td></tr></table></figure><p>Add new Inbound:</p><p><img src="/blog/img/X-UI%20-%20Oracle%20Cloud%20Inbound.png" alt="X-UI - Oracle Cloud Inbound" title="X-UI - Oracle Cloud Inbound"></p><p>Open <code>X-UI</code> panel port and <code>VLESS</code> port in <code>Oracle Cloud</code> firewall:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@apocalypse ~]# firewall-cmd --zone=public --permanent --add-port=10080/tcp</span><br><span class="line">success</span><br><span class="line"></span><br><span class="line">[root@apocalypse ~]# firewall-cmd --zone=public --permanent --add-port=32854/tcp</span><br><span class="line">success</span><br><span class="line"></span><br><span class="line">[root@apocalypse ~]# firewall-cmd --reload</span><br><span class="line">success</span><br></pre></td></tr></table></figure><p>Open <code>X-UI</code> panel port and <code>VLESS</code> port in <code>Oracle Cloud</code> <strong>Security List Ingress Rules</strong>:</p><p><img src="/blog/img/X-UI%20-%20Oracle%20Cloud.png" alt="X-UI - Oracle Cloud" title="X-UI - Oracle Cloud"></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>Host an XTLS Vless+Vision+REALITY server on Oracle Always Free <em><a href="https://iopq.wordpress.com/2024/02/27/host-an-xtls-vlessvisionreality-server-on-oracle/">https://iopq.wordpress.com/2024/02/27/host-an-xtls-vlessvisionreality-server-on-oracle/</a></em></li><li>Oracle Database Cloud — Open Ports on OCI <em><a href="https://medium.com/@fathi.ria/oracle-database-cloud-open-ports-on-oci-1af24f4eb9f2">https://medium.com/@fathi.ria/oracle-database-cloud-open-ports-on-oci-1af24f4eb9f2</a></em></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;Oracle Cloud&lt;/code&gt; instance, which runs &lt;code&gt;Oracle Linux&lt;/code&gt;:&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;g</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Xray, X-UI, Reality protocol, Vision flow on Amazon Linux</title>
    <link href="https://terrencemiao.github.io/blog/2025/01/22/Xray-X-UI-Reality-protocol-Vision-flow-on-Amazon-Linux/"/>
    <id>https://terrencemiao.github.io/blog/2025/01/22/Xray-X-UI-Reality-protocol-Vision-flow-on-Amazon-Linux/</id>
    <published>2025-01-21T22:48:08.000Z</published>
    <updated>2025-01-22T01:00:58.719Z</updated>
    
    <content type="html"><![CDATA[<p>AWS EC2 instance, which runs <code>Amazon Linux</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -i .ssh/aws-free-tier.pem -l ec2-user ec2-203-129-56-97.ap-southeast-2.compute.amazonaws.com</span><br><span class="line">   ,     #_</span><br><span class="line">   ~\_  ####_        Amazon Linux 2023</span><br><span class="line">  ~~  \_#####\</span><br><span class="line">  ~~     \###|</span><br><span class="line">  ~~       \#/ ___   https://aws.amazon.com/linux/amazon-linux-2023</span><br><span class="line">   ~~       V~&#x27; &#x27;-&gt;</span><br><span class="line">    ~~~         /</span><br><span class="line">      ~~._.   _/</span><br><span class="line">         _/ _/</span><br><span class="line">       _/m/&#x27;</span><br><span class="line"></span><br><span class="line">$ sudo -i</span><br><span class="line">[root@ip-237-45-6-183 ~]#</span><br></pre></td></tr></table></figure><p>Install <code>X-UI</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">[root@ip-237-45-6-183 ~]# bash &lt;(curl -Ls https://raw.githubusercontent.com/FranzKafkaYu/x-ui/master/install_en.sh)</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">2025-01-21 23:05:50 (100 MB/s) - ‘/usr/bin/x-ui’ saved [25637/25637]</span><br><span class="line"></span><br><span class="line">Install/update finished need to modify panel settings out of security</span><br><span class="line">are you continue,if you type n will skip this at this time[y/n]: y</span><br><span class="line">please set up your username: admin</span><br><span class="line">your username will be: admin</span><br><span class="line">please set up your password: password</span><br><span class="line">your password will be: password</span><br><span class="line">please set up the panel port: 10080</span><br><span class="line">your panel port is: 10080</span><br><span class="line">initializing,wait some time here...</span><br><span class="line">set username and password success</span><br><span class="line">account name and password set down!</span><br><span class="line">set port 10080 successpanel port set down!</span><br><span class="line">x-ui v0.3.4.4 install finished,it is working now...</span><br><span class="line"></span><br><span class="line">x-ui control menu usages: </span><br><span class="line">----------------------------------------------</span><br><span class="line">x-ui              - Enter     control menu</span><br><span class="line">x-ui start        - Start     x-ui </span><br><span class="line">x-ui stop         - Stop      x-ui </span><br><span class="line">x-ui restart      - Restart   x-ui </span><br><span class="line">x-ui status       - Show      x-ui status</span><br><span class="line">x-ui enable       - Enable    x-ui on system startup</span><br><span class="line">x-ui disable      - Disable   x-ui on system startup</span><br><span class="line">x-ui log          - Check     x-ui logs</span><br><span class="line">x-ui update       - Update    x-ui </span><br><span class="line">x-ui install      - Install   x-ui </span><br><span class="line">x-ui uninstall    - Uninstall x-ui </span><br><span class="line">x-ui geo          - Update    geo  data</span><br><span class="line">----------------------------------------------</span><br></pre></td></tr></table></figure><p>Change AWS security group, and open EC2 instance port <code>10080</code> to admin user’s IP address only.</p><p>Find the root path of <code>X-UI</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">[root@ip-237-45-6-183 ~]# x-ui</span><br><span class="line"></span><br><span class="line">  x-ui control menu</span><br><span class="line">  0. exit</span><br><span class="line">————————————————</span><br><span class="line">  1. install   x-ui</span><br><span class="line">  2. update    x-ui</span><br><span class="line">  3. uninstall x-ui</span><br><span class="line">————————————————</span><br><span class="line">  4. reset username</span><br><span class="line">  5. reset panel</span><br><span class="line">  6. reset panel port</span><br><span class="line">  7. check panel info</span><br><span class="line">————————————————</span><br><span class="line">  8. start x-ui</span><br><span class="line">  9. stop  x-ui</span><br><span class="line">  10. restart x-ui</span><br><span class="line">  11. check x-ui status</span><br><span class="line">  12. check x-ui logs</span><br><span class="line">————————————————</span><br><span class="line">  13. enable  x-ui on system startup</span><br><span class="line">  14. disable x-ui on system startup</span><br><span class="line">————————————————</span><br><span class="line">  15. enable bbr </span><br><span class="line">  16. issuse certs</span><br><span class="line">  17. x-ui cron jobs</span><br><span class="line"> </span><br><span class="line">x-ui status: running</span><br><span class="line">enable on system startup: yes</span><br><span class="line">xray status: running</span><br><span class="line"></span><br><span class="line">please input a legal number[0-16],input 7 for checking login info:7</span><br><span class="line">[INF] 当前面板信息[current panel info]:</span><br><span class="line">面板版本[version]: 0.3.4.4:20230717</span><br><span class="line">用户名[username]: admin</span><br><span class="line">密码[userpasswd]: password</span><br><span class="line">监听端口[port]: 10080</span><br><span class="line">根路径[rootPath]: /WMa7/ </span><br></pre></td></tr></table></figure><p>In <code>Firefox</code>, go to <em><a href="http://203.129.56.97:10080/WMa7/">http://203.129.56.97:10080/WMa7/</a></em> and login as <strong>admin</strong> user:</p><p><img src="/blog/img/X-UI%20-%20Login.png" alt="X-UI - Login" title="X-UI - Login"></p><p><img src="/blog/img/X-UI%20-%20Panel.png" alt="X-UI - Panel" title="X-UI - Panel"></p><p>Switch to the latest version <code>Xray</code> e.g. <code>v24.12.31</code>:</p><p><img src="/blog/img/X-UI%20-%20Xray.png" alt="X-UI - Xray" title="X-UI - Xray"></p><p>Add new Inbound:</p><p><img src="/blog/img/X-UI%20-%20Inbound.png" alt="X-UI - Inbound" title="X-UI - Inbound"></p><p>Open up port <strong>32609</strong> to the world <strong>0.0.0.0&#x2F;0</strong> in AWS security group.</p><p>Copy inbound QR link:</p><p><img src="/blog/img/X-UI%20-%20QR.png" alt="X-UI - QR" title="X-UI - QR"></p><p><img src="/blog/img/X-UI%20-%20QR%20Link.png" alt="X-UI - QR Link" title="X-UI - QR Link"></p><p>and paste to <code>Xray</code> Windows client e.g. <code>v2rayN</code>:</p><p><img src="/blog/img/X-UI%20-%20v2rayN.png" alt="X-UI - v2rayN" title="X-UI - v2rayN"></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>无敌的 Xray – Reality 协议！Vless + Reality协议 + Vision流控，是否能够摆平一切顾虑！ <em><a href="https://v2rayssr.com/reality.html">https://v2rayssr.com/reality.html</a></em></li><li>波仔分享 - 无敌的 Xray - Reality 协议！无须域名和证书的 Reality 协议 + Vision 流控，是否能够摆平一切顾虑！Reality 指向网站寻找，Reality 客户端推荐（关联节点搭建&#x2F;科学上网）<em><a href="https://www.youtube.com/watch?v=DO1_C9YWOYY">https://www.youtube.com/watch?v=DO1_C9YWOYY</a></em></li><li>x-ui <em><a href="https://github.com/FranzKafkaYu/x-ui/">https://github.com/FranzKafkaYu/x-ui/</a></em></li><li>Qualys. SSL Labs <em><a href="https://www.ssllabs.com/ssltest/index.html">https://www.ssllabs.com/ssltest/index.html</a></em></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;AWS EC2 instance, which runs &lt;code&gt;Amazon Linux&lt;/code&gt;:&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>How to install and run Tailscale client on OpenWrt</title>
    <link href="https://terrencemiao.github.io/blog/2024/12/21/How-to-install-and-run-Tailscale-client-on-OpenWrt/"/>
    <id>https://terrencemiao.github.io/blog/2024/12/21/How-to-install-and-run-Tailscale-client-on-OpenWrt/</id>
    <published>2024-12-21T03:44:32.000Z</published>
    <updated>2024-12-21T04:37:43.032Z</updated>
    
    <content type="html"><![CDATA[<p>Install <code>Tailscale</code> package <strong>iptables-nft</strong> and <strong>tailscale</strong> from <code>OpenWrt</code> console:</p><p><img src="/blog/img/OpenWrt%20-%20Tailscale%20iptables-nft.png" alt="OpenWrt - Tailscale iptables-nft" title="OpenWrt - Tailscale iptables-nft"></p><p><img src="/blog/img/OpenWrt%20-%20Tailscale.png" alt="OpenWrt - Tailscale" title="OpenWrt - Tailscale"></p><p>Enable and connect <code>Tailscale</code> service in <code>OpenWrt</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -l root SenseWrt</span><br><span class="line">root@SenseWrt&#x27;s password: </span><br><span class="line"></span><br><span class="line">BusyBox v1.36.1 (2024-12-03 11:41:08 UTC) built-in shell (ash)</span><br><span class="line"></span><br><span class="line">  _______                     ________        __</span><br><span class="line"> |       |.-----.-----.-----.|  |  |  |.----.|  |_</span><br><span class="line"> |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|</span><br><span class="line"> |_______||   __|_____|__|__||________||__|  |____|</span><br><span class="line">          |__| W I R E L E S S   F R E E D O M</span><br><span class="line"> -----------------------------------------------------</span><br><span class="line"> OpenWrt 24.10.0-rc2, r28161-ea17e958b9</span><br><span class="line"> -----------------------------------------------------</span><br><span class="line"> </span><br><span class="line">root@SenseWrt:~# tailscale up --netfilter-mode=off --advertise-routes=192.168.88.0/24 --accept-routes</span><br><span class="line">Warning: netfilter=off; configure iptables yourself.</span><br><span class="line">Warning: UDP GRO forwarding is suboptimally configured on eth1, UDP forwarding throughput capability will increase with a configuration change.</span><br><span class="line">See https://tailscale.com/s/ethtool-config-udp-gro</span><br><span class="line"></span><br><span class="line">To authenticate, visit:</span><br><span class="line"></span><br><span class="line">https://login.tailscale.com/a/98c452901c4ba</span><br><span class="line"></span><br><span class="line">Success.</span><br></pre></td></tr></table></figure><p><strong>NOTE:</strong> <strong>192.168.88.0&#x2F;24</strong> is the ip range of local network setup in <code>OpenWrt</code>.</p><p>Disable key expiry for <code>OpenWrt</code> machine in <code>Tailscale</code> console, then enable all <code>OpenWrt</code> clients access <code>Tailscale</code> network:</p><p><img src="/blog/img/OpenWrt%20-%20Tailscale%20Machines.png" alt="OpenWrt - Tailscale Machines" title="OpenWrt - Tailscale Machines"></p><p>Now add <code>Tailscale</code> virtual network as a new interface in <code>OpenWrt</code>:</p><p><img src="/blog/img/OpenWrt%20-%20Tailscale%20Network%20Interface.png" alt="OpenWrt - Tailscale Network Interface" title="OpenWrt - Tailscale Network Interface"></p><p>Create firewall for <code>Tailscale</code> virtual network interface in <code>OpenWrt</code>:</p><p><img src="/blog/img/OpenWrt%20-%20Tailscale%20Firewall.png" alt="OpenWrt - Tailscale Firewall" title="OpenWrt - Tailscale Firewall"></p><p>Configure firewall for <code>Tailscale</code> virtual network interface in <code>OpenWrt</code>:</p><p><img src="/blog/img/OpenWrt%20-%20Tailscale%20Firewall%20General%20Settings.png" alt="OpenWrt - Tailscale Firewall General Settings" title="OpenWrt - Tailscale Firewall General Settings"></p><p><strong>NOTE:</strong> <strong>opt</strong> network is for the downstream DHCP clients.</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>韩风 Talk - Tailscale 玩法之内网穿透、异地组网、全隧道模式、纯 IP 的双栈 DERP 搭建、Headscale 协调服务器搭建，用一期搞定，看一看不亏吧？<em><a href="https://www.youtube.com/watch?v=mgDpJX3oNvI">https://www.youtube.com/watch?v=mgDpJX3oNvI</a></em></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Install &lt;code&gt;Tailscale&lt;/code&gt; package &lt;strong&gt;iptables-nft&lt;/strong&gt; and &lt;strong&gt;tailscale&lt;/strong&gt; from &lt;code&gt;OpenWrt&lt;/code&gt; console:&lt;/p</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>How to install and run ZeroTier client on OpenWrt</title>
    <link href="https://terrencemiao.github.io/blog/2024/12/21/How-to-install-and-run-ZeroTier-client-on-OpenWrt/"/>
    <id>https://terrencemiao.github.io/blog/2024/12/21/How-to-install-and-run-ZeroTier-client-on-OpenWrt/</id>
    <published>2024-12-21T00:08:18.000Z</published>
    <updated>2024-12-21T03:45:57.953Z</updated>
    
    <content type="html"><![CDATA[<p>Install <code>ZeroTier</code> package <strong>zerotier</strong> from <code>OpenWrt</code> console:</p><p><img src="/blog/img/OpenWrt%20-%20ZeroTier.png" alt="OpenWrt - ZeroTier" title="OpenWrt - ZeroTier"></p><p>Enable <code>ZeroTier</code> service in <code>OpenWrt</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -l root SenseWrt</span><br><span class="line">root@SenseWrt&#x27;s password: </span><br><span class="line"></span><br><span class="line">BusyBox v1.36.1 (2024-12-03 11:41:08 UTC) built-in shell (ash)</span><br><span class="line"></span><br><span class="line">  _______                     ________        __</span><br><span class="line"> |       |.-----.-----.-----.|  |  |  |.----.|  |_</span><br><span class="line"> |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|</span><br><span class="line"> |_______||   __|_____|__|__||________||__|  |____|</span><br><span class="line">          |__| W I R E L E S S   F R E E D O M</span><br><span class="line"> -----------------------------------------------------</span><br><span class="line"> OpenWrt 24.10.0-rc2, r28161-ea17e958b9</span><br><span class="line"> -----------------------------------------------------</span><br><span class="line"></span><br><span class="line">root@SenseWrt:~# cat /etc/config/zerotier </span><br><span class="line"></span><br><span class="line">config zerotier &#x27;global&#x27;</span><br><span class="line"># Sets whether ZeroTier is enabled or not</span><br><span class="line">option enabled 1</span><br><span class="line"># Sets the ZeroTier listening port (default 9993; set to 0 for random)</span><br><span class="line">#option port &#x27;9993&#x27;</span><br><span class="line"># Client secret (leave blank to generate a secret on first run)</span><br><span class="line">option secret &#x27;&#x27;</span><br><span class="line"># Path of the optional file local.conf (see documentation at</span><br><span class="line"># https://docs.zerotier.com/config#local-configuration-options)</span><br><span class="line">#option local_conf_path &#x27;/etc/zerotier.conf&#x27;</span><br><span class="line"># Persistent configuration directory (to perform other configurations such</span><br><span class="line"># as controller mode or moons, etc.)</span><br><span class="line">#option config_path &#x27;/etc/zerotier&#x27;</span><br><span class="line"># Copy the contents of the persistent configuration directory to memory</span><br><span class="line"># instead of linking it, this avoids writing to flash</span><br><span class="line">#option copy_config_path &#x27;1&#x27;</span><br><span class="line"></span><br><span class="line"># Network configuration, you can have as many configurations as networks you</span><br><span class="line"># want to join (the network name is optional)</span><br><span class="line">config network &#x27;earth&#x27;</span><br><span class="line"># Identifier of the network you wish to join</span><br><span class="line">option id &#x27;8ca917257083e297&#x27;</span><br><span class="line"># Network configuration parameters (all are optional, if not indicated the</span><br><span class="line"># default values are set, see documentation at</span><br><span class="line"># https://docs.zerotier.com/config/#network-specific-configuration)</span><br><span class="line">option allow_managed &#x27;1&#x27;</span><br><span class="line">option allow_global &#x27;0&#x27;</span><br><span class="line">option allow_default &#x27;0&#x27;</span><br><span class="line">option allow_dns &#x27;0&#x27;</span><br><span class="line"></span><br><span class="line"># Example of a second network (unnamed as it is optional)</span><br><span class="line">#config network</span><br><span class="line">#option id &#x27;1234567890123456&#x27;</span><br><span class="line">#option allow_managed &#x27;1&#x27;</span><br><span class="line">#option allow_global &#x27;0&#x27;</span><br><span class="line">#option allow_default &#x27;0&#x27;</span><br><span class="line">#option allow_dns &#x27;0&#x27;</span><br></pre></td></tr></table></figure><p>Restart <code>ZeroTier</code> service:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ root@SenseWrt:~# /etc/init.d/zerotier restart</span><br><span class="line">Generating secret - please wait... done.</span><br></pre></td></tr></table></figure><p>Verify <code>ZeroTier</code> client status, which <strong>ztks555nye</strong> is the virtual network interface created on <code>OpenWrt</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@SenseWrt:~# zerotier-cli listnetworks</span><br><span class="line">200 listnetworks &lt;nwid&gt; &lt;name&gt; &lt;mac&gt; &lt;status&gt; &lt;type&gt; &lt;dev&gt; &lt;ZT assigned ips&gt;</span><br><span class="line">200 listnetworks 8ca917257083e297 igloo.studio 9a:09:7b:41:3d:26 OK PRIVATE ztks555nye 192.168.196.176/24</span><br></pre></td></tr></table></figure><p>Enable and authorise the new <code>ZeroTier</code> client <code>OpenWrt</code> in <em><a href="https://my.zerotier.com/">https://my.zerotier.com/</a></em>.</p><p>Now add <code>ZeroTier</code> virtual network as a new interface in <code>OpenWrt</code>:</p><p><img src="/blog/img/OpenWrt%20-%20ZeroTier%20Network%20Interface.png" alt="OpenWrt - ZeroTier Network Interface" title="OpenWrt - ZeroTier Network Interface"></p><p>Create firewall for <code>ZeroTier</code> virtual network interface in <code>OpenWrt</code>:</p><p><img src="/blog/img/OpenWrt%20-%20ZeroTier%20Firewall.png" alt="OpenWrt - ZeroTier Firewall" title="OpenWrt - ZeroTier Firewall"></p><p>Configure firewall for <code>ZeroTier</code> virtual network interface in <code>OpenWrt</code>:</p><p><img src="/blog/img/OpenWrt%20-%20ZeroTier%20Firewall%20General%20Settings.png" alt="OpenWrt - ZeroTier Firewall General Settings" title="OpenWrt - ZeroTier Firewall General Settings"></p><p><strong>NOTE:</strong> <strong>opt</strong> network is for the downstream DHCP clients.</p><p>Add <strong>Allow-ZeroTier</strong> firewall rule:</p><p><img src="/blog/img/OpenWrt%20-%20ZeroTier%20Firewall%20Rule.png" alt="OpenWrt - ZeroTier Firewall Rule" title="OpenWrt - ZeroTier Firewall Rule"></p><p>Restart <code>ZeroTier</code> service again:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ root@SenseWrt:~# /etc/init.d/zerotier restart</span><br><span class="line">Generating secret - please wait... done.</span><br></pre></td></tr></table></figure><p>Then all <code>OpenWrt</code> clients can access <code>ZeroTier</code> network now.</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>韩风 Talk - 内网穿透工具 ZeroTier，从简单到复杂的玩法，无保留，一期全放送 <em><a href="https://www.youtube.com/watch?v=pa0tkch3lss">https://www.youtube.com/watch?v=pa0tkch3lss</a></em></li><li>ZeroTier Terminology - Planet server, Moon server and client node (LEAF) <em><a href="https://www.wlink-tech.com/art/about-zerotier">https://www.wlink-tech.com/art/about-zerotier</a></em></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Install &lt;code&gt;ZeroTier&lt;/code&gt; package &lt;strong&gt;zerotier&lt;/strong&gt; from &lt;code&gt;OpenWrt&lt;/code&gt; console:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/img/OpenWrt%20-</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Connecting OpenWRT to internet</title>
    <link href="https://terrencemiao.github.io/blog/2024/12/05/Connecting-OpenWRT-to-internet/"/>
    <id>https://terrencemiao.github.io/blog/2024/12/05/Connecting-OpenWRT-to-internet/</id>
    <published>2024-12-05T03:19:34.000Z</published>
    <updated>2024-12-05T04:17:45.318Z</updated>
    
    <content type="html"><![CDATA[<p><code>OpenWRT</code> is running on <code>Proxmox</code>. Now setting up it to connect internet.</p><p>Add new network interface <strong>OPT</strong> on <strong>eth2</strong> adapter:</p><p><img src="/blog/img/OpenWRT%20-%20OPT%20Interface.png" alt="OpenWRT - OPT Interface" title="OpenWRT - OPT Interface"></p><p><img src="/blog/img/OpenWRT%20-%20OPT%20Advanced%20Settings.png" alt="OpenWRT - OPT Advanced Settings" title="OpenWRT - OPT Advanced Settings"></p><p><img src="/blog/img/OpenWRT%20-%20OPT%20Firewall%20Settings.png" alt="OpenWRT - OPT Firewall Settings" title="OpenWRT - OPT Firewall Settings"></p><p><img src="/blog/img/OpenWRT%20-%20OPT%20DHCP%20Server%20General%20Setup.png" alt="OpenWRT - OPT DHCP Server General Setup" title="OpenWRT - OPT DHCP Server General Setup"></p><p><img src="/blog/img/OpenWRT%20-%20OPT%20DHCP%20Server%20Advanced%20Settings.png" alt="OpenWRT - OPT DHCP Server Advanced Settings" title="OpenWRT - OPT DHCP Server Advanced Settings"></p><p><img src="/blog/img/OpenWRT%20-%20OPT%20DHCP%20Server%20IPv6%20Settings.png" alt="OpenWRT - OPT DHCP Server IPv6 Settings" title="OpenWRT - OPT DHCP Server IPv6 Settings"></p><p><img src="/blog/img/OpenWRT%20-%20OPT%20DHCP%20Server%20IPv6%20RA%20Settings.png" alt="OpenWRT - OPT DHCP Server IPv6 RA Settings" title="OpenWRT - OPT DHCP Server IPv6 RA Settings"></p><p><img src="/blog/img/OpenWRT%20-%20OPT.png" alt="OpenWRT - OPT" title="OpenWRT - OPT"></p><p>Add a new Firewall Zone, from network <strong>opt</strong> to <strong>wan</strong>:</p><p><img src="/blog/img/OpenWRT%20-%20Firewall%20Zone%20General%20Settings.png" alt="OpenWRT - Firewall Zone General Settings" title="OpenWRT - Firewall Zone General Settings"></p><p><img src="/blog/img/OpenWRT%20-%20Firewall%20Zone%20Advanced%20Settings.png" alt="OpenWRT - Firewall Zone Advanced Settings" title="OpenWRT - Firewall Zone Advanced Settings"></p><p><img src="/blog/img/OpenWRT%20-%20Firewall%20Zone%20Conntrack%20Settings.png" alt="OpenWRT - Firewall Zone Conntrack Settings" title="OpenWRT - Firewall Zone Conntrack Settings"></p><p><img src="/blog/img/OpenWRT%20-%20Firewall%20Zone.png" alt="OpenWRT - Firewall Zone" title="OpenWRT - Firewall Zone"></p><p>Add a new Firewall Traffic Rule for network <strong>opt</strong>:</p><p><img src="/blog/img/OpenWRT%20-%20Firewall%20Traffic%20Rule%20General%20Settings.png" alt="OpenWRT - Firewall Traffic Rule General Settings" title="OpenWRT - Firewall Traffic Rule General Settings"></p><p><img src="/blog/img/OpenWRT%20-%20Firewall%20Traffic%20Rule%20Advanced%20Settings.png" alt="OpenWRT - Firewall Traffic Rule Advanced Settings" title="OpenWRT - Firewall Traffic Rule Advanced Settings"></p><p><img src="/blog/img/OpenWRT%20-%20Firewall%20Traffic%20Rule%20Time%20Restrictions.png" alt="OpenWRT - Firewall Traffic Rule Time Restrictions" title="OpenWRT - Firewall Traffic Rule Time Restrictions"></p><p><img src="/blog/img/OpenWRT%20-%20Firewall%20Traffic%20Rule.png" alt="OpenWRT - Firewall Traffic Rule" title="OpenWRT - Firewall Traffic Rule"></p><p>Setup DHCP clients’ static IP addresses:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -l root 192.168.2.1</span><br><span class="line">root@192.168.2.1&#x27;s password:</span><br><span class="line"></span><br><span class="line">BusyBox v1.36.1 (2024-09-23 12:34:46 UTC) built-in shell (ash)</span><br><span class="line"></span><br><span class="line">  _______                     ________        __</span><br><span class="line"> |       |.-----.-----.-----.|  |  |  |.----.|  |_</span><br><span class="line"> |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|</span><br><span class="line"> |_______||   __|_____|__|__||________||__|  |____|</span><br><span class="line">          |__| W I R E L E S S   F R E E D O M</span><br><span class="line"> -----------------------------------------------------</span><br><span class="line"> OpenWrt 23.05.5, r24106-10cc5fcd00</span><br><span class="line"> -----------------------------------------------------</span><br><span class="line"></span><br><span class="line">root@OpenWRT:~# cat /etc/config/dhcp</span><br><span class="line">config dnsmasq</span><br><span class="line">option domainneeded &#x27;1&#x27;</span><br><span class="line">option localise_queries &#x27;1&#x27;</span><br><span class="line">option rebind_protection &#x27;1&#x27;</span><br><span class="line">option rebind_localhost &#x27;1&#x27;</span><br><span class="line">option local &#x27;/local/&#x27;</span><br><span class="line">option domain &#x27;local&#x27;</span><br><span class="line">option expandhosts &#x27;1&#x27;</span><br><span class="line">option cachesize &#x27;1000&#x27;</span><br><span class="line">option authoritative &#x27;1&#x27;</span><br><span class="line">option readethers &#x27;1&#x27;</span><br><span class="line">option leasefile &#x27;/tmp/dhcp.leases&#x27;</span><br><span class="line">option resolvfile &#x27;/tmp/resolv.conf.d/resolv.conf.auto&#x27;</span><br><span class="line">option localservice &#x27;1&#x27;</span><br><span class="line">option ednspacket_max &#x27;1232&#x27;</span><br><span class="line">...</span><br><span class="line">config host</span><br><span class="line">option name &#x27;TL-SX3016F&#x27;</span><br><span class="line">option ip &#x27;192.168.2.100&#x27;</span><br><span class="line">option mac &#x27;3C:52:A1:47:23:5D&#x27;</span><br><span class="line"></span><br><span class="line">config host</span><br><span class="line">option name &#x27;MikroTik&#x27;</span><br><span class="line">option ip &#x27;192.168.2.110&#x27;</span><br><span class="line">option mac &#x27;78:9A:18:D0:20:ED&#x27;</span><br><span class="line"></span><br><span class="line">config domain</span><br><span class="line">option name &#x27;TL-SX3016F&#x27;</span><br><span class="line">option ip &#x27;192.168.2.100&#x27;</span><br><span class="line"></span><br><span class="line">config domain</span><br><span class="line">option name &#x27;MikroTik&#x27;</span><br><span class="line">option ip &#x27;192.168.2.110&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/blog/img/OpenWRT%20-%20DHCP%20and%20DNS.png" alt="OpenWRT - DHCP and DNS" title="OpenWRT - DHCP and DNS"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;OpenWRT&lt;/code&gt; is running on &lt;code&gt;Proxmox&lt;/code&gt;. Now setting up it to connect internet.&lt;/p&gt;
&lt;p&gt;Add new network interface &lt;strong&gt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Running OpenWRT on Proxmox</title>
    <link href="https://terrencemiao.github.io/blog/2024/12/03/Running-OpenWRT-on-Proxmox/"/>
    <id>https://terrencemiao.github.io/blog/2024/12/03/Running-OpenWRT-on-Proxmox/</id>
    <published>2024-12-03T01:46:37.000Z</published>
    <updated>2025-05-21T05:34:03.289Z</updated>
    
    <content type="html"><![CDATA[<ul><li>Create <code>OpenWRT</code> VM in <code>Proxmox</code></li></ul><p><img src="/blog/img/OpenWRT%20-%20VM%20General.png" alt="OpenWRT - VM General" title="OpenWRT - VM General"></p><p><img src="/blog/img/OpenWRT%20-%20VM%20OS.png" alt="OpenWRT - VM OS" title="OpenWRT - VM OS"></p><p><img src="/blog/img/OpenWRT%20-%20VM%20System.png" alt="OpenWRT - VM System" title="OpenWRT - VM System"></p><p><img src="/blog/img/OpenWRT%20-%20VM%20Disks.png" alt="OpenWRT - VM Disks" title="OpenWRT - VM Disks"></p><p><img src="/blog/img/OpenWRT%20-%20VM%20CPU.png" alt="OpenWRT - VM CPU" title="OpenWRT - VM CPU"></p><p><img src="/blog/img/OpenWRT%20-%20VM%20Memory.png" alt="OpenWRT - VM Memory" title="OpenWRT - VM Memory"></p><p><img src="/blog/img/OpenWRT%20-%20VM%20Network.png" alt="OpenWRT - VM Network" title="OpenWRT - VM Network"></p><p>This is the <strong>LAN</strong>, and Firewall is <strong>DISABLED</strong>.</p><p><img src="/blog/img/OpenWRT%20-%20VM%20Confirm.png" alt="OpenWRT - VM Confirm" title="OpenWRT - VM Confirm"></p><p>Add <strong>WAN</strong> into VM, and Firewall is <strong>DISABLED</strong>.</p><p>Detach and delete current <strong>Hard Disk</strong>.</p><p>From <code>Proxmox</code> Console, download the latest OpenWRT image:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# wget https://downloads.openwrt.org/releases/23.05.5/targets/x86/64/openwrt-23.05.5-x86-64-generic-ext4-combined.img.gz</span><br><span class="line">--2024-12-03 12:20:33--  https://downloads.openwrt.org/releases/23.05.5/targets/x86/64/openwrt-23.05.5-x86-64-generic-ext4-combined.img.gz</span><br><span class="line">Resolving downloads.openwrt.org (downloads.openwrt.org)... 2a04:4e42:13::644, 151.101.82.132</span><br><span class="line">Connecting to downloads.openwrt.org (downloads.openwrt.org)|2a04:4e42:13::644|:443... failed: No route to host.</span><br><span class="line">Connecting to downloads.openwrt.org (downloads.openwrt.org)|151.101.82.132|:443... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 11352149 (11M) [application/octet-stream]</span><br><span class="line">Saving to: ‘openwrt-23.05.5-x86-64-generic-ext4-combined.img.gz’</span><br><span class="line"></span><br><span class="line">openwrt-23.05.5-x86-64-generic-ext4-combined.img.gz  100%[===================================================&gt;]  10.83M  --.-KB/s  in 0.1s</span><br></pre></td></tr></table></figure><p>Create disk image for VM:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# gunzip openwrt-23.05.5-x86-64-generic-ext4-combined.img.gz</span><br><span class="line"></span><br><span class="line">root@sense:~# mv openwrt-23.05.5-x86-64-generic-ext4-combined.img openwrt.raw</span><br><span class="line"></span><br><span class="line"># increase the raw disk</span><br><span class="line">root@sense:~# qemu-img resize -f raw ./openwrt.raw 1024M</span><br><span class="line">Image resized.</span><br></pre></td></tr></table></figure><p>Convert <code>OpenWRT</code> image to VM disk:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># import the raw disk to OpenWRT VM</span><br><span class="line">root@sense:~# qm importdisk 104 openwrt.raw local-lvm</span><br><span class="line">Use of uninitialized value $dev in hash element at /usr/share/perl5/PVE/QemuServer/Drive.pm line 555.</span><br><span class="line">importing disk &#x27;openwrt.raw&#x27; to VM 104 ...</span><br><span class="line">  Logical volume &quot;vm-104-disk-0&quot; created.</span><br><span class="line">transferred 0.0 B of 1.0 GiB (0.00%)</span><br><span class="line">...</span><br><span class="line">transferred 1.0 GiB of 1.0 GiB (100.00%)</span><br><span class="line">unused0: successfully imported disk &#x27;local-lvm:vm-104-disk-0&#x27;</span><br></pre></td></tr></table></figure><p>Double click the <strong>Unused Disk</strong>, then click the Add button:</p><p><img src="/blog/img/OpenWRT%20-%20VM%20Unused%20Disk.png" alt="OpenWRT - VM Unused Disk" title="OpenWRT - VM Unused Disk"></p><p><img src="/blog/img/OpenWRT%20-%20VM%20Hardware.png" alt="OpenWRT - VM Hardware" title="OpenWRT - VM Hardware"></p><p><img src="/blog/img/OpenWRT%20-%20VM%20Boot%20Order.png" alt="OpenWRT - VM Boot Order" title="OpenWRT - VM Boot Order"></p><ul><li>Configure <code>OpenWRT</code></li></ul><p>Start up VM; change the user <strong>root</strong> password; set LAN ip address temporarily to <strong>192.168.2.3</strong> (Default: <strong>192.168.1.1</strong>):</p><p><img src="/blog/img/OpenWRT%20-%20Console.png" alt="OpenWRT - Console" title="OpenWRT - Console"></p><p>Login <code>OpenWRT</code> at <em><a href="http://192.168.2.3/">http://192.168.2.3/</a></em>, via LAN port, and land on dashboard:</p><p><img src="/blog/img/OpenWRT%20-%20Login.png" alt="OpenWRT - Login" title="OpenWRT - Login"></p><p><img src="/blog/img/OpenWRT%20-%20Dashboard.png" alt="OpenWRT - Dashboard" title="OpenWRT - Dashboard"></p><ul><li>Themes</li></ul><p><strong>SSH</strong> login:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -l root 192.168.2.3</span><br><span class="line">The authenticity of host &#x27;192.168.2.3 (192.168.2.3)&#x27; can&#x27;t be established.</span><br><span class="line">ED25519 key fingerprint is SHA256:AggWAL1oU8+r1f84KoqpvcsYUylZOTfN0sXwHSby3b0.</span><br><span class="line">This key is not known by any other names.</span><br><span class="line">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="line">Warning: Permanently added &#x27;192.168.2.3&#x27; (ED25519) to the list of known hosts.</span><br><span class="line">root@192.168.2.3&#x27;s password:</span><br><span class="line">  _______                     ________        __</span><br><span class="line"> |       |.-----.-----.-----.|  |  |  |.----.|  |_</span><br><span class="line"> |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|</span><br><span class="line"> |_______||   __|_____|__|__||________||__|  |____|</span><br><span class="line">          |__| W I R E L E S S   F R E E D O M</span><br><span class="line"> -----------------------------------------------------</span><br><span class="line"> OpenWrt 23.05.5, r24106-10cc5fcd00</span><br><span class="line"> -----------------------------------------------------</span><br><span class="line"></span><br><span class="line">BusyBox v1.36.1 (2024-09-23 12:34:46 UTC) built-in shell (ash)</span><br></pre></td></tr></table></figure><p><code>OpenWRT</code> packages configuration:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">root@OpenWrt:~# ls -al /etc/opkg</span><br><span class="line">drwxr-xr-x    3 root     root          4096 Dec  6 02:46 .</span><br><span class="line">drwxr-xr-x   23 root     root          4096 Dec  6 02:41 ..</span><br><span class="line">-rw-r--r--    1 root     root           103 Sep 23 12:34 customfeeds.conf</span><br><span class="line">-rw-r--r--    1 root     root           555 Dec  6 02:46 distfeeds.conf</span><br><span class="line">drwxr-xr-x    2 root     root          4096 Sep 23 12:34 keys</span><br><span class="line"></span><br><span class="line">root@OpenWrt:~# ls -al /var/opkg-lists/</span><br><span class="line">drwxr-xr-x    2 root     root           320 Dec  6 03:15 .</span><br><span class="line">drwxrwxrwt   17 root     root           440 Dec  6 03:15 ..</span><br><span class="line">-rw-r--r--    1 root     root         72705 Dec  6 03:15 openwrt_base</span><br><span class="line">-rw-r--r--    1 root     root           142 Dec  6 03:15 openwrt_base.sig</span><br><span class="line">-rw-r--r--    1 root     root         10039 Dec  6 03:15 openwrt_core</span><br><span class="line">-rw-r--r--    1 root     root           142 Dec  6 03:15 openwrt_core.sig</span><br><span class="line">-rw-r--r--    1 root     root        100416 Dec  6 03:15 openwrt_kmods</span><br><span class="line">-rw-r--r--    1 root     root           142 Dec  6 03:15 openwrt_kmods.sig</span><br><span class="line">-rw-r--r--    1 root     root        197242 Dec  6 03:15 openwrt_luci</span><br><span class="line">-rw-r--r--    1 root     root           142 Dec  6 03:15 openwrt_luci.sig</span><br><span class="line">-rw-r--r--    1 root     root        516243 Dec  6 03:15 openwrt_packages</span><br><span class="line">-rw-r--r--    1 root     root           142 Dec  6 03:15 openwrt_packages.sig</span><br><span class="line">-rw-r--r--    1 root     root          9918 Dec  6 03:15 openwrt_routing</span><br><span class="line">-rw-r--r--    1 root     root           142 Dec  6 03:15 openwrt_routing.sig</span><br><span class="line">-rw-r--r--    1 root     root         58240 Dec  6 03:15 openwrt_telephony</span><br><span class="line">-rw-r--r--    1 root     root           142 Dec  6 03:15 openwrt_telephony.sig</span><br></pre></td></tr></table></figure><p>There is some issue with <strong>IPv6</strong> support in <code>OpenWRT</code> when download update. Errors thrown when <strong>wan</strong> connected to a <strong>IPv6</strong> router:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@OpenWrt:~# opkg update</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/targets/x86/64/packages/Packages.gz</span><br><span class="line">*** Failed to download the package list from https://downloads.openwrt.org/releases/23.05.5/targets/x86/64/packages/Packages.gz</span><br><span class="line">...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/telephony/Packages.gz</span><br><span class="line">*** Failed to download the package list from https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/telephony/Packages.gz</span><br><span class="line"></span><br><span class="line">Collected errors:</span><br><span class="line"> * opkg_download: Failed to download https://downloads.openwrt.org/releases/23.05.5/targets/x86/64/packages/Packages.gz, wget returned 4.</span><br><span class="line"> * opkg_download: Check your network settings and connectivity.</span><br><span class="line">...</span><br><span class="line"> * opkg_download: Failed to download https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/telephony/Packages.gz, wget returned 4.</span><br><span class="line"> * opkg_download: Check your network settings and connectivity.</span><br></pre></td></tr></table></figure><p>Turn off <strong>IPv6</strong> - navigate through OpenWRT UI, <strong>Network</strong> -&gt; <strong>Interfaces</strong>, select <strong>Devices</strong> tab. For device <code>br-lan</code> click on <strong>Configure …</strong>, choose <strong>disabled</strong>  option for <strong>Enable IPv6</strong> in <strong>General device options</strong> tab.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@OpenWRT:~# opkg update</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/targets/x86/64/packages/Packages.gz</span><br><span class="line">Updated list of available packages in /var/opkg-lists/openwrt_core</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/targets/x86/64/packages/Packages.sig</span><br><span class="line">Signature check passed.</span><br><span class="line">...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/telephony/Packages.gz</span><br><span class="line">Updated list of available packages in /var/opkg-lists/openwrt_telephony</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/telephony/Packages.sig</span><br><span class="line">Signature check passed.</span><br></pre></td></tr></table></figure><p>Install <code>OpenWRT2020</code> Theme <em><a href="https://openwrt.org/docs/guide-user/luci/luci.themes">https://openwrt.org/docs/guide-user/luci/luci.themes</a></em>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@OpenWRT:~# opkg install luci-theme-openwrt-2020</span><br><span class="line">Installing luci-theme-openwrt-2020 (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-theme-openwrt-2020_git-24.332.79522-a493155_all.ipk</span><br><span class="line">Configuring luci-theme-openwrt-2020.</span><br></pre></td></tr></table></figure><p>Install Argon Theme <em><a href="https://github.com/jerrykuku/luci-theme-argon">https://github.com/jerrykuku/luci-theme-argon</a></em>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">root@OpenWRT:~# opkg install luci-compat</span><br><span class="line">Installing luci-compat (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-compat_git-24.332.79522-a493155_all.ipk</span><br><span class="line">Installing liblua5.1.5 (5.1.5-11) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/base/liblua5.1.5_5.1.5-11_x86_64.ipk</span><br><span class="line">Installing lua (5.1.5-11) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/base/lua_5.1.5-11_x86_64.ipk</span><br><span class="line">Installing luci-lib-nixio (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-lib-nixio_git-24.332.79522-a493155_x86_64.ipk</span><br><span class="line">Installing luci-lib-ip (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-lib-ip_git-24.332.79522-a493155_x86_64.ipk</span><br><span class="line">Installing luci-lib-jsonc (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-lib-jsonc_git-24.332.79522-a493155_x86_64.ipk</span><br><span class="line">Installing liblucihttp-lua (2023-03-15-9b5b683f-1) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/liblucihttp-lua_2023-03-15-9b5b683f-1_x86_64.ipk</span><br><span class="line">Installing luci-lib-base (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-lib-base_git-24.332.79522-a493155_all.ipk</span><br><span class="line">Installing libubus-lua (2023-06-05-f787c97b-1) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/base/libubus-lua_2023-06-05-f787c97b-1_x86_64.ipk</span><br><span class="line">Installing ucode-mod-lua (1) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/ucode-mod-lua_1_x86_64.ipk</span><br><span class="line">Installing luci-lua-runtime (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-lua-runtime_git-24.332.79522-a493155_x86_64.ipk</span><br><span class="line">Configuring liblua5.1.5.</span><br><span class="line">Configuring lua.</span><br><span class="line">Configuring luci-lib-nixio.</span><br><span class="line">Configuring luci-lib-ip.</span><br><span class="line">Configuring luci-lib-jsonc.</span><br><span class="line">Configuring liblucihttp-lua.</span><br><span class="line">Configuring luci-lib-base.</span><br><span class="line">Configuring libubus-lua.</span><br><span class="line">Configuring ucode-mod-lua.</span><br><span class="line">Configuring luci-lua-runtime.</span><br><span class="line">Configuring luci-compat.</span><br><span class="line"></span><br><span class="line">root@OpenWRT:~# opkg install luci-lib-ipkg</span><br><span class="line">Installing luci-lib-ipkg (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-lib-ipkg_git-24.332.79522-a493155_all.ipk</span><br><span class="line">Configuring luci-lib-ipkg.</span><br><span class="line"></span><br><span class="line">root@OpenWRT:~# wget --no-check-certificate -O luci-theme-argon.ipk https://github.com/jerrykuku/luci-theme-argon/releases/download/v2.3.1/luci-theme-argon_2.3.1_all.ipk</span><br><span class="line">root@OpenWRT:~# wget --no-check-certificate -O luci-app-argon-config.ipk https://github.com/jerrykuku/luci-app-argon-config/releases/download/v0.9/luci-app-argon-config_0.9_all.ipk</span><br></pre></td></tr></table></figure><p>There are ERRORS:</p><ul><li><em>&#x2F;&#x2F;usr&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;luci-theme-argon.postinst: .: line 2: can’t open ‘&#x2F;etc&#x2F;uci-defaults&#x2F;30_luci-theme-argon’: No such file or directory</em></li><li><em>&#x2F;&#x2F;usr&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;luci-app-argon-config.postinst: .: line 2: can’t open ‘&#x2F;etc&#x2F;uci-defaults&#x2F;luci-argon-config’: No such file or directory</em></li></ul><p>thrown when try to install these packages.</p><p>A workaround solution is modify <strong>&#x2F;lib&#x2F;functions.sh</strong> file, replace line <strong>282</strong> (OpenWrt version 23.05.5), or line <strong>377</strong> (OpenWrt version 24.10.0):</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">( [ -f &quot;$i&quot; ] &amp;&amp; cd &quot;$(dirname $i)&quot; &amp;&amp; . &quot;$i&quot; ) &amp;&amp; rm -f &quot;$i&quot;</span><br></pre></td></tr></table></figure><p>with:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">( [ -f &quot;$i&quot; ] &amp;&amp; cd &quot;$(dirname $i)&quot; &amp;&amp; . &quot;$i&quot; ) &amp;&amp; echo</span><br></pre></td></tr></table></figure><p>temporarily. Then run installation:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@OpenWRT:~# opkg install luci-theme-argon.ipk</span><br><span class="line">Installing luci-theme-argon (2.3.1) to root...</span><br><span class="line">Configuring luci-theme-argon.</span><br><span class="line"></span><br><span class="line">root@OpenWRT:~# opkg install luci-app-argon-config.ipk</span><br><span class="line">Installing luci-app-argon-config (0.9) to root...</span><br><span class="line">Configuring luci-app-argon-config.</span><br></pre></td></tr></table></figure><ul><li>Upgrade</li></ul><p>To upgrade all of the <code>OpenWRT</code> packages:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@OpenWRT:~# opkg list-upgradable | cut -f 1 -d &#x27; &#x27; | xargs -r opkg upgrade</span><br></pre></td></tr></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>Run an OpenWRT VM on Proxmox VE, <em><a href="https://i12bretro.github.io/tutorials/0405.html">https://i12bretro.github.io/tutorials/0405.html</a></em></li><li>My Mobile HomeLab! (Travel Router with Proxmox, Docker, and OpenWRT), <em><a href="https://technotim.live/posts/mobile-homelab/">https://technotim.live/posts/mobile-homelab/</a></em></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;Create &lt;code&gt;OpenWRT&lt;/code&gt; VM in &lt;code&gt;Proxmox&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;/blog/img/OpenWRT%20-%20VM%20General.png&quot; alt=&quot;OpenW</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Fixing Multimedia Audio Controller driver missing issue in Windows 11</title>
    <link href="https://terrencemiao.github.io/blog/2024/11/25/Fixing-Multimedia-Audio-Controller-driver-missing-issue-in-Windows-11/"/>
    <id>https://terrencemiao.github.io/blog/2024/11/25/Fixing-Multimedia-Audio-Controller-driver-missing-issue-in-Windows-11/</id>
    <published>2024-11-25T06:21:43.000Z</published>
    <updated>2024-11-25T07:31:07.557Z</updated>
    
    <content type="html"><![CDATA[<p>Error thrown while missing <strong>Multimedia Audio Driver</strong> driver in Device Manager in Windows 11:</p><p><img src="/blog/img/Windows%20-%20Multimedia%20Audio%20Controller.png" alt="Windows - Multimedia Audio Controller" title="Windows - Multimedia Audio Controller"></p><p>when runs on an Intel i3 N305 Mini PC <em><a href="https://www.aliexpress.com/item/1005007278560105.html">https://www.aliexpress.com/item/1005007278560105.html</a></em> </p><p><img src="/blog/img/Intel%20Network%20-%20Mini%20PC.png" alt="Intel Network - Mini PC" title="Intel Network - Mini PC"></p><p>Need this handy tool to find all the missing parts:</p><p><img src="/blog/img/Windows%20-%20Driver%20Identifier.png" alt="Windows - Driver Identifier" title="Windows - Driver Identifier"></p><p><code>Driver Identifier</code>, a digital assistant for your system’s hardware, can scan the device, identifies outdated or missing drivers, and provides a customized list of updates for your specific hardware:</p><p><img src="/blog/img/Windows%20-%20Drivers.png" alt="Windows - Drivers" title="Windows - Drivers"></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>DriverIdentifier is a powerful tool that takes the hassle out of managing and updating drivers on your computer, <em><a href="https://www.driveridentifier.com/">https://www.driveridentifier.com/</a></em></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Error thrown while missing &lt;strong&gt;Multimedia Audio Driver&lt;/strong&gt; driver in Device Manager in Windows 11:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/img/Wi</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Setting up DNS Server in OPNsense</title>
    <link href="https://terrencemiao.github.io/blog/2024/11/21/Setting-up-DNS-Server-in-OPNsense/"/>
    <id>https://terrencemiao.github.io/blog/2024/11/21/Setting-up-DNS-Server-in-OPNsense/</id>
    <published>2024-11-20T23:21:28.000Z</published>
    <updated>2024-11-21T00:35:58.164Z</updated>
    
    <content type="html"><![CDATA[<p>Want to access Homelab network switches’ web based administrator interface in a user friendly way, i.e., access via <a href="http://tl-sx3016f.local/">http://TL-SX3016F.local/</a>, <a href="http://tl-sx3008f.local/">http://TL-SX3008F.local/</a> and <a href="http://mikrotik.local/">http://MikroTik.local/</a>.</p><p>In TP-Link Deco, which is the main Homelab network backbone, also provides DHCP service, firstly is to reserve IP addresses for these switches:</p><p><img src="/blog/img/DNS%20-%20TP-Link%20Deco%20Reservation.jpg" alt="DNS - TP-Link Deco Reservation" title="DNS - TP-Link Deco Reservation"></p><p>Then setup entries in <code>OPNsense Unbound DNS</code> server:</p><p><img src="/blog/img/DNS%20-%20Host%20Overrides.png" alt="DNS - Host Overrides" title="DNS - Host Overrides"></p><p>Then lookup a host on local network:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$ cat /etc/resolv.conf</span><br><span class="line">#</span><br><span class="line"># macOS Notice</span><br><span class="line">#</span><br><span class="line"># This file is not consulted for DNS hostname resolution, address</span><br><span class="line"># resolution, or the DNS query routing mechanism used by most</span><br><span class="line"># processes on this system.</span><br><span class="line">#</span><br><span class="line"># To view the DNS configuration used by this system, use:</span><br><span class="line">#   scutil --dns</span><br><span class="line">#</span><br><span class="line"># SEE ALSO</span><br><span class="line">#   dns-sd(1), scutil(8)</span><br><span class="line">#</span><br><span class="line"># This file is automatically generated.</span><br><span class="line">#</span><br><span class="line">search local</span><br><span class="line">nameserver 2403:5802:8c44:3:be24:11ff:fe21:3ce0</span><br><span class="line">nameserver 192.168.68.1</span><br><span class="line"></span><br><span class="line">$ nslookup MikroTik.local</span><br><span class="line">Server:2403:5802:8c44:3:be24:11ff:fe21:3ce0</span><br><span class="line">Address:2403:5802:8c44:3:be24:11ff:fe21:3ce0#53</span><br><span class="line"></span><br><span class="line">Name:MikroTik.local</span><br><span class="line">Address: 192.168.68.54</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Want to access Homelab network switches’ web based administrator interface in a user friendly way, i.e., access via &lt;a href=&quot;http://tl-sx</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Enable SR-IOV in Intel 82599ES 10Gbps Ethernet Controller</title>
    <link href="https://terrencemiao.github.io/blog/2024/11/08/Enable-SR-IOV-in-Intel-82599ES-10Gbps-Ethernet-Controller/"/>
    <id>https://terrencemiao.github.io/blog/2024/11/08/Enable-SR-IOV-in-Intel-82599ES-10Gbps-Ethernet-Controller/</id>
    <published>2024-11-08T10:06:48.000Z</published>
    <updated>2024-11-25T11:57:42.745Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Intel® 82599ES 10Gbps Ethernet Controller</strong> <em><a href="https://ark.intel.com/content/www/us/en/ark/products/41282/intel-82599es-10-gigabit-ethernet-controller.html">https://ark.intel.com/content/www/us/en/ark/products/41282/intel-82599es-10-gigabit-ethernet-controller.html</a></em> supports <strong>SR-IOV</strong>, which is Intel® Virtualization Technology for Connectivity (VT-c) solution.</p><blockquote><p><strong>NOTE:</strong> Intel VT Virtualization Features</p></blockquote><ul><li><strong>VT-x</strong>, Intel Virtualization Technology for IA-32 and Intel 64 Processors</li><li><strong>VT-d</strong>, Intel Virtualization Technology for Directed I&#x2F;O</li><li><strong>VT-c</strong>, Intel Virtualization Technology for Connectivity</li></ul><p>The following step by step instructions is made in <code>Proxmox</code>.</p><p>Intel i3 N305 Mini PC <em><a href="https://www.aliexpress.com/item/1005007278560105.html">https://www.aliexpress.com/item/1005007278560105.html</a></em> </p><p><img src="/blog/img/Intel%20Network%20-%20Mini%20PC.png" alt="Intel Network - Mini PC" title="Intel Network - Mini PC"></p><p>equips with two 10G SFP+ (Intel 82599ES) and two 2.5G (Intel i226-V) network cards:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# lspci -v </span><br><span class="line">...</span><br><span class="line">01:00.0 Ethernet controller: Intel Corporation 82599ES 10-Gigabit SFI/SFP+ Network Connection (rev 01)</span><br><span class="line">        Flags: bus master, fast devsel, latency 0, IRQ 16, IOMMU group 12</span><br><span class="line">        Memory at 80a20000 (64-bit, non-prefetchable) [size=128K]</span><br><span class="line">        I/O ports at 3020 [disabled] [size=32]</span><br><span class="line">        Memory at 80a44000 (64-bit, non-prefetchable) [size=16K]</span><br><span class="line">        Capabilities: [40] Power Management version 3</span><br><span class="line">        Capabilities: [50] MSI: Enable- Count=1/1 Maskable+ 64bit+</span><br><span class="line">        Capabilities: [70] MSI-X: Enable+ Count=64 Masked-</span><br><span class="line">        Capabilities: [a0] Express Endpoint, MSI 00</span><br><span class="line">        Capabilities: [e0] Vital Product Data</span><br><span class="line">        Capabilities: [100] Advanced Error Reporting</span><br><span class="line">        Capabilities: [140] Device Serial Number a8-b8-e0-ff-ff-05-96-4d</span><br><span class="line">        Capabilities: [150] Alternative Routing-ID Interpretation (ARI)</span><br><span class="line">        Capabilities: [160] Single Root I/O Virtualization (SR-IOV)</span><br><span class="line">        Kernel driver in use: ixgbe</span><br><span class="line">        Kernel modules: ixgbe</span><br><span class="line"></span><br><span class="line">01:00.1 Ethernet controller: Intel Corporation 82599ES 10-Gigabit SFI/SFP+ Network Connection (rev 01)</span><br><span class="line">        Flags: bus master, fast devsel, latency 0, IRQ 17, IOMMU group 13</span><br><span class="line">        Memory at 80a00000 (64-bit, non-prefetchable) [size=128K]</span><br><span class="line">        I/O ports at 3000 [disabled] [size=32]</span><br><span class="line">        Memory at 80a40000 (64-bit, non-prefetchable) [size=16K]</span><br><span class="line">        Capabilities: [40] Power Management version 3</span><br><span class="line">        Capabilities: [50] MSI: Enable- Count=1/1 Maskable+ 64bit+</span><br><span class="line">        Capabilities: [70] MSI-X: Enable+ Count=64 Masked-</span><br><span class="line">        Capabilities: [a0] Express Endpoint, MSI 00</span><br><span class="line">        Capabilities: [e0] Vital Product Data</span><br><span class="line">        Capabilities: [100] Advanced Error Reporting</span><br><span class="line">        Capabilities: [140] Device Serial Number a8-b8-e0-ff-ff-05-96-4d</span><br><span class="line">        Capabilities: [150] Alternative Routing-ID Interpretation (ARI)</span><br><span class="line">        Capabilities: [160] Single Root I/O Virtualization (SR-IOV)</span><br><span class="line">        Kernel driver in use: ixgbe</span><br><span class="line">        Kernel modules: ixgbe</span><br><span class="line"></span><br><span class="line">01:10.0 Ethernet controller: Intel Corporation 82599 Ethernet Controller Virtual Function (rev 01)</span><br><span class="line">        Flags: bus master, fast devsel, latency 0, IOMMU group 18</span><br><span class="line">        Memory at 4017000000 (64-bit, prefetchable) [virtual] [size=16K]</span><br><span class="line">        Memory at 4017100000 (64-bit, prefetchable) [virtual] [size=16K]</span><br><span class="line">        Capabilities: [70] MSI-X: Enable+ Count=3 Masked-</span><br><span class="line">        Capabilities: [a0] Express Endpoint, MSI 00</span><br><span class="line">        Capabilities: [100] Advanced Error Reporting</span><br><span class="line">        Capabilities: [150] Alternative Routing-ID Interpretation (ARI)</span><br><span class="line">        Kernel driver in use: vfio-pci</span><br><span class="line">        Kernel modules: ixgbevf</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">02:00.0 Ethernet controller: Intel Corporation Ethernet Controller I226-V (rev 04)</span><br><span class="line">        Subsystem: Intel Corporation Ethernet Controller I226-V</span><br><span class="line">        Flags: bus master, fast devsel, latency 0, IRQ 18, IOMMU group 14</span><br><span class="line">        Memory at 80600000 (32-bit, non-prefetchable) [size=1M]</span><br><span class="line">        Memory at 80700000 (32-bit, non-prefetchable) [size=16K]</span><br><span class="line">        Capabilities: [40] Power Management version 3</span><br><span class="line">        Capabilities: [50] MSI: Enable- Count=1/1 Maskable+ 64bit+</span><br><span class="line">        Capabilities: [70] MSI-X: Enable+ Count=5 Masked-</span><br><span class="line">        Capabilities: [a0] Express Endpoint, MSI 00</span><br><span class="line">        Capabilities: [100] Advanced Error Reporting</span><br><span class="line">        Capabilities: [140] Device Serial Number a8-b8-e0-ff-ff-05-96-4f</span><br><span class="line">        Capabilities: [1c0] Latency Tolerance Reporting</span><br><span class="line">        Capabilities: [1f0] Precision Time Measurement</span><br><span class="line">        Capabilities: [1e0] L1 PM Substates</span><br><span class="line">        Kernel driver in use: igc</span><br><span class="line">        Kernel modules: igc</span><br><span class="line"></span><br><span class="line">03:00.0 Ethernet controller: Intel Corporation Ethernet Controller I226-V (rev 04)</span><br><span class="line">        Subsystem: Intel Corporation Ethernet Controller I226-V</span><br><span class="line">        Flags: bus master, fast devsel, latency 0, IRQ 16, IOMMU group 15</span><br><span class="line">        Memory at 80400000 (32-bit, non-prefetchable) [size=1M]</span><br><span class="line">        Memory at 80500000 (32-bit, non-prefetchable) [size=16K]</span><br><span class="line">        Capabilities: [40] Power Management version 3</span><br><span class="line">        Capabilities: [50] MSI: Enable- Count=1/1 Maskable+ 64bit+</span><br><span class="line">        Capabilities: [70] MSI-X: Enable+ Count=5 Masked-</span><br><span class="line">        Capabilities: [a0] Express Endpoint, MSI 00</span><br><span class="line">        Capabilities: [100] Advanced Error Reporting</span><br><span class="line">        Capabilities: [140] Device Serial Number a8-b8-e0-ff-ff-05-96-50</span><br><span class="line">        Capabilities: [1c0] Latency Tolerance Reporting</span><br><span class="line">        Capabilities: [1f0] Precision Time Measurement</span><br><span class="line">        Capabilities: [1e0] L1 PM Substates</span><br><span class="line">        Kernel driver in use: igc</span><br><span class="line">        Kernel modules: igc</span><br><span class="line"></span><br><span class="line">04:00.0 Network controller: Intel Corporation Wi-Fi 7(802.11be) AX1775*/AX1790*/BE20*/BE401/BE1750* 2x2 (rev 1a)</span><br><span class="line">        Subsystem: Intel Corporation Wi-Fi 7(802.11be) AX1775*/AX1790*/BE20*/BE401/BE1750* 2x2 (BE200 320MHz [Gale Peak])</span><br><span class="line">        Flags: bus master, fast devsel, latency 0, IRQ 17, IOMMU group 16</span><br><span class="line">        Memory at 80900000 (64-bit, non-prefetchable) [size=16K]</span><br><span class="line">        Capabilities: [40] Power Management version 3</span><br><span class="line">        Capabilities: [50] MSI: Enable- Count=1/1 Maskable- 64bit+</span><br><span class="line">        Capabilities: [70] Express Endpoint, MSI 00</span><br><span class="line">        Capabilities: [b0] MSI-X: Enable+ Count=32 Masked-</span><br><span class="line">        Capabilities: [100] Advanced Error Reporting</span><br><span class="line">        Capabilities: [148] Secondary PCI Express</span><br><span class="line">        Capabilities: [158] Physical Layer 16.0 GT/s &lt;?&gt;</span><br><span class="line">        Capabilities: [17c] Lane Margining at the Receiver &lt;?&gt;</span><br><span class="line">        Capabilities: [188] Latency Tolerance Reporting</span><br><span class="line">        Capabilities: [190] L1 PM Substates</span><br><span class="line">        Capabilities: [1a0] Vendor Specific Information: ID=0002 Rev=4 Len=100 &lt;?&gt;</span><br><span class="line">        Capabilities: [2a0] Data Link Feature &lt;?&gt;</span><br><span class="line">        Capabilities: [2ac] Precision Time Measurement</span><br><span class="line">        Capabilities: [2b8] Vendor Specific Information: ID=0003 Rev=1 Len=054 &lt;?&gt;</span><br><span class="line">        Capabilities: [500] Vendor Specific Information: ID=0023 Rev=1 Len=010 &lt;?&gt;</span><br><span class="line">        Kernel driver in use: iwlwifi</span><br><span class="line">        Kernel modules: iwlwifi</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">root@sense:~# ip a</span><br><span class="line">...</span><br><span class="line">2: enp2s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq master vmbr2 state UP group default qlen 1000</span><br><span class="line">    link/ether a8:b8:e0:05:96:4f brd ff:ff:ff:ff:ff:ff</span><br><span class="line">3: enp3s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq master vmbr3 state UP group default qlen 1000</span><br><span class="line">    link/ether a8:b8:e0:05:96:50 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">4: enp1s0f0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq master vmbr0 state UP group default qlen 1000</span><br><span class="line">    link/ether a8:b8:e0:05:96:4d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">5: enp1s0f1: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc mq master vmbr1 state DOWN group default qlen 1000</span><br><span class="line">    link/ether a8:b8:e0:05:96:4e brd ff:ff:ff:ff:ff:ff</span><br><span class="line">7: enp1s0f0v1: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000</span><br><span class="line">    link/ether 7a:de:19:c7:c2:ce brd ff:ff:ff:ff:ff:ff    </span><br><span class="line">...</span><br><span class="line">22: wlp4s0f0: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000</span><br><span class="line">    link/ether e0:8f:4c:b2:58:95 brd ff:ff:ff:ff:ff:ff</span><br></pre></td></tr></table></figure><p>Verify Intel 82599ES network card status:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# ethtool enp1s0f0</span><br><span class="line">Settings for enp1s0f0:</span><br><span class="line">        Supported ports: [ FIBRE ]</span><br><span class="line">        Supported link modes:   10000baseT/Full</span><br><span class="line">        Supported pause frame use: Symmetric</span><br><span class="line">        Supports auto-negotiation: No</span><br><span class="line">        Supported FEC modes: Not reported</span><br><span class="line">        Advertised link modes:  10000baseT/Full</span><br><span class="line">        Advertised pause frame use: Symmetric</span><br><span class="line">        Advertised auto-negotiation: No</span><br><span class="line">        Advertised FEC modes: Not reported</span><br><span class="line">        Speed: 10000Mb/s</span><br><span class="line">        Duplex: Full</span><br><span class="line">        Auto-negotiation: off</span><br><span class="line">        Port: FIBRE</span><br><span class="line">        PHYAD: 0</span><br><span class="line">        Transceiver: internal</span><br><span class="line">        Supports Wake-on: d</span><br><span class="line">        Wake-on: d</span><br><span class="line">        Current message level: 0x00000007 (7)</span><br><span class="line">                               drv probe link</span><br><span class="line">        Link detected: yes</span><br><span class="line"></span><br><span class="line">root@sense:~# ethtool -i enp1s0f0</span><br><span class="line">driver: ixgbe</span><br><span class="line">version: 6.8.12-2-pve</span><br><span class="line">firmware-version: 0x800003de</span><br><span class="line">expansion-rom-version: </span><br><span class="line">bus-info: 0000:01:00.0</span><br><span class="line">supports-statistics: yes</span><br><span class="line">supports-test: yes</span><br><span class="line">supports-eeprom-access: yes</span><br><span class="line">supports-register-dump: yes</span><br><span class="line">supports-priv-flags: yes</span><br></pre></td></tr></table></figure><p>Enable <strong>IOMMU</strong> in <code>Proxmox</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# cat /etc/default/grub | grep GRUB_CMDLINE_LINUX_DEFAULT</span><br><span class="line">GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet intel_iommu=on iommu=pt&quot;</span><br></pre></td></tr></table></figure><p>IOMMU PT mode improves the performance of other PCIe devices in the system when passthrough is being used.</p><p>Update GRUB:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# update-grub</span><br><span class="line">Generating grub configuration file ...</span><br><span class="line">Found linux image: /boot/vmlinuz-6.8.12-2-pve</span><br><span class="line">Found initrd image: /boot/initrd.img-6.8.12-2-pve</span><br><span class="line">Found linux image: /boot/vmlinuz-6.8.4-2-pve</span><br><span class="line">Found initrd image: /boot/initrd.img-6.8.4-2-pve</span><br><span class="line">Found memtest86+ 64bit EFI image: /boot/memtest86+x64.efi</span><br><span class="line">Adding boot menu entry for UEFI Firmware Settings ...</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>Reboot <code>Proxmox</code> and verify <strong>IOMMU</strong> is enabled:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# dmesg | grep -i IOMMU</span><br><span class="line">[    0.000000] Command line: BOOT_IMAGE=/boot/vmlinuz-6.8.12-2-pve root=/dev/mapper/pve-root ro quiet intel_iommu=on iommu=pt</span><br><span class="line">[    0.053988] Kernel command line: BOOT_IMAGE=/boot/vmlinuz-6.8.12-2-pve root=/dev/mapper/pve-root ro quiet intel_iommu=on iommu=pt</span><br><span class="line">[    0.054043] DMAR: IOMMU enabled</span><br><span class="line">[    0.145258] DMAR-IR: IOAPIC id 2 under DRHD base  0xfed91000 IOMMU 1</span><br><span class="line">[    0.403235] pci 0000:00:02.0: DMAR: Skip IOMMU disabling for graphics</span><br><span class="line">[    0.440538] iommu: Default domain type: Translated</span><br><span class="line">[    0.440538] iommu: DMA domain TLB invalidation policy: lazy mode</span><br><span class="line">[    0.483908] DMAR: IOMMU feature fl1gp_support inconsistent</span><br><span class="line">[    0.483909] DMAR: IOMMU feature pgsel_inv inconsistent</span><br><span class="line">[    0.483910] DMAR: IOMMU feature nwfs inconsistent</span><br><span class="line">[    0.483911] DMAR: IOMMU feature dit inconsistent</span><br><span class="line">[    0.483912] DMAR: IOMMU feature sc_support inconsistent</span><br><span class="line">[    0.483912] DMAR: IOMMU feature dev_iotlb_support inconsistent</span><br><span class="line">[    0.493686] pci 0000:00:02.0: Adding to iommu group 0</span><br><span class="line">[    0.493726] pci 0000:00:00.0: Adding to iommu group 1</span><br><span class="line">[    0.493739] pci 0000:00:0d.0: Adding to iommu group 2</span><br><span class="line">[    0.493764] pci 0000:00:14.0: Adding to iommu group 3</span><br><span class="line">[    0.493774] pci 0000:00:14.2: Adding to iommu group 3</span><br><span class="line">[    0.493786] pci 0000:00:16.0: Adding to iommu group 4</span><br><span class="line">[    0.493793] pci 0000:00:17.0: Adding to iommu group 5</span><br><span class="line">[    0.493806] pci 0000:00:1c.0: Adding to iommu group 6</span><br><span class="line">[    0.493820] pci 0000:00:1c.6: Adding to iommu group 7</span><br><span class="line">[    0.493831] pci 0000:00:1d.0: Adding to iommu group 8</span><br><span class="line">[    0.493842] pci 0000:00:1d.1: Adding to iommu group 9</span><br><span class="line">[    0.493859] pci 0000:00:1d.3: Adding to iommu group 10</span><br><span class="line">[    0.493878] pci 0000:00:1f.0: Adding to iommu group 11</span><br><span class="line">[    0.493886] pci 0000:00:1f.3: Adding to iommu group 11</span><br><span class="line">[    0.493895] pci 0000:00:1f.4: Adding to iommu group 11</span><br><span class="line">[    0.493903] pci 0000:00:1f.5: Adding to iommu group 11</span><br><span class="line">[    0.493918] pci 0000:01:00.0: Adding to iommu group 12</span><br><span class="line">[    0.493934] pci 0000:01:00.1: Adding to iommu group 13</span><br><span class="line">[    0.493945] pci 0000:02:00.0: Adding to iommu group 14</span><br><span class="line">[    0.493956] pci 0000:03:00.0: Adding to iommu group 15</span><br><span class="line">[    0.493982] pci 0000:04:00.0: Adding to iommu group 16</span><br><span class="line">[    0.493993] pci 0000:05:00.0: Adding to iommu group 17</span><br><span class="line">[    3.684070] pci 0000:01:10.1: Adding to iommu group 18</span><br><span class="line">[    3.684303] pci 0000:01:10.3: Adding to iommu group 19</span><br><span class="line">[    3.684501] pci 0000:01:10.5: Adding to iommu group 20</span><br><span class="line">[    3.684685] pci 0000:01:10.7: Adding to iommu group 21</span><br><span class="line">[    3.684885] pci 0000:01:11.1: Adding to iommu group 22</span><br><span class="line">[    3.685096] pci 0000:01:11.3: Adding to iommu group 23</span><br><span class="line">[    3.685296] pci 0000:01:11.5: Adding to iommu group 24</span><br><span class="line">[    3.685473] pci 0000:01:11.7: Adding to iommu group 25</span><br><span class="line">[    3.755233] pci 0000:01:10.0: Adding to iommu group 26</span><br><span class="line">[    3.755462] pci 0000:01:10.2: Adding to iommu group 27</span><br><span class="line">[    3.755761] pci 0000:01:10.4: Adding to iommu group 28</span><br><span class="line">[    3.755939] pci 0000:01:10.6: Adding to iommu group 29</span><br><span class="line">[    3.756107] pci 0000:01:11.0: Adding to iommu group 30</span><br><span class="line">[    3.756276] pci 0000:01:11.2: Adding to iommu group 31</span><br><span class="line">[    3.756444] pci 0000:01:11.4: Adding to iommu group 32</span><br><span class="line">[    3.756628] pci 0000:01:11.6: Adding to iommu group 33</span><br></pre></td></tr></table></figure><blockquote><p><strong>ATTENTION:</strong>  IOMMU Group not order by PCI BUS IDs</p></blockquote><p>This is an <strong><em>ISSUE</em></strong> CAN’T setup PCI Device Resource Mappings, because of errors, e.g., “Configuration for iommugroup not correct (‘21’ !&#x3D; ‘’27)” thrown, sometime, after <code>Proxmox</code> reboot! </p><p>Work around solution is go to <strong>Resource Mappings</strong> in <code>Proxmox</code>, edit, make no change and save:</p><p><img src="/blog/img/Intel%20Network%20-%20Resource%20Mappings.png" alt="Intel Network - Resource Mappings" title="Intel Network - Resource Mappings"></p><p>Filter out network card <strong>udev</strong> information, e.g., <strong>enp1s0f1</strong>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# udevadm info -e </span><br><span class="line">...</span><br><span class="line">P: /devices/pci0000:00/0000:00:1c.0/0000:01:00.1/net/enp1s0f1</span><br><span class="line">M: enp1s0f1</span><br><span class="line">R: 1</span><br><span class="line">U: net</span><br><span class="line">I: 5</span><br><span class="line">E: DEVPATH=/devices/pci0000:00/0000:00:1c.0/0000:01:00.1/net/enp1s0f1</span><br><span class="line">E: SUBSYSTEM=net</span><br><span class="line">E: INTERFACE=enp1s0f1</span><br><span class="line">E: IFINDEX=5</span><br><span class="line">E: USEC_INITIALIZED=2364228</span><br><span class="line">E: ID_NET_NAMING_SCHEME=v252</span><br><span class="line">E: ID_NET_NAME_MAC=enxa8b8e005964e</span><br><span class="line">E: ID_OUI_FROM_DATABASE=Changwang Technology inc.</span><br><span class="line">E: ID_NET_NAME_PATH=enp1s0f1</span><br><span class="line">E: ID_BUS=pci</span><br><span class="line">E: ID_VENDOR_ID=0x8086</span><br><span class="line">E: ID_MODEL_ID=0x10fb</span><br><span class="line">E: ID_PCI_CLASS_FROM_DATABASE=Network controller</span><br><span class="line">E: ID_PCI_SUBCLASS_FROM_DATABASE=Ethernet controller</span><br><span class="line">E: ID_VENDOR_FROM_DATABASE=Intel Corporation</span><br><span class="line">E: ID_MODEL_FROM_DATABASE=82599ES 10-Gigabit SFI/SFP+ Network Connection</span><br><span class="line">E: ID_PATH=pci-0000:01:00.1</span><br><span class="line">E: ID_PATH_TAG=pci-0000_01_00_1</span><br><span class="line">E: ID_NET_DRIVER=ixgbe</span><br><span class="line">E: ID_NET_LINK_FILE=/usr/lib/systemd/network/99-default.link</span><br><span class="line">E: ID_NET_NAME=enp1s0f1</span><br><span class="line">E: SYSTEMD_ALIAS=/sys/subsystem/net/devices/enp1s0f1</span><br><span class="line">E: TAGS=:systemd:</span><br><span class="line">E: CURRENT_TAGS=:systemd:</span><br><span class="line"></span><br><span class="line">P: /devices/pci0000:00/0000:00:1c.0/0000:01:00.1/net/enp1s0f1/ixgbe-mdio-0000:01:00.1</span><br><span class="line">M: ixgbe-mdio-0000:01:00.1</span><br><span class="line">R: 1</span><br><span class="line">U: mdio_bus</span><br><span class="line">E: DEVPATH=/devices/pci0000:00/0000:00:1c.0/0000:01:00.1/net/enp1s0f1/ixgbe-mdio-0000:01:00.1</span><br><span class="line">E: SUBSYSTEM=mdio_bus</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>Important information like: <strong>SUBSYSTEM&#x3D;net</strong>, <strong>INTERFACE&#x3D;enp1s0f1</strong>, <strong>ID_NET_DRIVER&#x3D;ixgbe</strong>, <strong>ID_NET_NAME&#x3D;enp1s0f1</strong> …</p><p>Assign <strong>8</strong> Virtual Network Cards:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# echo 8 &gt; /sys/class/net/enp1s0f0/device/sriov_numvfs </span><br><span class="line">root@sense:~# echo 8 &gt; /sys/class/net/enp1s0f1/device/sriov_numvfs </span><br></pre></td></tr></table></figure><p>Verify network cards again:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# lspci | grep Ethernet</span><br><span class="line">01:00.0 Ethernet controller: Intel Corporation 82599ES 10-Gigabit SFI/SFP+ Network Connection (rev 01)</span><br><span class="line">01:00.1 Ethernet controller: Intel Corporation 82599ES 10-Gigabit SFI/SFP+ Network Connection (rev 01)</span><br><span class="line">01:10.0 Ethernet controller: Intel Corporation 82599 Ethernet Controller Virtual Function (rev 01)</span><br><span class="line">...</span><br><span class="line">01:10.7 Ethernet controller: Intel Corporation 82599 Ethernet Controller Virtual Function (rev 01)</span><br><span class="line">01:11.0 Ethernet controller: Intel Corporation 82599 Ethernet Controller Virtual Function (rev 01)</span><br><span class="line">...</span><br><span class="line">01:11.7 Ethernet controller: Intel Corporation 82599 Ethernet Controller Virtual Function (rev 01)</span><br><span class="line">02:00.0 Ethernet controller: Intel Corporation Ethernet Controller I226-V (rev 04)</span><br><span class="line">03:00.0 Ethernet controller: Intel Corporation Ethernet Controller I226-V (rev 04)</span><br></pre></td></tr></table></figure><p>Persist number of SR_IOV Virtual Functions after <code>Proxmox</code> reboot:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# cat /etc/udev/rules.d/enp.rules </span><br><span class="line">ACTION==&quot;add&quot;, SUBSYSTEM==&quot;net&quot;, ENV&#123;INTERFACE&#125;==&quot;enp1s0f0&quot;, ATTR&#123;device/sriov_numvfs&#125;=&quot;8&quot;</span><br><span class="line">ACTION==&quot;add&quot;, SUBSYSTEM==&quot;net&quot;, ENV&#123;INTERFACE&#125;==&quot;enp1s0f1&quot;, ATTR&#123;device/sriov_numvfs&#125;=&quot;8&quot;</span><br></pre></td></tr></table></figure><p>Add Mapped PCI Devices into Virtual Machine in <code>Proxmox</code>:</p><p><img src="/blog/img/Intel%20Network%20-%20Mapped%20PCI%20Devices.png" alt="Intel Network - Mapped PCI Devices" title="Intel Network - Mapped PCI Devices"></p><p>Virtual Network Cards can be set up as Network Cards, with hardware direct access, from a Network Cards pool (shared by other Virtual Machines), when the first Network Card is available.</p><p><img src="/blog/img/Intel%20Network%20-%20Virtual%20Network%20Cards.png" alt="Intel Network - Virtual Network Cards" title="Intel Network - Virtual Network Cards"></p><p>Virtual Machine’s <code>Proxmox</code> configuration file:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">root@sense:/etc/pve/qemu-server# cat 101.conf</span><br><span class="line">agent: 1</span><br><span class="line">bios: ovmf</span><br><span class="line">boot: order=scsi0;ide2;net0</span><br><span class="line">cores: 8</span><br><span class="line">cpu: x86-64-v2-AES,flags=+aes</span><br><span class="line">efidisk0: local-lvm:vm-101-disk-0,efitype=4m,size=4M</span><br><span class="line">hostpci0: mapping=enp0_vf</span><br><span class="line">hostpci1: mapping=enp1_vf</span><br><span class="line">ide2: local:iso/OPNsense-24.7-dvd-amd64.iso,media=cdrom,size=2131548K</span><br><span class="line">machine: q35</span><br><span class="line">memory: 8192</span><br><span class="line">meta: creation-qemu=9.0.2,ctime=1731054484</span><br><span class="line">name: LINKsense</span><br><span class="line">net0: virtio=BC:24:11:0C:52:4B,bridge=vmbr2,firewall=1,queues=4</span><br><span class="line">net1: virtio=BC:24:11:21:3C:E0,bridge=vmbr3,firewall=1,queues=4</span><br><span class="line">numa: 0</span><br><span class="line">ostype: l26</span><br><span class="line">scsi0: local-lvm:vm-101-disk-1,discard=on,iothread=1,size=128G,ssd=1</span><br><span class="line">scsihw: virtio-scsi-single</span><br><span class="line">smbios1: uuid=3e913d90-c284-47d7-881a-599013fa21a4</span><br><span class="line">sockets: 1</span><br><span class="line">vmgenid: aab228d8-bccc-46c1-b627-927271ad20b6</span><br></pre></td></tr></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>Overview of the Intel VT Virtualization Features, <em><a href="https://www.thomas-krenn.com/en/wiki/Overview_of_the_Intel_VT_Virtualization_Features">https://www.thomas-krenn.com/en/wiki/Overview_of_the_Intel_VT_Virtualization_Features</a></em></li><li>How to Pass-through PCIe NICs with Proxmox VE on Intel and AMD, <em><a href="https://www.servethehome.com/how-to-pass-through-pcie-nics-with-proxmox-ve-on-intel-and-amd/">https://www.servethehome.com/how-to-pass-through-pcie-nics-with-proxmox-ve-on-intel-and-amd/</a></em></li><li>Persisting SR-IOV virtual functions after reboot, <em><a href="https://www.reddit.com/r/homelab/comments/hf12mv/persisting_sriov_virtual_functions_after_reboot/">https://www.reddit.com/r/homelab/comments/hf12mv/persisting_sriov_virtual_functions_after_reboot/</a></em></li><li>Chapter 11. Managing virtual devices, <em><a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_and_managing_virtualization/managing-virtual-devices_configuring-and-managing-virtualization">https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_and_managing_virtualization/managing-virtual-devices_configuring-and-managing-virtualization</a></em></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;Intel® 82599ES 10Gbps Ethernet Controller&lt;/strong&gt; &lt;em&gt;&lt;a href=&quot;https://ark.intel.com/content/www/us/en/ark/products/41282/intel-</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Homelab Router OPNsense and IPv6</title>
    <link href="https://terrencemiao.github.io/blog/2024/11/01/Homelab-Router-OPNsense-and-IPv6/"/>
    <id>https://terrencemiao.github.io/blog/2024/11/01/Homelab-Router-OPNsense-and-IPv6/</id>
    <published>2024-11-01T10:25:50.000Z</published>
    <updated>2024-11-23T00:27:26.305Z</updated>
    
    <content type="html"><![CDATA[<p>Current IPv6 setting on TP-Link Router, connecting to <strong>Buddy Telco &#x2F; Aussie Broadband</strong> ISP.</p><p><img src="/blog/img/OPNsense%20-%20TP-Link%20IPv6.png" alt="OPNsense - TP-Link IPv6" title="OPNsense - TP-Link IPv6"></p><h2 id="Setup-OPNsense-VM"><a href="#Setup-OPNsense-VM" class="headerlink" title="Setup OPNsense VM"></a>Setup OPNsense VM</h2><p>Create a new VM for OPNsense in Proxmox:</p><p><img src="/blog/img/OPNsense%20-%20VM%20General.png" alt="OPNsense - VM General" title="OPNsense - VM General"></p><p><img src="/blog/img/OPNsense%20-%20VM%20OS.png" alt="OPNsense - VM OS" title="OPNsense - VM OS"></p><p><img src="/blog/img/OPNsense%20-%20VM%20System.png" alt="OPNsense - VM System" title="OPNsense - VM System"></p><p><img src="/blog/img/OPNsense%20-%20VM%20Disks.png" alt="OPNsense - VM Disks" title="OPNsense - VM Disks"></p><p><img src="/blog/img/OPNsense%20-%20VM%20CPU.png" alt="OPNsense - VM CPU" title="OPNsense - VM CPU"></p><p><img src="/blog/img/OPNsense%20-%20VM%20Memory.png" alt="OPNsense - VM Memory" title="OPNsense - VM Memory"></p><p><img src="/blog/img/OPNsense%20-%20VM%20Network%20WAN.png" alt="OPNsense - VM Network WAN" title="OPNsense - VM Network WAN"></p><p><img src="/blog/img/OPNsense%20-%20VM%20Network%20LAN.png" alt="OPNsense - VM Network LAN" title="OPNsense - VM Network LAN"></p><p><img src="/blog/img/OPNsense%20-%20VM%20Network%20OPT1.png" alt="OPNsense - VM Network OPT1" title="OPNsense - VM Network OPT1"></p><p><img src="/blog/img/OPNsense%20-%20VM%20In%20Proxmox.png" alt="OPNsense - VM In Proxmox" title="OPNsense - VM In Proxmox"></p><p><img src="/blog/img/OPNsense%20-%20Proxmox%20Network.png" alt="OPNsense - Proxmox Network" title="OPNsense - Proxmox Network"></p><h2 id="Setup-IPv6"><a href="#Setup-IPv6" class="headerlink" title="Setup IPv6"></a>Setup IPv6</h2><p>Step by step to enable IPv6 with <strong>Buddy Telco &#x2F; Aussie Broadband</strong> ISP.</p><p><img src="/blog/img/OPNsense%20-%20Interfaces%20Settings.png" alt="OPNsense - Interfaces Settings" title="OPNsense - Interfaces Settings"></p><p><img src="/blog/img/OPNsense%20-%20WAN.png" alt="OPNsense - WAN" title="OPNsense - WAN"></p><ul><li>Enable DHCP&#x2F;DHCPv6 for IPv4&#x2F;IPv6 Configuration Type</li><li>Set ISP’s <strong>Prefix delegation size</strong> to <code>48</code></li><li>Enable <strong>Send prefix hint</strong></li></ul><p><img src="/blog/img/OPNsense%20-%20Router%20Advertisements.png" alt="OPNsense - Router Advertisements" title="OPNsense - Router Advertisements"></p><ul><li>Set <strong>Router Advertisements</strong> to <code>Unmanaged</code></li><li>Set <strong>Router Priority</strong> to <code>Normal</code></li></ul><h2 id="Setup-OPNsense-Optional-Port"><a href="#Setup-OPNsense-Optional-Port" class="headerlink" title="Setup OPNsense Optional Port"></a>Setup OPNsense Optional Port</h2><p>For example, setup <strong>OPT1</strong> interface after <code>OPNsense</code> installed in <code>Proxmox</code>.</p><ul><li>Enable <strong>OPT1</strong> Interface</li><li>Select <strong>Static IPv4</strong> for IPv4 Configuration Type</li><li>Select <strong>Track Interface</strong> for IPv6 Configuration Type</li><li>IPv4 address set to <strong>192.168.2.1&#x2F;24</strong></li><li>IPv6 parent interface set to <strong>WAN</strong></li><li>IPv6 prefix ID set to <strong>0x1</strong>. <strong>0x0</strong> has been assigned to <strong>LAN</strong></li><li>Enable <strong>Allow manual adjustment of DHCPv6 and Router Advertisements</strong></li></ul><p><img src="/blog/img/OPNsense%20-%20OPT1%20Interface.png" alt="OPNsense - OPT1 Interface" title="OPNsense - OPT1 Interface"></p><ul><li>Enable DHCP server on the OPT1 interface</li><li>Set IP range from <strong>192.168.2.10</strong> to <strong>192.168.2.245</strong></li></ul><p><img src="/blog/img/OPNsense%20-%20OPT1%20DHCP.png" alt="OPNsense - OPT1 DHCP" title="OPNsense - OPT1 DHCP"></p><ul><li>Add Firewall Rule</li><li>Set TCP&#x2F;IP version</li><li>Select <strong>OPT1 net</strong> from dropdown menu as Source</li></ul><p><img src="/blog/img/OPNsense%20-%20OPT1%20Firewall%20Rule.png" alt="OPNsense - OPT1 Firewall Rule" title="OPNsense - OPT1 Firewall Rule"></p><ul><li>Setup Firewall Rule for IPv4 on <strong>OPT1</strong> interface, then</li><li>Setup Firewall Rule for IPv6 on <strong>OPT1</strong> interface</li></ul><p><img src="/blog/img/OPNsense%20-%20OPT1%20Firewall.png" alt="OPNsense - OPT1 Firewall" title="OPNsense - OPT1 Firewall"></p><h2 id="VLAN"><a href="#VLAN" class="headerlink" title="VLAN"></a>VLAN</h2><p>Setup Trusted and Untrusted VLAN.</p><p><img src="/blog/img/OPNsense%20-%20VLAN.png" alt="OPNsense - VLAN" title="OPNsense - VLAN"></p><p><img src="/blog/img/OPNsense%20-%20VLAN%20Interfaces.png" alt="OPNsense - VLAN Interfaces" title="OPNsense - VLAN Interfaces"></p><p><img src="/blog/img/OPNsense%20-%20Trusted%20VLAN.png" alt="OPNsense - Trusted VLAN" title="OPNsense - Trusted VLAN"></p><p><img src="/blog/img/OPNsense%20-%20Untrusted%20VLAN.png" alt="OPNsense - Untrusted VLAN" title="OPNsense - Untrusted VLAN"></p><p>Then,</p><ul><li>Set <strong>Router Advertisements</strong> to <code>Unmanaged</code></li><li>Set <strong>Router Priority</strong> to <code>Normal</code></li></ul><p>for both VLANs. </p><h2 id="Running"><a href="#Running" class="headerlink" title="Running"></a>Running</h2><p>After all the change made above, reboot <code>OPNsense</code> instance.</p><p><img src="/blog/img/OPNsense%20-%20Run%20In%20Proxmox.png" alt="OPNsense - Run In Proxmox" title="OPNsense - Run In Proxmox"></p><p><img src="/blog/img/OPNsense%20-%20Interfaces%20Overview.png" alt="OPNsense - Interfaces Overview" title="OPNsense - Interfaces Overview"></p><p><img src="/blog/img/OPNsense%20-%20Dashboard.png" alt="OPNsense - Dashboard" title="OPNsense - Dashboard"></p><h2 id="IPv6-Test"><a href="#IPv6-Test" class="headerlink" title="IPv6 Test"></a>IPv6 Test</h2><ul><li><em><a href="https://test-ipv6.com/">https://test-ipv6.com/</a></em></li></ul><p><img src="/blog/img/OPNsense%20-%20Test%20IPv6.png" alt="OPNsense - Test IPv6" title="OPNsense - Test IPv6"></p><ul><li><em><a href="https://ipv6-test.com/">https://ipv6-test.com/</a></em></li></ul><p><img src="/blog/img/OPNsense%20-%20IPv6%20Test.png" alt="OPNsense - IPv6 Test" title="OPNsense - Test Test"></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>Virtualize OPNsense on Proxmox as Your Primary Router, <em><a href="https://homenetworkguy.com/how-to/virtualize-opnsense-on-proxmox-as-your-primary-router/">https://homenetworkguy.com/how-to/virtualize-opnsense-on-proxmox-as-your-primary-router/</a></em></li><li>How to Configure IPv6 in Your Home Network with ISP such as Comcast Xfinity, <em><a href="https://homenetworkguy.com/how-to/configure-ipv6-opnsense-with-isp-such-as-comcast-xfinity/">https://homenetworkguy.com/how-to/configure-ipv6-opnsense-with-isp-such-as-comcast-xfinity/</a></em></li><li>Beginner’s Guide to Set Up a Home Network Using OPNsense, <em><a href="https://homenetworkguy.com/how-to/beginners-guide-to-set-up-home-network-using-opnsense/">https://homenetworkguy.com/how-to/beginners-guide-to-set-up-home-network-using-opnsense/</a></em></li><li>OPNsense Optional Port Configuration, <em><a href="https://kb.protectli.com/kb/opnsense-optional-port-configuration/">https://kb.protectli.com/kb/opnsense-optional-port-configuration/</a></em></li><li>IPv6 setup, <em><a href="https://docs.opnsense.org/manual/ipv6.html">https://docs.opnsense.org/manual/ipv6.html</a></em></li><li>Anyone have IPv6 working with OPNSense? <em><a href="https://www.reddit.com/r/AussieBroadband/comments/10qldin/anyone_have_ipv6_working_with_opnsense/">https://www.reddit.com/r/AussieBroadband/comments/10qldin/anyone_have_ipv6_working_with_opnsense/</a></em>, <em><a href="https://f001.backblazeb2.com/b2api/v1/b2_download_file_by_id?fileId=4_zd344e4de4b297a128d680f16_f1019c6ea32f55c8f_d20240526_m042719_c001_v0001101_t0001_u01716697639553">https://f001.backblazeb2.com/b2api/v1/b2_download_file_by_id?fileId=4_zd344e4de4b297a128d680f16_f1019c6ea32f55c8f_d20240526_m042719_c001_v0001101_t0001_u01716697639553</a></em></li><li>Common Router Settings (Part of the Aussie Broadband article), <em><a href="https://whirlpool.net.au/wiki/aussie_broadband_ipv6_router_settings">https://whirlpool.net.au/wiki/aussie_broadband_ipv6_router_settings</a></em></li><li>Aussie Broadband IPv6 deployment journey, <em><a href="https://2022.apricot.net/assets/files/APNT374/aussie-broadband-ipv6-deployment-journey.pdf">https://2022.apricot.net/assets/files/APNT374/aussie-broadband-ipv6-deployment-journey.pdf</a></em></li><li>IPv6 Chart &#x2F; IPv4 CIDR Chart, <em><a href="https://www.ripe.net/media/documents/IPv6_Chart_2015.pdf">https://www.ripe.net/media/documents/IPv6_Chart_2015.pdf</a></em></li></ul><p><img src="/blog/img/OPNsense%20-%20IPv6%20Chart.png" alt="OPNsense - IPv6 Chart" title="OPNsense - IPv6 Chart"></p><p><img src="/blog/img/OPNsense%20-%20IPv4%20CIDR%20Chart.png" alt="OPNsense - IPv4 CIDR Chart" title="OPNsense - IPv4 CIDR Chart"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Current IPv6 setting on TP-Link Router, connecting to &lt;strong&gt;Buddy Telco &amp;#x2F; Aussie Broadband&lt;/strong&gt; ISP.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/im</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Turn On and Turn Off Recall in Windows 11</title>
    <link href="https://terrencemiao.github.io/blog/2024/10/26/Turn-On-and-Turn-Off-Recall-in-Windows-11/"/>
    <id>https://terrencemiao.github.io/blog/2024/10/26/Turn-On-and-Turn-Off-Recall-in-Windows-11/</id>
    <published>2024-10-25T14:15:03.000Z</published>
    <updated>2024-10-25T15:18:33.738Z</updated>
    
    <content type="html"><![CDATA[<p>Turn On <strong>Recall</strong> feature in <code>Windows 11 24H2</code>, by running Widnows Power Shell as <strong>Administrator</strong>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">PS C:\&gt; DISM /Online /Get-FeatureInfo /FeatureName:Recall</span><br><span class="line"></span><br><span class="line">Deployment Image Servicing and Management tool</span><br><span class="line">Version: 10.0.26100.1150</span><br><span class="line"></span><br><span class="line">Image Version: 10.0.26100.2033</span><br><span class="line"></span><br><span class="line">Feature Information:</span><br><span class="line"></span><br><span class="line">Feature Name : Recall</span><br><span class="line">Display Name : Recall</span><br><span class="line">Description : Recall application.</span><br><span class="line">Restart Required : Possible</span><br><span class="line">State : Enabled</span><br><span class="line"></span><br><span class="line">Custom Properties:</span><br><span class="line"></span><br><span class="line">(No custom properties found)</span><br><span class="line"></span><br><span class="line">The operation completed successfully.</span><br></pre></td></tr></table></figure><p>Turn Off <strong>Recall</strong> in <code>Windows 11 24H2</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PS C:\&gt; DISM /Online /Disable-Feature /FeatureName:Recall</span><br><span class="line"></span><br><span class="line">Deployment Image Servicing and Management tool</span><br><span class="line">Version: 10.0.26100.1150</span><br><span class="line"></span><br><span class="line">Image Version: 10.0.26100.2033</span><br><span class="line"></span><br><span class="line">Disabling feature(s)</span><br><span class="line">[==========================100.0%==========================]</span><br><span class="line">The operation completed successfully.</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Turn On &lt;strong&gt;Recall&lt;/strong&gt; feature in &lt;code&gt;Windows 11 24H2&lt;/code&gt;, by running Widnows Power Shell as &lt;strong&gt;Administrator&lt;/strong&gt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Running latest MacOS Sequoia in VMware on Windows 11</title>
    <link href="https://terrencemiao.github.io/blog/2024/10/16/Running-latest-MacOS-Sequoia-in-VMWare-on-Windows-11/"/>
    <id>https://terrencemiao.github.io/blog/2024/10/16/Running-latest-MacOS-Sequoia-in-VMWare-on-Windows-11/</id>
    <published>2024-10-16T05:06:59.000Z</published>
    <updated>2024-10-25T15:11:56.882Z</updated>
    
    <content type="html"><![CDATA[<p>This is the step by step guide, the fastest and easiest way install and run latest <code>MacOS Sequoia 15.0.1</code> in <code>VMware Workstation Pro</code> on <code>Windows 11</code>.</p><p>Due to <code>MacOS Sequoia</code> has added detection whether OS is running in Virtual Machine, so it’s better install <code>MacOS Sonoma</code> at first, then upgrade to latest version <code>MacOS Sequoia</code>.</p><p><img src="/blog/img/VMware%20-%20Apple%20ID.png" alt="VMware - Apple ID" title="VMware - Apple ID"></p><ul><li>Build a bootable MacOS ISO image</li></ul><p>Do it on a Mac. </p><p>Clone <code>gibmasOS</code> repo <em><a href="https://github.com/corpnewt/gibMacOS">https://github.com/corpnewt/gibMacOS</a></em> and run:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">$ ./gibMacOS.command</span><br><span class="line">#######################################################</span><br><span class="line">#                      gibMacOS                       #</span><br><span class="line">#######################################################</span><br><span class="line"></span><br><span class="line">Available Products:</span><br><span class="line"></span><br><span class="line">1. macOS Sequoia 15.0.1 (24A348)</span><br><span class="line">   - 072-01382 - Added 2024-10-03 21:26:40 - 14.48 GB</span><br><span class="line">2. macOS Ventura 13.7 (22H123)</span><br><span class="line">   - 062-78643 - Added 2024-09-16 17:44:05 - 12.22 GB</span><br><span class="line">3. macOS Sonoma 14.7 (23H124)</span><br><span class="line">   - 062-78824 - Added 2024-09-16 17:42:25 - 13.68 GB</span><br><span class="line">4. macOS Sequoia 15.0 (24A335)</span><br><span class="line">   - 062-78429 - Added 2024-09-16 17:30:21 - 14.48 GB</span><br><span class="line">5. macOS Monterey 12.7.6 (21H1320)</span><br><span class="line">   - 062-40406 - Added 2024-08-14 20:45:56 - 12.42 GB</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">24. macOS High Sierra 10.13.6 (17G66)</span><br><span class="line">   - 041-91758 - Added 2019-10-19 18:19:55 - 5.71 GB</span><br><span class="line">25. macOS Mojave 10.14.6 (18G103)</span><br><span class="line">   - 061-26589 - Added 2019-10-14 20:51:08 - 6.52 GB</span><br><span class="line">26. macOS Mojave 10.14.5 (18F2059)</span><br><span class="line">   - 061-26578 - Added 2019-10-14 20:38:26 - 6.52 GB</span><br><span class="line"></span><br><span class="line">M. Change Max-OS Version (Currently 12)</span><br><span class="line">C. Change Catalog (Currently publicrelease)</span><br><span class="line">I. Only Print URLs (Currently Off)</span><br><span class="line">S. Set Current Catalog to SoftwareUpdate Catalog</span><br><span class="line">L. Clear SoftwareUpdate Catalog</span><br><span class="line">R. Toggle Recovery-Only (Currently Off)</span><br><span class="line">U. Show Catalog URL</span><br><span class="line">Q. Quit</span><br><span class="line"></span><br><span class="line">Please select an option: 3</span><br><span class="line"></span><br><span class="line">Downloading InstallAssistant.pkg for 062-78824 - 14.7 macOS Sonoma (23H124)...</span><br><span class="line"></span><br><span class="line">1.35 GB/14.48 GB | =                    9.34% | 101.7 MB/s | 00:02:10 left</span><br><span class="line"></span><br><span class="line">Succeeded:</span><br><span class="line">  InstallAssistant.pkg</span><br><span class="line">  MajorOSInfo.pkg</span><br><span class="line">  com_apple_MobileAsset_MacSoftwareUpdate.plist</span><br><span class="line">  InstallInfo.plist</span><br><span class="line">  UpdateBrain.zip</span><br><span class="line"></span><br><span class="line">Failed:</span><br><span class="line">  None</span><br><span class="line"></span><br><span class="line">Files saved to:</span><br><span class="line">  /Users/terrence/Projects/gibMacOS/macOS Downloads/publicrelease/062-78824 - 14.7 macOS Sonoma (23H124)</span><br></pre></td></tr></table></figure><p>Run <code>InstallAssistant.pkg</code> from above MacOS download directory. It will be using to build ISO image.</p><p>Create a disk image with size 16GB:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hdiutil create -o /tmp/MacOS -size 16000m -volname MacOS -layout SPUD -fs HFS+J</span><br><span class="line">created: /tmp/MacOS.dmg</span><br></pre></td></tr></table></figure><p> Mount the disk image created above:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> $ hdiutil attach /tmp/MacOS.dmg -noverify -mountpoint /Volumes/MacOSISO</span><br><span class="line">/dev/disk6          Apple_partition_scheme         </span><br><span class="line">/dev/disk6s1        Apple_partition_map            </span><br><span class="line">/dev/disk6s2        Apple_HFS                      /Volumes/MacOSISO</span><br></pre></td></tr></table></figure><p>Create ISO image from <code>Install masOS app</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ sudo /Applications/Install\ macOS\ Sonoma.app/Contents/Resources/createinstallmedia --volume /Volumes/MacOSISO --nointeraction</span><br><span class="line">Erasing disk: 0%... 10%... 20%... 30%... 100%</span><br><span class="line">Copying essential files...</span><br><span class="line">Copying the macOS RecoveryOS...</span><br><span class="line">Making disk bootable...</span><br><span class="line">Copying to disk: 0%... 10%... 20%... 30%... 40%... 50%... 60%... 100%</span><br><span class="line">Install media now available at &quot;/Volumes/Install macOS Sonoma&quot;</span><br></pre></td></tr></table></figure><p>Unmount disk image and convert to an ISO image:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ hdiutil detach -force /Volumes/Install\ macOS\ Sonoma</span><br><span class="line">&quot;disk6&quot; ejected.</span><br><span class="line"></span><br><span class="line">$ ls -al /tmp/MacOS.dmg</span><br><span class="line">-rw-r--r--@ 1 terrence  wheel  16777216000 15 Oct 21:54 /tmp/MacOS.dmg</span><br><span class="line"></span><br><span class="line">$ hdiutil convert /tmp/MacOS.dmg -format UDTO -o /tmp/MacOS-Sonoma-14.7.cdr</span><br><span class="line">Reading Driver Descriptor Map (DDM : 0)…</span><br><span class="line">Reading Apple (Apple_partition_map : 1)…</span><br><span class="line">Reading  (Apple_Free : 2)…</span><br><span class="line">Reading disk image (Apple_HFS : 3)…</span><br><span class="line">........................................</span><br><span class="line">Elapsed Time: 19.139s</span><br><span class="line">Speed: 835.9MB/s</span><br><span class="line">Savings: 0.0%</span><br><span class="line">created: /tmp/MacOS-Sonoma-14.7.cdr</span><br><span class="line"></span><br><span class="line">$ mv /tmp/MacOS-Sonoma-14.7.cdr /tmp/MacOS-Sonoma-14.7.iso</span><br><span class="line"></span><br><span class="line">$ rm /tmp/MacOS.dmg</span><br></pre></td></tr></table></figure><ul><li>Install VMware Workstation Pro</li></ul><p>Download VMware Workstation Pro from e.g. <em><a href="https://softwareupdate.vmware.com/cds/vmw-desktop/ws/17.6.1/24319023/windows/core/VMware-workstation-17.6.1-24319023.exe.tar">https://softwareupdate.vmware.com/cds/vmw-desktop/ws/17.6.1/24319023/windows/core/VMware-workstation-17.6.1-24319023.exe.tar</a></em></p><ul><li>Patch VMware Workstation Pro</li></ul><p>Clone <code>unlocker</code> <em><a href="https://github.com/paolo-projects/unlocker">https://github.com/paolo-projects/unlocker</a></em> repo on Windows and enable <strong>Apple macOS</strong> option in <code>VMware Workstation Pro</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Projects\unlocker&gt; .\win-install.cmd</span><br><span class="line"></span><br><span class="line">Unlocker 3.0.2 for VMware Workstation</span><br><span class="line">=====================================</span><br><span class="line">(c) Dave Parsons 2011-18</span><br><span class="line"></span><br><span class="line">Set encoding parameters...</span><br><span class="line">Active code page: 850</span><br><span class="line"></span><br><span class="line">VMware is installed at: C:\Program Files (x86)\VMware\VMware Workstation\</span><br><span class="line">VMware product version: 17.6.1.24319023</span><br><span class="line"></span><br><span class="line">Stopping VMware services...</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Starting VMware services...</span><br><span class="line"></span><br><span class="line">Finished!</span><br></pre></td></tr></table></figure><p><img src="/blog/img/VMware%20-%20Apple%20macOS.png" alt="VMware - Apple macOS" title="VMware - Apple macOS"></p><ul><li>Add <code>VMware Tools</code></li></ul><p>Copy <code>darwin.iso</code> and <code>darwinPre15.iso</code> files extracted from <code>VMware Fusion</code> e.g. _<a href="https://softwareupdate.vmware.com/cds/vmw-desktop/fusion/12.2.5/20904517/x86/core/com.vmware.fusion.zip.tar">https://softwareupdate.vmware.com/cds/vmw-desktop/fusion/12.2.5/20904517/x86/core/com.vmware.fusion.zip.tar</a> _ into <code>VMware Workstation Pro</code> directory:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Projects\unlocker\tools\darwin.iso -&gt; C:\Program Files (x86)\VMware\VMware Workstation\darwin.iso</span><br><span class="line">C:\Projects\unlocker\tools\darwinPre15.iso -&gt; C:\Program Files (x86)\VMware\VMware Workstation\darwinPre15.iso</span><br></pre></td></tr></table></figure><ul><li>Create Virtual Machine for MacOS 14 Sonoma and update the settings</li></ul><p>Add: </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smc.version = &quot;0&quot;</span><br></pre></td></tr></table></figure><p>into <strong>MacOS Sonoma.vmx</strong> file.</p><p>Clone <code>GenSMBIOS</code> repo <em><a href="https://github.com/corpnewt/GenSMBIOS">https://github.com/corpnewt/GenSMBIOS</a></em> and generate serial number on Windows:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">$ ./GenSMBIOS.bat</span><br><span class="line">#######################################################</span><br><span class="line">#                     GenSMBIOS                       #</span><br><span class="line">#######################################################</span><br><span class="line"></span><br><span class="line">MacSerial not found!</span><br><span class="line">Remote Version v2.1.8</span><br><span class="line">Current plist: None</span><br><span class="line">Plist type:    Unknown</span><br><span class="line"></span><br><span class="line">1. Install/Update MacSerial</span><br><span class="line">2. Select config.plist</span><br><span class="line">3. Generate SMBIOS</span><br><span class="line">4. Generate UUID</span><br><span class="line">5. Generate ROM</span><br><span class="line">6. List Current SMBIOS</span><br><span class="line">7. Generate ROM With SMBIOS (Currently Enabled)</span><br><span class="line"></span><br><span class="line">Q. Quit</span><br><span class="line"></span><br><span class="line">Please select an option:  3</span><br><span class="line"></span><br><span class="line">Please type the SMBIOS to gen and the number</span><br><span class="line">of times to generate [max 20] (i.e. iMac18,3 5): MacBookPro16,4</span><br><span class="line"></span><br><span class="line">Type:         MacBookPro16,4</span><br><span class="line">Serial:       C..........T</span><br><span class="line">Board Serial: C0.............FB</span><br><span class="line">SmUUID:       A0D50403-F256-4E17-A2EC-29964D889A1D</span><br><span class="line">Apple ROM:    6..........7</span><br></pre></td></tr></table></figure><p>Copy <strong>Serial</strong>, <strong>Board Serial</strong> and <strong>Apple ROM</strong> number, apply to:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">board-id = &quot;Mac-A61BADE1FDAD7B05&quot;</span><br><span class="line">hw.model.reflectHost = &quot;FALSE&quot;</span><br><span class="line">hw.model = &quot;MacBookPro16,4&quot;</span><br><span class="line">serialNumber.reflectHost = &quot;FALSE&quot;</span><br><span class="line">serialNumber = &quot;C..........T&quot;</span><br><span class="line">smbios.reflectHost = &quot;FALSE&quot;</span><br><span class="line">efi.nvram.var.ROM.reflectHost = &quot;FALSE&quot;</span><br><span class="line">efi.nvram.var.MLB.reflectHost = &quot;FALSE&quot;</span><br><span class="line">efi.nvram.var.ROM = &quot;6..........7&quot;</span><br><span class="line">efi.nvram.var.MLB = &quot;C0.............FB&quot;</span><br></pre></td></tr></table></figure><p>then add above block into <strong>MacOS Sonoma.vmx</strong> file.</p><p>Based on Apple Ethernet MAC Address range <em><a href="https://hwaddress.com/company/apple-inc/">https://hwaddress.com/company/apple-inc/</a></em>, change and add network settings from:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ethernet0.addressType = &quot;generated&quot;</span><br></pre></td></tr></table></figure><p>to:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ethernet0.addressType = &quot;static&quot;</span><br><span class="line">ethernet0.address = &quot;00:21:E9:c0:92:76&quot;</span><br><span class="line">ethernet0.checkMacAddress = &quot;FALSE&quot;</span><br></pre></td></tr></table></figure><p>in <strong>MacOS Sonoma.vmx</strong> file.</p><p><img src="/blog/img/VMware%20-%20MacOS%20Sonoma.png" alt="VMware - MacOS Sonoma" title="VMware - MacOS Sonoma"></p><ul><li>Mount MacOS ISO image and install</li></ul><p><img src="/blog/img/VMware%20-%20MacOS%20Sonoma%20settings.png" alt="VMware - MacOS Sonoma settings" title="VMware - MacOS Sonoma settings"></p><p><strong>DON’T enable Location Service</strong> during the installation! Otherwise, you can’t setup Time Zone, Date Time based on your area. You can login with your <strong>Apple ID</strong> during the installation.</p><p><img src="/blog/img/VMware%20-%20Apple%20ID%20login.png" alt="VMware - Apple ID login" title="VMware - Apple ID login"></p><ul><li>Install <code>VMware Tools</code></li></ul><p>After MacOS installed and VM restarted, mount <code>darwin.iso</code> and install <code>VMware Tools</code>. Then Display Memory in MacOS becomes 128 MB, and support the <strong>Full Screen</strong> mode.</p><ul><li>Upgrade MacOS</li></ul><p>After <code>MacOS Sonoma</code> installed, make sure everything is OK, then copy the whole <strong>MacOS Sonoma</strong> directory to a new directory <strong>MacOS Sequoia (Upgraded)</strong>. Open the new directory in VMware, and select <strong>I copied it</strong>, then you can upgrade MacOS to latest verion in <em>System Settings -&gt; Software Update</em>.</p><ul><li>Run MacOS in <code>VMware Player</code>:</li></ul><p><img src="/blog/img/VMware%20-%20Player.png" alt="VMware - Player" title="VMware - Player"></p><p><img src="/blog/img/VMware%20-%20In%20Action.png" alt="VMware - In Action" title="VMware - In Action"></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>How to Install macOS Sequoia on VMware on Windows PC, <em><a href="https://www.youtube.com/watch?v=0ohUXE0Pj_U">https://www.youtube.com/watch?v=0ohUXE0Pj_U</a></em></li><li>The Definitive Guide to Running MacOS in Proxmox, <em><a href="https://klabsdev.com/definitive-guide-to-running-macos-in-proxmox/">https://klabsdev.com/definitive-guide-to-running-macos-in-proxmox/</a></em></li><li>List of Mac BoardID, DeviceID, Model Identifiers &amp; Machine Models, <em><a href="https://mrmacintosh.com/list-of-mac-boardid-deviceid-model-identifiers-machine-models/">https://mrmacintosh.com/list-of-mac-boardid-deviceid-model-identifiers-machine-models/</a></em></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;This is the step by step guide, the fastest and easiest way install and run latest &lt;code&gt;MacOS Sequoia 15.0.1&lt;/code&gt; in &lt;code&gt;VMware Work</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>How to access Ollama runs on localhost from internet</title>
    <link href="https://terrencemiao.github.io/blog/2024/10/12/How-to-access-Ollama-runs-on-localhost-from-internet/"/>
    <id>https://terrencemiao.github.io/blog/2024/10/12/How-to-access-Ollama-runs-on-localhost-from-internet/</id>
    <published>2024-10-12T11:53:37.000Z</published>
    <updated>2024-10-12T13:23:22.608Z</updated>
    
    <content type="html"><![CDATA[<p>By default, <code>Ollama</code> is only accessible from <strong>localhost</strong>. CORS error and HTTP 403 returned if try to invoke from other hosts.</p><p>To enable <code>Ollama</code> can be visited from hosts on intranet, run:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ launchctl setenv OLLAMA_HOST &quot;0.0.0.0&quot;</span><br></pre></td></tr></table></figure><p>in MacOS. Then restart <code>Ollama</code>. Then invoke it from hosts on intranet.</p><p>To enable <code>Ollama</code> can be visited from internet, with the help from <code>ngrok</code>, run:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ ngrok http 11434</span><br><span class="line"></span><br><span class="line">ngrok                                                     (Ctrl+C to quit)</span><br><span class="line"></span><br><span class="line">Session Status  online</span><br><span class="line">Account         Terrence Miao (Plan: Free)</span><br><span class="line">Version         3.17.0</span><br><span class="line">Region          Australia (au)</span><br><span class="line">Web Interface   http://127.0.0.1:4040</span><br><span class="line">Forwarding      https://294b-2403-5802-1c44-0-341c-aae8-a501-8b73.ngrok-free.app -&gt; http://localhost:11434</span><br><span class="line"></span><br><span class="line">Connections     ttl     opn     rt1     rt5     p50     p90</span><br><span class="line">                0       0       0.00    0.00    0.00    0.00</span><br></pre></td></tr></table></figure><p>Then can visit <code>Ollama</code> on <strong>localhost</strong> from internet. <code>11434</code> is default port of <code>Ollama</code>.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">$ curl --location &#x27;https://294b-2403-5802-1c44-0-341c-aae8-a501-8b73.ngrok-free.app/v1/models&#x27;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;object&quot;: &quot;list&quot;,</span><br><span class="line">    &quot;data&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: &quot;codellama:latest&quot;,</span><br><span class="line">            &quot;object&quot;: &quot;model&quot;,</span><br><span class="line">            &quot;created&quot;: 1728736149,</span><br><span class="line">            &quot;owned_by&quot;: &quot;library&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: &quot;deepseek-coder-v2:latest&quot;,</span><br><span class="line">            &quot;object&quot;: &quot;model&quot;,</span><br><span class="line">            &quot;created&quot;: 1728735883,</span><br><span class="line">            &quot;owned_by&quot;: &quot;library&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: &quot;mxbai-embed-large:latest&quot;,</span><br><span class="line">            &quot;object&quot;: &quot;model&quot;,</span><br><span class="line">            &quot;created&quot;: 1713401203,</span><br><span class="line">            &quot;owned_by&quot;: &quot;library&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: &quot;nomic-embed-text:latest&quot;,</span><br><span class="line">            &quot;object&quot;: &quot;model&quot;,</span><br><span class="line">            &quot;created&quot;: 1708780687,</span><br><span class="line">            &quot;owned_by&quot;: &quot;library&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>To write some code:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">$ curl --location &#x27;https://294b-2403-5802-1c44-0-341c-aae8-a501-8b73.ngrok-free.app/v1/chat/completions&#x27; \</span><br><span class="line">--header &#x27;Content-Type: application/json&#x27; \</span><br><span class="line">--data &#x27;&#123;</span><br><span class="line">    &quot;model&quot;: &quot;deepseek-coder-v2&quot;,</span><br><span class="line">    &quot;messages&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;role&quot;: &quot;system&quot;,</span><br><span class="line">            &quot;content&quot;: &quot;You are a helpful assistant.&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;role&quot;: &quot;user&quot;,</span><br><span class="line">            &quot;content&quot;: &quot;Write a function that outputs the fibonacci sequence in TypeScript.&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;&#x27;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;id&quot;: &quot;chatcmpl-174&quot;,</span><br><span class="line">  &quot;object&quot;: &quot;chat.completion&quot;,</span><br><span class="line">  &quot;created&quot;: 1728738926,</span><br><span class="line">  &quot;model&quot;: &quot;deepseek-coder-v2&quot;,</span><br><span class="line">  &quot;system_fingerprint&quot;: &quot;fp_ollama&quot;,</span><br><span class="line">  &quot;choices&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;index&quot;: 0,</span><br><span class="line">      &quot;message&quot;: &#123;</span><br><span class="line">        &quot;role&quot;: &quot;assistant&quot;,</span><br><span class="line">        &quot;content&quot;: &quot;</span><br><span class="line">        Certainly! Below is a TypeScript function that outputs the Fibonacci sequence up to a specified number of terms:</span><br><span class="line"></span><br><span class="line">        This function starts with the initial terms of the Fibonacci sequence `[0, 1]` and then iteratively calculates each subsequent term</span><br><span class="line">        by summing the two preceding terms. The function returns an array containing the first `n` terms of the Fibonacci sequence.</span><br><span class="line">        &quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;finish_reason&quot;: &quot;stop&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;usage&quot;: &#123;</span><br><span class="line">    &quot;prompt_tokens&quot;: 29,</span><br><span class="line">    &quot;completion_tokens&quot;: 243,</span><br><span class="line">    &quot;total_tokens&quot;: 272</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function fibonacciSequence(n: number): number[] &#123;</span><br><span class="line">  if (n &lt;= 0) return [];</span><br><span class="line">  if (n === 1) return [0];</span><br><span class="line"></span><br><span class="line">  const result: number[] = [0, 1];</span><br><span class="line"></span><br><span class="line">  for (let i = 2; i &lt; n; i++) &#123;</span><br><span class="line">    result.push(result[i - 1] + result[i - 2]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Example usage: console.log(fibonacciSequence(10));</span><br><span class="line">// Output: [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]</span><br></pre></td></tr></table></figure><p>Check <code>Ollama</code> log:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tail -f ~/.ollama/logs/server.log</span><br></pre></td></tr></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>Ollama FAQ, <em><a href="https://github.com/ollama/ollama/blob/main/docs/faq.md">https://github.com/ollama/ollama/blob/main/docs/faq.md</a></em></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;By default, &lt;code&gt;Ollama&lt;/code&gt; is only accessible from &lt;strong&gt;localhost&lt;/strong&gt;. CORS error and HTTP 403 returned if try to invoke fro</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Proxmox VE Helper Scripts</title>
    <link href="https://terrencemiao.github.io/blog/2024/09/27/Proxmox-VE-Helper-Scripts/"/>
    <id>https://terrencemiao.github.io/blog/2024/09/27/Proxmox-VE-Helper-Scripts/</id>
    <published>2024-09-27T12:58:54.000Z</published>
    <updated>2025-05-18T06:04:47.897Z</updated>
    
    <content type="html"><![CDATA[<p>Run <code>Proxmox VE Post Install</code> script:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/community-scripts/ProxmoxVE/main/tools/pve/post-pve-install.sh)&quot;</span><br></pre></td></tr></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>Proxmox VE Helper-Scripts, <em><a href="https://github.com/community-scripts/ProxmoxVE">https://github.com/community-scripts/ProxmoxVE</a></em></li><li>Virtualizing OPNsense on Proxmox as Your Primary Router, <em><a href="https://www.youtube.com/watch?v=VcTGKBHcqmk">https://www.youtube.com/watch?v=VcTGKBHcqmk</a></em></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Run &lt;code&gt;Proxmox VE Post Install&lt;/code&gt; script:&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Running a Mac app from Unidentified Developer on MacOS Sequoia</title>
    <link href="https://terrencemiao.github.io/blog/2024/09/19/Running-a-Mac-app-from-Unidentified-Developer-on-MacOS-Sequoia/"/>
    <id>https://terrencemiao.github.io/blog/2024/09/19/Running-a-Mac-app-from-Unidentified-Developer-on-MacOS-Sequoia/</id>
    <published>2024-09-19T00:16:23.000Z</published>
    <updated>2024-09-19T00:34:04.803Z</updated>
    
    <content type="html"><![CDATA[<p>Latest <code>MacOS Sequoia</code> has made another security enforcement. To open and run a Mac application, e.g. <code>VLC</code> nightly build at <em><a href="https://nightlies.videolan.org/">https://nightlies.videolan.org/</a></em>, <strong>Unidentified Developer</strong> , the following steps can take.</p><ul><li>Enable “Allow Applications from Anywhere”</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">base ~</span><br><span class="line">sudo spctl --master-disable</span><br><span class="line">Password:</span><br><span class="line">Globally disabling the assessment system needs to be confirmed in System Settings.</span><br></pre></td></tr></table></figure><p>Go to <strong>System Settings</strong> -&gt; <strong>Privacy &amp; Security</strong>, select “Allow Applications from Anywhere”:</p><p><img src="/blog/img/MacOS%20-%20Allow%20Applications%20from%20Anywhere.png" alt="MacOS - Allow Applications from Anywhere" title="MacOS - Allow Applications from Anywhere"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">base ~</span><br><span class="line">sudo spctl --master-enable</span><br><span class="line">Password:</span><br><span class="line">This operation is no longer supported. Please see the man page for more information.</span><br></pre></td></tr></table></figure><ul><li>Disable MacOS Quarantine on the application</li></ul><p>In this case application <code>VLC</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">base ~</span><br><span class="line">xattr -dr com.apple.quarantine /Applications/VLC.app</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Latest &lt;code&gt;MacOS Sequoia&lt;/code&gt; has made another security enforcement. To open and run a Mac application, e.g. &lt;code&gt;VLC&lt;/code&gt; nightly</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Configure and setup Mellanox network adapter</title>
    <link href="https://terrencemiao.github.io/blog/2024/09/17/Configure-and-setup-Mellanox-network-adapter/"/>
    <id>https://terrencemiao.github.io/blog/2024/09/17/Configure-and-setup-Mellanox-network-adapter/</id>
    <published>2024-09-17T01:42:01.000Z</published>
    <updated>2024-11-06T07:42:06.857Z</updated>
    
    <content type="html"><![CDATA[<p>A <em>Mellanox ConnectX-4 MCX455A-ECAT PCIe x16 3.0 100GBe VPI EDR IB</em> network adapter. Enable <code>VT-d</code>(Intel Virtualization Technology for Directed I&#x2F;O), <code>SR-IOV</code> (Single Root IO Virtualization), and the number of Virtual Functions in Chipset and Network in BIOS.</p><p>The following steps are made in a <code>Proxmox Virtual Environment (PVE)</code>.</p><h2 id="Configuration-and-Setup"><a href="#Configuration-and-Setup" class="headerlink" title="Configuration and Setup"></a>Configuration and Setup</h2><p>Go to NVIDIA Firmware Tools (MFT) <em><a href="https://network.nvidia.com/products/adapter-software/firmware-tools/">https://network.nvidia.com/products/adapter-software/firmware-tools/</a></em> and download the <code>MFT</code>; go to Updating Firmware for ConnectX®-4 VPI PCI Express Adapter Cards (InfiniBand, Ethernet, VPI) <em><a href="https://network.nvidia.com/support/firmware/connectx4ib/">https://network.nvidia.com/support/firmware/connectx4ib/</a></em> and download the updated firmware e.g. <code>mft-4.26.1-6-x86_64-deb.tgz</code>.</p><p>After installation, start up <strong>Mellanox Software Tools</strong> service:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@pve:~# mst start</span><br><span class="line">Starting MST (Mellanox Software Tools) driver set</span><br><span class="line">Loading MST PCI module - Success</span><br><span class="line">Loading MST PCI configuration module - Success</span><br><span class="line">Create devices</span><br><span class="line">Unloading MST PCI module (unused) - Success</span><br></pre></td></tr></table></figure><p>Check status:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@pve:~# mst status</span><br><span class="line">MST modules:</span><br><span class="line">------------</span><br><span class="line">    MST PCI module is not loaded</span><br><span class="line">    MST PCI configuration module loaded</span><br><span class="line"></span><br><span class="line">MST devices:</span><br><span class="line">------------</span><br><span class="line">/dev/mst/mt4115_pciconf0         - PCI configuration cycles access.</span><br><span class="line">                                   domain:bus:dev.fn=0000:06:00.0 addr.reg=88 data.reg=92 cr_bar.gw_offset=-1</span><br><span class="line">                                   Chip revision is: 00</span><br></pre></td></tr></table></figure><p>Query Mellanox network adapter:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@pve:~# flint -d /dev/mst/mt4115_pciconf0 query</span><br><span class="line">Image type:            FS3</span><br><span class="line">FW Version:            12.28.2006</span><br><span class="line">FW Release Date:       15.9.2020</span><br><span class="line">Product Version:       12.28.2006</span><br><span class="line">Rom Info:              type=UEFI version=14.21.17 cpu=AMD64</span><br><span class="line">                       type=PXE version=3.6.102 cpu=AMD64</span><br><span class="line">Description:           UID                GuidsNumber</span><br><span class="line">Base GUID:             ec0d9a030076eae2        4</span><br><span class="line">Base MAC:              ec0d9a76eae2            4</span><br><span class="line">Image VSD:             N/A</span><br><span class="line">Device VSD:            N/A</span><br><span class="line">PSID:                  LNV2180110032</span><br><span class="line">Security Attributes:   N/A</span><br></pre></td></tr></table></figure><p>Check Mellanox network adapter configuration:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@pve:~# mlxconfig -d /dev/mst/mt4115_pciconf0 query</span><br><span class="line">Device #1:</span><br><span class="line">----------</span><br><span class="line"></span><br><span class="line">Device type:        ConnectX4</span><br><span class="line">Name:               00KH925_Ax</span><br><span class="line">Description:        Mellanox ConnectX-4 EDR IB VPI Single-port x16 PCIe 3.0 HCA</span><br><span class="line">Device:             /dev/mst/mt4115_pciconf0</span><br><span class="line"></span><br><span class="line">Configurations:</span><br><span class="line">        LINK_TYPE_P1                                ETH(2)</span><br><span class="line">        SRIOV_EN                                    True(1)</span><br><span class="line">        NUM_OF_VFS                                  8</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>Verify network adapter configuration:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">terrence@pve:~# ethtool enp1s0np0</span><br><span class="line">Settings for enp1s0np0:</span><br><span class="line">Supported ports: [ Backplane ]</span><br><span class="line">Supported link modes:   1000baseKX/Full</span><br><span class="line">                        10000baseKR/Full</span><br><span class="line">                        40000baseKR4/Full</span><br><span class="line">                        40000baseCR4/Full</span><br><span class="line">                        40000baseSR4/Full</span><br><span class="line">                        40000baseLR4/Full</span><br><span class="line">                        56000baseKR4/Full</span><br><span class="line">                        25000baseCR/Full</span><br><span class="line">                        25000baseKR/Full</span><br><span class="line">                        25000baseSR/Full</span><br><span class="line">                        50000baseCR2/Full</span><br><span class="line">                        50000baseKR2/Full</span><br><span class="line">                        100000baseKR4/Full</span><br><span class="line">                        100000baseSR4/Full</span><br><span class="line">                        100000baseCR4/Full</span><br><span class="line">                        100000baseLR4_ER4/Full</span><br><span class="line">Supported pause frame use: Symmetric</span><br><span class="line">Supports auto-negotiation: Yes</span><br><span class="line">Supported FEC modes: None RS BASER</span><br><span class="line">Advertised link modes:  1000baseKX/Full</span><br><span class="line">                        10000baseKR/Full</span><br><span class="line">                        40000baseKR4/Full</span><br><span class="line">                        40000baseCR4/Full</span><br><span class="line">                        40000baseSR4/Full</span><br><span class="line">                        40000baseLR4/Full</span><br><span class="line">                        56000baseKR4/Full</span><br><span class="line">                        25000baseCR/Full</span><br><span class="line">                        25000baseKR/Full</span><br><span class="line">                        25000baseSR/Full</span><br><span class="line">                        50000baseCR2/Full</span><br><span class="line">                        50000baseKR2/Full</span><br><span class="line">                        100000baseKR4/Full</span><br><span class="line">                        100000baseSR4/Full</span><br><span class="line">                        100000baseCR4/Full</span><br><span class="line">                        100000baseLR4_ER4/Full</span><br><span class="line">Advertised pause frame use: Symmetric</span><br><span class="line">Advertised auto-negotiation: Yes</span><br><span class="line">Advertised FEC modes: RS</span><br><span class="line">Speed: 100000Mb/s</span><br><span class="line">Duplex: Full</span><br><span class="line">Auto-negotiation: on</span><br><span class="line">Port: Direct Attach Copper</span><br><span class="line">PHYAD: 0</span><br><span class="line">Transceiver: internal</span><br><span class="line">Link detected: yes</span><br></pre></td></tr></table></figure><h2 id="Virtualization"><a href="#Virtualization" class="headerlink" title="Virtualization"></a>Virtualization</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@pve:~# lspci | grep Mellanox</span><br><span class="line">06:00.0 Ethernet controller: Mellanox Technologies MT27700 Family [ConnectX-4]</span><br><span class="line"></span><br><span class="line">root@pve:~# ip link show</span><br><span class="line">...</span><br><span class="line">4: enp1s0np0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq master vmbr2 state UP mode DEFAULT group default qlen 1000</span><br><span class="line">    link/ether ec:0d:9a:76:eb:2a brd ff:ff:ff:ff:ff:ff</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>Write to the sysfs file the number of Virtual Functions:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@pve:~# echo 8 &gt; /sys/class/infiniband/mlx5_0/device/sriov_numvfs</span><br></pre></td></tr></table></figure><p>Verify that the Virtual Functions were created:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">root@pve:~# lspci | grep Mellanox</span><br><span class="line">01:00.0 Ethernet controller: Mellanox Technologies MT27700 Family [ConnectX-4]</span><br><span class="line">01:00.1 Ethernet controller: Mellanox Technologies MT27700 Family [ConnectX-4 Virtual Function]</span><br><span class="line">01:00.2 Ethernet controller: Mellanox Technologies MT27700 Family [ConnectX-4 Virtual Function]</span><br><span class="line">01:00.3 Ethernet controller: Mellanox Technologies MT27700 Family [ConnectX-4 Virtual Function]</span><br><span class="line">01:00.4 Ethernet controller: Mellanox Technologies MT27700 Family [ConnectX-4 Virtual Function]</span><br><span class="line">01:00.5 Ethernet controller: Mellanox Technologies MT27700 Family [ConnectX-4 Virtual Function]</span><br><span class="line">01:00.6 Ethernet controller: Mellanox Technologies MT27700 Family [ConnectX-4 Virtual Function]</span><br><span class="line">01:00.7 Ethernet controller: Mellanox Technologies MT27700 Family [ConnectX-4 Virtual Function]</span><br><span class="line">01:01.0 Ethernet controller: Mellanox Technologies MT27700 Family [ConnectX-4 Virtual Function]</span><br><span class="line"></span><br><span class="line">root@pve:~# ip link show</span><br><span class="line">...</span><br><span class="line">4: enp1s0np0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq master vmbr2 state UP mode DEFAULT group default qlen 1000</span><br><span class="line">    link/ether ec:0d:9a:76:eb:2a brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    vf 0     link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff, spoof checking off, link-state auto, trust off, query_rss off</span><br><span class="line">    vf 1     link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff, spoof checking off, link-state auto, trust off, query_rss off</span><br><span class="line">    vf 2     link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff, spoof checking off, link-state auto, trust off, query_rss off</span><br><span class="line">    vf 3     link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff, spoof checking off, link-state auto, trust off, query_rss off</span><br><span class="line">    vf 4     link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff, spoof checking off, link-state auto, trust off, query_rss off</span><br><span class="line">    vf 5     link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff, spoof checking off, link-state auto, trust off, query_rss off</span><br><span class="line">    vf 6     link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff, spoof checking off, link-state auto, trust off, query_rss off</span><br><span class="line">    vf 7     link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff, spoof checking off, link-state auto, trust off, query_rss off</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h2 id="Persistence"><a href="#Persistence" class="headerlink" title="Persistence"></a>Persistence</h2><p>Print out device information:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@pve:~# udevadm info /sys/class/infiniband/mlx5_0</span><br><span class="line">P: /devices/pci0000:00/0000:00:01.0/0000:01:00.0/infiniband/mlx5_0</span><br><span class="line">M: mlx5_0</span><br><span class="line">R: 0</span><br><span class="line">U: infiniband</span><br><span class="line">E: DEVPATH=/devices/pci0000:00/0000:00:01.0/0000:01:00.0/infiniband/mlx5_0</span><br><span class="line">E: SUBSYSTEM=infiniband</span><br><span class="line">E: NAME=mlx5_0</span><br></pre></td></tr></table></figure><p>Make the network adapter Virtual Functions persistent after reboot:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@pve:~# cat /etc/udev/rules.d/mlx.rules</span><br><span class="line">ACTION==&quot;add&quot;, SUBSYSTEM==&quot;infiniband&quot;, ENV&#123;NAME&#125;==&quot;mlx5_0&quot;, ATTR&#123;device/sriov_numvfs&#125;=&quot;8&quot;</span><br></pre></td></tr></table></figure><h2 id="Network-in-Proxmox"><a href="#Network-in-Proxmox" class="headerlink" title="Network in Proxmox"></a>Network in Proxmox</h2><p>Add virtualised network adapter in Resource Mappings in Proxmox:</p><p><img src="/blog/img/Mellanox%20-%20Resource%20Mappings.png" alt="Mellanox - Resource Mappings" title="Mellanox - Resource Mappings"></p><p>List PCI Devices in Resource Mappings in Proxmox which support Virtual Functions:</p><p><img src="/blog/img/Mellanox%20-%20Resource%20Mappings%20PCI%20Devices.png" alt="Mellanox - Resource Mappings PCI Devices" title="Mellanox - Resource Mappings PCI Devices"></p><p>Add PCI device in Resource Mappings in Proxmox in VM:</p><p><img src="/blog/img/Mellanox%20-%20Network%20PCI%20Device.png" alt="Mellanox - Network PCI Device" title="Mellanox - Network PCI Device"></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>Mellanox ConnectX-4 100Gb NIC Firmware Update and Ethernet Mode, <em><a href="https://www.youtube.com/watch?v=D1qN7Qg3bSg">https://www.youtube.com/watch?v=D1qN7Qg3bSg</a></em></li><li>Single Root IO Virtualization (SR-IOV), <em><a href="https://docs.nvidia.com/networking/display/mlnxofedv53100143/single+root+io+virtualization+(sr-iov)">https://docs.nvidia.com/networking/display/mlnxofedv53100143/single+root+io+virtualization+(sr-iov)</a></em></li><li>Persisting SR-IOV virtual functions after reboot, <em><a href="https://www.reddit.com/r/homelab/comments/hf12mv/persisting_sriov_virtual_functions_after_reboot/">https://www.reddit.com/r/homelab/comments/hf12mv/persisting_sriov_virtual_functions_after_reboot/</a></em></li><li>PCI Device Assignment with SR-IOV Devices, <em><a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7/html/virtualization_deployment_and_administration_guide/sect-pci_devices-pci_passthrough">https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7/html/virtualization_deployment_and_administration_guide/sect-pci_devices-pci_passthrough</a></em></li><li>100 Gbe &amp; TrueNAS Scale 23.10 iSCSI - Performance Unleashed, <em><a href="https://forum.level1techs.com/t/100-gbe-truenas-scale-23-10-iscsi-performance-unleashed/206452">https://forum.level1techs.com/t/100-gbe-truenas-scale-23-10-iscsi-performance-unleashed/206452</a></em></li><li>Single-Root IO Virtualization (SR-IOV) in Proxmox Virtual Environment (PVE) for Networking, <em><a href="https://www.youtube.com/watch?v=AdzeMpBIXlQ">https://www.youtube.com/watch?v=AdzeMpBIXlQ</a></em></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;A &lt;em&gt;Mellanox ConnectX-4 MCX455A-ECAT PCIe x16 3.0 100GBe VPI EDR IB&lt;/em&gt; network adapter. Enable &lt;code&gt;VT-d&lt;/code&gt;(Intel Virtualization</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Create Storage Pool in Windows Server 2022</title>
    <link href="https://terrencemiao.github.io/blog/2024/09/15/Create-Storage-Pool-in-Windows-Server-2022/"/>
    <id>https://terrencemiao.github.io/blog/2024/09/15/Create-Storage-Pool-in-Windows-Server-2022/</id>
    <published>2024-09-15T11:39:18.000Z</published>
    <updated>2024-09-15T11:46:28.435Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/blog/img/Storage%20Pool%20-%20Create.png" alt="Storage Pool - Create" title="Storage Pool - Create"></p><p><img src="/blog/img/Storage%20Pool%20-%20Physical%20Disks.png" alt="Storage Pool - Physical Disks" title="Storage Pool - Physical Disks"></p><p><img src="/blog/img/Storage%20Pool%20-%20Storage%20Layout.png" alt="Storage Pool - Storage Layout" title="Storage Pool - Storage Layout"></p><p><img src="/blog/img/Storage%20Pool%20-%20Virtual%20Disk.png" alt="Storage Pool - Virtual Disk" title="Storage Pool - Virtual Disk"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/blog/img/Storage%20Pool%20-%20Create.png&quot; alt=&quot;Storage Pool - Create&quot; title=&quot;Storage Pool - Create&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/im</summary>
      
    
    
    
    
  </entry>
  
</feed>
