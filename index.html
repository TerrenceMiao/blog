<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=330279473"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '330279473');
</script>
<!-- End Google Analytics -->

  
  <title>Terrence Miao&#39;s Adventures</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
    <meta name="description" content="Veni, vidi, vici">
  
  
  
    <link rel="alternate" href="/blog/atom.xml" title="Terrence Miao's Adventures" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/blog/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/blog/css/style.css">

  
    
<link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.min.css">

  
  
  
  
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7274218747178099" crossorigin="anonymous"></script>
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">Terrence Miao&#39;s Adventures</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/blog/" id="subtitle">A journey of a thousand miles begins with a single step</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/blog/."><i class="fa fa-home"></i> Home</a>
        
          <a class="main-nav-link" href="/blog/archives/"><i class="fa fa-archive"></i> Archive</a>
        
          <a class="main-nav-link" href="/blog/about/"><i class="fa fa-user"></i> About</a>
        
          <a class="main-nav-link" href="/blog/atom.xml"><i class="fa fa-rss"></i> RSS</a>
        
      </nav>
    </div>
    <div id="search-form">
      <div id="result-mask" class="hide"></div>
      <label><input id="search-key" type="text" autocomplete="off" placeholder="search"></label>
      <div id="result-wrap" class="hide">
        <div id="search-result"></div>
      </div>
      <div class="hide">
        <template id="search-tpl">
          <div class="item">
            <a href="/{path}" title="{title}">
              <div class="title">{title}</div>
              <div class="time">{date}</div>
              <div class="tags">{tags}</div>
            </a>
          </div>
        </template>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  <article id="post-How-to-install-and-run-ZeroTier-client-on-OpenWrt" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2024/12/21/How-to-install-and-run-ZeroTier-client-on-OpenWrt/">How to install and run ZeroTier client on OpenWrt</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2024-12-21T00:08:18.000Z" itemprop="datePublished">2024-12-21</time>
</span>
      
      
      
<a href="/blog/2024/12/21/How-to-install-and-run-ZeroTier-client-on-OpenWrt/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Install <code>ZeroTier</code> from <code>OpenWrt</code> console:</p>
<p><img src="/blog/img/OpenWrt%20-%20ZeroTier.png" alt="OpenWrt - ZeroTier" title="OpenWrt - ZeroTier"></p>
<p>Enable <code>ZeroTier</code> service in <code>OpenWrt</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -l root SenseWrt</span><br><span class="line">root@SenseWrt&#x27;s password: </span><br><span class="line"></span><br><span class="line">BusyBox v1.36.1 (2024-12-03 11:41:08 UTC) built-in shell (ash)</span><br><span class="line"></span><br><span class="line">  _______                     ________        __</span><br><span class="line"> |       |.-----.-----.-----.|  |  |  |.----.|  |_</span><br><span class="line"> |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|</span><br><span class="line"> |_______||   __|_____|__|__||________||__|  |____|</span><br><span class="line">          |__| W I R E L E S S   F R E E D O M</span><br><span class="line"> -----------------------------------------------------</span><br><span class="line"> OpenWrt 24.10.0-rc2, r28161-ea17e958b9</span><br><span class="line"> -----------------------------------------------------</span><br><span class="line"></span><br><span class="line">root@SenseWrt:~# cat /etc/config/zerotier </span><br><span class="line"></span><br><span class="line">config zerotier &#x27;global&#x27;</span><br><span class="line">	# Sets whether ZeroTier is enabled or not</span><br><span class="line">	option enabled 1</span><br><span class="line">	# Sets the ZeroTier listening port (default 9993; set to 0 for random)</span><br><span class="line">	#option port &#x27;9993&#x27;</span><br><span class="line">	# Client secret (leave blank to generate a secret on first run)</span><br><span class="line">	option secret &#x27;&#x27;</span><br><span class="line">	# Path of the optional file local.conf (see documentation at</span><br><span class="line">	# https://docs.zerotier.com/config#local-configuration-options)</span><br><span class="line">	#option local_conf_path &#x27;/etc/zerotier.conf&#x27;</span><br><span class="line">	# Persistent configuration directory (to perform other configurations such</span><br><span class="line">	# as controller mode or moons, etc.)</span><br><span class="line">	#option config_path &#x27;/etc/zerotier&#x27;</span><br><span class="line">	# Copy the contents of the persistent configuration directory to memory</span><br><span class="line">	# instead of linking it, this avoids writing to flash</span><br><span class="line">	#option copy_config_path &#x27;1&#x27;</span><br><span class="line"></span><br><span class="line"># Network configuration, you can have as many configurations as networks you</span><br><span class="line"># want to join (the network name is optional)</span><br><span class="line">config network &#x27;earth&#x27;</span><br><span class="line">	# Identifier of the network you wish to join</span><br><span class="line">	option id &#x27;8ca917257083e297&#x27;</span><br><span class="line">	# Network configuration parameters (all are optional, if not indicated the</span><br><span class="line">	# default values are set, see documentation at</span><br><span class="line">	# https://docs.zerotier.com/config/#network-specific-configuration)</span><br><span class="line">	option allow_managed &#x27;1&#x27;</span><br><span class="line">	option allow_global &#x27;0&#x27;</span><br><span class="line">	option allow_default &#x27;0&#x27;</span><br><span class="line">	option allow_dns &#x27;0&#x27;</span><br><span class="line"></span><br><span class="line"># Example of a second network (unnamed as it is optional)</span><br><span class="line">#config network</span><br><span class="line">#	option id &#x27;1234567890123456&#x27;</span><br><span class="line">#	option allow_managed &#x27;1&#x27;</span><br><span class="line">#	option allow_global &#x27;0&#x27;</span><br><span class="line">#	option allow_default &#x27;0&#x27;</span><br><span class="line">#	option allow_dns &#x27;0&#x27;</span><br></pre></td></tr></table></figure>

<p>Restart <code>ZeroTier</code> service:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ root@SenseWrt:~# /etc/init.d/zerotier restart</span><br><span class="line">Generating secret - please wait... done.</span><br></pre></td></tr></table></figure>

<p>Verify <code>ZeroTier</code> client status, which <strong>ztks555nye</strong> is the virtual network interface created on <code>OpenWrt</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@SenseWrt:~# zerotier-cli listnetworks</span><br><span class="line">200 listnetworks &lt;nwid&gt; &lt;name&gt; &lt;mac&gt; &lt;status&gt; &lt;type&gt; &lt;dev&gt; &lt;ZT assigned ips&gt;</span><br><span class="line">200 listnetworks 8ca917257083e297 igloo.studio 9a:09:7b:41:3d:26 OK PRIVATE ztks555nye 192.168.196.176/24</span><br></pre></td></tr></table></figure>

<p>Enable the new <code>ZeroTier</code> client <code>OpenWrt</code> in <em><a target="_blank" rel="noopener" href="https://my.zerotier.com/">https://my.zerotier.com/</a></em>.</p>
<p>Now add <code>ZeroTier</code> virtual network as a new interface in <code>OpenWrt</code>:</p>
<p><img src="/blog/img/OpenWrt%20-%20ZeroTier%20Network%20Interface.png" alt="OpenWrt - ZeroTier Network Interface" title="OpenWrt - ZeroTier Network Interface"></p>
<p>Create firewall for <code>ZeroTier</code> virtual network interface in <code>OpenWrt</code>:</p>
<p><img src="/blog/img/OpenWrt%20-%20ZeroTier%20Firewall.png" alt="OpenWrt - ZeroTier Firewall" title="OpenWrt - ZeroTier Firewall"></p>
<p>Configure firewall for <code>ZeroTier</code> virtual network interface in <code>OpenWrt</code>:</p>
<p><img src="/blog/img/OpenWrt%20-%20ZeroTier%20Firewall%20General%20Settings.png" alt="OpenWrt - ZeroTier Firewall General Settings" title="OpenWrt - ZeroTier Firewall General Settings"></p>
<p><strong>NOTE:</strong> <strong>opt</strong> network is for the downstream DHCP clients.</p>
<p>Add <strong>Allow-ZeroTier</strong> firewall rule:</p>
<p><img src="/blog/img/OpenWrt%20-%20ZeroTier%20Firewall%20Rule.png" alt="OpenWrt - ZeroTier Firewall Rule" title="OpenWrt - ZeroTier Firewall Rule"></p>
<p>Restart <code>ZeroTier</code> service again:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ root@SenseWrt:~# /etc/init.d/zerotier restart</span><br><span class="line">Generating secret - please wait... done.</span><br></pre></td></tr></table></figure>

<p>Then all <code>OpenWrt</code> clients can access <code>ZeroTier</code> network now.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li>韩风 Talk - 内网穿透工具 ZeroTier，从简单到复杂的玩法，无保留，一期全放送 <em><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=pa0tkch3lss">https://www.youtube.com/watch?v=pa0tkch3lss</a></em></li>
</ul>

        
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          


        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Connecting-OpenWRT-to-internet" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2024/12/05/Connecting-OpenWRT-to-internet/">Connecting OpenWRT to internet</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2024-12-05T03:19:34.000Z" itemprop="datePublished">2024-12-05</time>
</span>
      
      
      
<a href="/blog/2024/12/05/Connecting-OpenWRT-to-internet/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><code>OpenWRT</code> is running on <code>Proxmox</code>. Now setting up it to connect internet.</p>
<p>Add new network interface <strong>OPT</strong> on <strong>eth2</strong> adapter:</p>
<p><img src="/blog/img/OpenWRT%20-%20OPT%20Interface.png" alt="OpenWRT - OPT Interface" title="OpenWRT - OPT Interface"></p>
<p><img src="/blog/img/OpenWRT%20-%20OPT%20Advanced%20Settings.png" alt="OpenWRT - OPT Advanced Settings" title="OpenWRT - OPT Advanced Settings"></p>
<p><img src="/blog/img/OpenWRT%20-%20OPT%20Firewall%20Settings.png" alt="OpenWRT - OPT Firewall Settings" title="OpenWRT - OPT Firewall Settings"></p>
<p><img src="/blog/img/OpenWRT%20-%20OPT%20DHCP%20Server%20General%20Setup.png" alt="OpenWRT - OPT DHCP Server General Setup" title="OpenWRT - OPT DHCP Server General Setup"></p>
<p><img src="/blog/img/OpenWRT%20-%20OPT%20DHCP%20Server%20Advanced%20Settings.png" alt="OpenWRT - OPT DHCP Server Advanced Settings" title="OpenWRT - OPT DHCP Server Advanced Settings"></p>
<p><img src="/blog/img/OpenWRT%20-%20OPT%20DHCP%20Server%20IPv6%20Settings.png" alt="OpenWRT - OPT DHCP Server IPv6 Settings" title="OpenWRT - OPT DHCP Server IPv6 Settings"></p>
<p><img src="/blog/img/OpenWRT%20-%20OPT%20DHCP%20Server%20IPv6%20RA%20Settings.png" alt="OpenWRT - OPT DHCP Server IPv6 RA Settings" title="OpenWRT - OPT DHCP Server IPv6 RA Settings"></p>
<p><img src="/blog/img/OpenWRT%20-%20OPT.png" alt="OpenWRT - OPT" title="OpenWRT - OPT"></p>
<p>Add a new Firewall Zone, from network <strong>opt</strong> to <strong>wan</strong>:</p>
<p><img src="/blog/img/OpenWRT%20-%20Firewall%20Zone%20General%20Settings.png" alt="OpenWRT - Firewall Zone General Settings" title="OpenWRT - Firewall Zone General Settings"></p>
<p><img src="/blog/img/OpenWRT%20-%20Firewall%20Zone%20Advanced%20Settings.png" alt="OpenWRT - Firewall Zone Advanced Settings" title="OpenWRT - Firewall Zone Advanced Settings"></p>
<p><img src="/blog/img/OpenWRT%20-%20Firewall%20Zone%20Conntrack%20Settings.png" alt="OpenWRT - Firewall Zone Conntrack Settings" title="OpenWRT - Firewall Zone Conntrack Settings"></p>
<p><img src="/blog/img/OpenWRT%20-%20Firewall%20Zone.png" alt="OpenWRT - Firewall Zone" title="OpenWRT - Firewall Zone"></p>
<p>Add a new Firewall Traffic Rule for network <strong>opt</strong>:</p>
<p><img src="/blog/img/OpenWRT%20-%20Firewall%20Traffic%20Rule%20General%20Settings.png" alt="OpenWRT - Firewall Traffic Rule General Settings" title="OpenWRT - Firewall Traffic Rule General Settings"></p>
<p><img src="/blog/img/OpenWRT%20-%20Firewall%20Traffic%20Rule%20Advanced%20Settings.png" alt="OpenWRT - Firewall Traffic Rule Advanced Settings" title="OpenWRT - Firewall Traffic Rule Advanced Settings"></p>
<p><img src="/blog/img/OpenWRT%20-%20Firewall%20Traffic%20Rule%20Time%20Restrictions.png" alt="OpenWRT - Firewall Traffic Rule Time Restrictions" title="OpenWRT - Firewall Traffic Rule Time Restrictions"></p>
<p><img src="/blog/img/OpenWRT%20-%20Firewall%20Traffic%20Rule.png" alt="OpenWRT - Firewall Traffic Rule" title="OpenWRT - Firewall Traffic Rule"></p>
<p>Setup DHCP clients’ static IP addresses:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -l root 192.168.2.1</span><br><span class="line">root@192.168.2.1&#x27;s password:</span><br><span class="line"></span><br><span class="line">BusyBox v1.36.1 (2024-09-23 12:34:46 UTC) built-in shell (ash)</span><br><span class="line"></span><br><span class="line">  _______                     ________        __</span><br><span class="line"> |       |.-----.-----.-----.|  |  |  |.----.|  |_</span><br><span class="line"> |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|</span><br><span class="line"> |_______||   __|_____|__|__||________||__|  |____|</span><br><span class="line">          |__| W I R E L E S S   F R E E D O M</span><br><span class="line"> -----------------------------------------------------</span><br><span class="line"> OpenWrt 23.05.5, r24106-10cc5fcd00</span><br><span class="line"> -----------------------------------------------------</span><br><span class="line"></span><br><span class="line">root@OpenWRT:~# cat /etc/config/dhcp</span><br><span class="line">config dnsmasq</span><br><span class="line">	option domainneeded &#x27;1&#x27;</span><br><span class="line">	option localise_queries &#x27;1&#x27;</span><br><span class="line">	option rebind_protection &#x27;1&#x27;</span><br><span class="line">	option rebind_localhost &#x27;1&#x27;</span><br><span class="line">	option local &#x27;/local/&#x27;</span><br><span class="line">	option domain &#x27;local&#x27;</span><br><span class="line">	option expandhosts &#x27;1&#x27;</span><br><span class="line">	option cachesize &#x27;1000&#x27;</span><br><span class="line">	option authoritative &#x27;1&#x27;</span><br><span class="line">	option readethers &#x27;1&#x27;</span><br><span class="line">	option leasefile &#x27;/tmp/dhcp.leases&#x27;</span><br><span class="line">	option resolvfile &#x27;/tmp/resolv.conf.d/resolv.conf.auto&#x27;</span><br><span class="line">	option localservice &#x27;1&#x27;</span><br><span class="line">	option ednspacket_max &#x27;1232&#x27;</span><br><span class="line">...</span><br><span class="line">config host</span><br><span class="line">	option name &#x27;TL-SX3016F&#x27;</span><br><span class="line">	option ip &#x27;192.168.2.100&#x27;</span><br><span class="line">	option mac &#x27;3C:52:A1:47:23:5D&#x27;</span><br><span class="line"></span><br><span class="line">config host</span><br><span class="line">	option name &#x27;MikroTik&#x27;</span><br><span class="line">	option ip &#x27;192.168.2.110&#x27;</span><br><span class="line">	option mac &#x27;78:9A:18:D0:20:ED&#x27;</span><br><span class="line"></span><br><span class="line">config domain</span><br><span class="line">	option name &#x27;TL-SX3016F&#x27;</span><br><span class="line">	option ip &#x27;192.168.2.100&#x27;</span><br><span class="line"></span><br><span class="line">config domain</span><br><span class="line">	option name &#x27;MikroTik&#x27;</span><br><span class="line">	option ip &#x27;192.168.2.110&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/blog/img/OpenWRT%20-%20DHCP%20and%20DNS.png" alt="OpenWRT - DHCP and DNS" title="OpenWRT - DHCP and DNS"></p>

        
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          


        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Running-OpenWRT-on-Proxmox" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2024/12/03/Running-OpenWRT-on-Proxmox/">Running OpenWRT on Proxmox</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2024-12-03T01:46:37.000Z" itemprop="datePublished">2024-12-03</time>
</span>
      
      
      
<a href="/blog/2024/12/03/Running-OpenWRT-on-Proxmox/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li>Create <code>OpenWRT</code> VM in <code>Proxmox</code></li>
</ul>
<p><img src="/blog/img/OpenWRT%20-%20VM%20General.png" alt="OpenWRT - VM General" title="OpenWRT - VM General"></p>
<p><img src="/blog/img/OpenWRT%20-%20VM%20OS.png" alt="OpenWRT - VM OS" title="OpenWRT - VM OS"></p>
<p><img src="/blog/img/OpenWRT%20-%20VM%20System.png" alt="OpenWRT - VM System" title="OpenWRT - VM System"></p>
<p><img src="/blog/img/OpenWRT%20-%20VM%20Disks.png" alt="OpenWRT - VM Disks" title="OpenWRT - VM Disks"></p>
<p><img src="/blog/img/OpenWRT%20-%20VM%20CPU.png" alt="OpenWRT - VM CPU" title="OpenWRT - VM CPU"></p>
<p><img src="/blog/img/OpenWRT%20-%20VM%20Memory.png" alt="OpenWRT - VM Memory" title="OpenWRT - VM Memory"></p>
<p><img src="/blog/img/OpenWRT%20-%20VM%20Network.png" alt="OpenWRT - VM Network" title="OpenWRT - VM Network"></p>
<p>This is the <strong>LAN</strong>, and Firewall is <strong>DISABLED</strong>.</p>
<p><img src="/blog/img/OpenWRT%20-%20VM%20Confirm.png" alt="OpenWRT - VM Confirm" title="OpenWRT - VM Confirm"></p>
<p>Add <strong>WAN</strong> into VM, and Firewall is <strong>DISABLED</strong>.</p>
<p>Detach and delete current <strong>Hard Disk</strong>.</p>
<p>From <code>Proxmox</code> Console, download the latest OpenWRT image:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# wget https://downloads.openwrt.org/releases/23.05.5/targets/x86/64/openwrt-23.05.5-x86-64-generic-ext4-combined.img.gz</span><br><span class="line">--2024-12-03 12:20:33--  https://downloads.openwrt.org/releases/23.05.5/targets/x86/64/openwrt-23.05.5-x86-64-generic-ext4-combined.img.gz</span><br><span class="line">Resolving downloads.openwrt.org (downloads.openwrt.org)... 2a04:4e42:13::644, 151.101.82.132</span><br><span class="line">Connecting to downloads.openwrt.org (downloads.openwrt.org)|2a04:4e42:13::644|:443... failed: No route to host.</span><br><span class="line">Connecting to downloads.openwrt.org (downloads.openwrt.org)|151.101.82.132|:443... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 11352149 (11M) [application/octet-stream]</span><br><span class="line">Saving to: ‘openwrt-23.05.5-x86-64-generic-ext4-combined.img.gz’</span><br><span class="line"></span><br><span class="line">openwrt-23.05.5-x86-64-generic-ext4-combined.img.gz  100%[===================================================&gt;]  10.83M  --.-KB/s  in 0.1s    </span><br></pre></td></tr></table></figure>

<p>Create disk image for VM:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# gunzip openwrt-23.05.5-x86-64-generic-ext4-combined.img.gz</span><br><span class="line"></span><br><span class="line">root@sense:~# mv openwrt-23.05.5-x86-64-generic-ext4-combined.img openwrt.raw</span><br><span class="line"></span><br><span class="line"># increase the raw disk</span><br><span class="line">root@sense:~# qemu-img resize -f raw ./openwrt.raw 1024M</span><br><span class="line">Image resized.</span><br></pre></td></tr></table></figure>

<p>Convert <code>OpenWRT</code> image to VM disk:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># import the raw disk to OpenWRT VM</span><br><span class="line">root@sense:~# qm importdisk 104 openwrt.raw local-lvm</span><br><span class="line">Use of uninitialized value $dev in hash element at /usr/share/perl5/PVE/QemuServer/Drive.pm line 555.</span><br><span class="line">importing disk &#x27;openwrt.raw&#x27; to VM 104 ...</span><br><span class="line">  Logical volume &quot;vm-104-disk-0&quot; created.</span><br><span class="line">transferred 0.0 B of 1.0 GiB (0.00%)</span><br><span class="line">...</span><br><span class="line">transferred 1.0 GiB of 1.0 GiB (100.00%)</span><br><span class="line">unused0: successfully imported disk &#x27;local-lvm:vm-104-disk-0&#x27;</span><br></pre></td></tr></table></figure>

<p>Double click the <strong>Unused Disk</strong>, then click the Add button:</p>
<p><img src="/blog/img/OpenWRT%20-%20VM%20Unused%20Disk.png" alt="OpenWRT - VM Unused Disk" title="OpenWRT - VM Unused Disk"></p>
<p><img src="/blog/img/OpenWRT%20-%20VM%20Hardware.png" alt="OpenWRT - VM Hardware" title="OpenWRT - VM Hardware"></p>
<p><img src="/blog/img/OpenWRT%20-%20VM%20Boot%20Order.png" alt="OpenWRT - VM Boot Order" title="OpenWRT - VM Boot Order"></p>
<ul>
<li>Configure <code>OpenWRT</code></li>
</ul>
<p>Start up VM; change the user <strong>root</strong> password; set LAN ip address temporarily to <strong>192.168.2.3</strong> (Default: <strong>192.168.1.1</strong>):</p>
<p><img src="/blog/img/OpenWRT%20-%20Console.png" alt="OpenWRT - Console" title="OpenWRT - Console"></p>
<p>Login <code>OpenWRT</code> at <em><a target="_blank" rel="noopener" href="http://192.168.2.3/">http://192.168.2.3/</a></em>, via LAN port, and land on dashboard:</p>
<p><img src="/blog/img/OpenWRT%20-%20Login.png" alt="OpenWRT - Login" title="OpenWRT - Login"></p>
<p><img src="/blog/img/OpenWRT%20-%20Dashboard.png" alt="OpenWRT - Dashboard" title="OpenWRT - Dashboard"></p>
<ul>
<li>Themes</li>
</ul>
<p><strong>SSH</strong> login:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -l root 192.168.2.3</span><br><span class="line">The authenticity of host &#x27;192.168.2.3 (192.168.2.3)&#x27; can&#x27;t be established.</span><br><span class="line">ED25519 key fingerprint is SHA256:AggWAL1oU8+r1f84KoqpvcsYUylZOTfN0sXwHSby3b0.</span><br><span class="line">This key is not known by any other names.</span><br><span class="line">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="line">Warning: Permanently added &#x27;192.168.2.3&#x27; (ED25519) to the list of known hosts.</span><br><span class="line">root@192.168.2.3&#x27;s password: </span><br><span class="line">  _______                     ________        __</span><br><span class="line"> |       |.-----.-----.-----.|  |  |  |.----.|  |_</span><br><span class="line"> |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|</span><br><span class="line"> |_______||   __|_____|__|__||________||__|  |____|</span><br><span class="line">          |__| W I R E L E S S   F R E E D O M</span><br><span class="line"> -----------------------------------------------------</span><br><span class="line"> OpenWrt 23.05.5, r24106-10cc5fcd00</span><br><span class="line"> -----------------------------------------------------</span><br><span class="line"></span><br><span class="line">BusyBox v1.36.1 (2024-09-23 12:34:46 UTC) built-in shell (ash)</span><br></pre></td></tr></table></figure>

<p><code>OpenWRT</code> packages configuration:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">root@OpenWrt:~# ls -al /etc/opkg</span><br><span class="line">drwxr-xr-x    3 root     root          4096 Dec  6 02:46 .</span><br><span class="line">drwxr-xr-x   23 root     root          4096 Dec  6 02:41 ..</span><br><span class="line">-rw-r--r--    1 root     root           103 Sep 23 12:34 customfeeds.conf</span><br><span class="line">-rw-r--r--    1 root     root           555 Dec  6 02:46 distfeeds.conf</span><br><span class="line">drwxr-xr-x    2 root     root          4096 Sep 23 12:34 keys</span><br><span class="line"></span><br><span class="line">root@OpenWrt:~# ls -al /var/opkg-lists/</span><br><span class="line">drwxr-xr-x    2 root     root           320 Dec  6 03:15 .</span><br><span class="line">drwxrwxrwt   17 root     root           440 Dec  6 03:15 ..</span><br><span class="line">-rw-r--r--    1 root     root         72705 Dec  6 03:15 openwrt_base</span><br><span class="line">-rw-r--r--    1 root     root           142 Dec  6 03:15 openwrt_base.sig</span><br><span class="line">-rw-r--r--    1 root     root         10039 Dec  6 03:15 openwrt_core</span><br><span class="line">-rw-r--r--    1 root     root           142 Dec  6 03:15 openwrt_core.sig</span><br><span class="line">-rw-r--r--    1 root     root        100416 Dec  6 03:15 openwrt_kmods</span><br><span class="line">-rw-r--r--    1 root     root           142 Dec  6 03:15 openwrt_kmods.sig</span><br><span class="line">-rw-r--r--    1 root     root        197242 Dec  6 03:15 openwrt_luci</span><br><span class="line">-rw-r--r--    1 root     root           142 Dec  6 03:15 openwrt_luci.sig</span><br><span class="line">-rw-r--r--    1 root     root        516243 Dec  6 03:15 openwrt_packages</span><br><span class="line">-rw-r--r--    1 root     root           142 Dec  6 03:15 openwrt_packages.sig</span><br><span class="line">-rw-r--r--    1 root     root          9918 Dec  6 03:15 openwrt_routing</span><br><span class="line">-rw-r--r--    1 root     root           142 Dec  6 03:15 openwrt_routing.sig</span><br><span class="line">-rw-r--r--    1 root     root         58240 Dec  6 03:15 openwrt_telephony</span><br><span class="line">-rw-r--r--    1 root     root           142 Dec  6 03:15 openwrt_telephony.sig</span><br></pre></td></tr></table></figure>

<p>There is some issue with <strong>IPv6</strong> support in <code>OpenWRT</code> when download update. Errors thrown when <strong>wan</strong> connected to a <strong>IPv6</strong> router: </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@OpenWrt:~# opkg update</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/targets/x86/64/packages/Packages.gz</span><br><span class="line">*** Failed to download the package list from https://downloads.openwrt.org/releases/23.05.5/targets/x86/64/packages/Packages.gz</span><br><span class="line">...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/telephony/Packages.gz</span><br><span class="line">*** Failed to download the package list from https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/telephony/Packages.gz</span><br><span class="line"></span><br><span class="line">Collected errors:</span><br><span class="line"> * opkg_download: Failed to download https://downloads.openwrt.org/releases/23.05.5/targets/x86/64/packages/Packages.gz, wget returned 4.</span><br><span class="line"> * opkg_download: Check your network settings and connectivity.</span><br><span class="line">...</span><br><span class="line"> * opkg_download: Failed to download https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/telephony/Packages.gz, wget returned 4.</span><br><span class="line"> * opkg_download: Check your network settings and connectivity.</span><br></pre></td></tr></table></figure>

<p>Turn off <strong>IPv6</strong> on router to workaround.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@OpenWRT:~# opkg update</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/targets/x86/64/packages/Packages.gz</span><br><span class="line">Updated list of available packages in /var/opkg-lists/openwrt_core</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/targets/x86/64/packages/Packages.sig</span><br><span class="line">Signature check passed.</span><br><span class="line">...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/telephony/Packages.gz</span><br><span class="line">Updated list of available packages in /var/opkg-lists/openwrt_telephony</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/telephony/Packages.sig</span><br><span class="line">Signature check passed.</span><br></pre></td></tr></table></figure>

<p>Install <code>OpenWRT2020</code> Theme <em><a target="_blank" rel="noopener" href="https://openwrt.org/docs/guide-user/luci/luci.themes">https://openwrt.org/docs/guide-user/luci/luci.themes</a></em>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@OpenWRT:~# opkg install luci-theme-openwrt-2020</span><br><span class="line">Installing luci-theme-openwrt-2020 (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-theme-openwrt-2020_git-24.332.79522-a493155_all.ipk</span><br><span class="line">Configuring luci-theme-openwrt-2020.</span><br></pre></td></tr></table></figure>

<p>Install Argon Theme <em><a target="_blank" rel="noopener" href="https://github.com/jerrykuku/luci-theme-argon">https://github.com/jerrykuku/luci-theme-argon</a></em>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">root@OpenWRT:~# opkg install luci-compat</span><br><span class="line">Installing luci-compat (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-compat_git-24.332.79522-a493155_all.ipk</span><br><span class="line">Installing liblua5.1.5 (5.1.5-11) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/base/liblua5.1.5_5.1.5-11_x86_64.ipk</span><br><span class="line">Installing lua (5.1.5-11) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/base/lua_5.1.5-11_x86_64.ipk</span><br><span class="line">Installing luci-lib-nixio (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-lib-nixio_git-24.332.79522-a493155_x86_64.ipk</span><br><span class="line">Installing luci-lib-ip (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-lib-ip_git-24.332.79522-a493155_x86_64.ipk</span><br><span class="line">Installing luci-lib-jsonc (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-lib-jsonc_git-24.332.79522-a493155_x86_64.ipk</span><br><span class="line">Installing liblucihttp-lua (2023-03-15-9b5b683f-1) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/liblucihttp-lua_2023-03-15-9b5b683f-1_x86_64.ipk</span><br><span class="line">Installing luci-lib-base (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-lib-base_git-24.332.79522-a493155_all.ipk</span><br><span class="line">Installing libubus-lua (2023-06-05-f787c97b-1) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/base/libubus-lua_2023-06-05-f787c97b-1_x86_64.ipk</span><br><span class="line">Installing ucode-mod-lua (1) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/ucode-mod-lua_1_x86_64.ipk</span><br><span class="line">Installing luci-lua-runtime (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-lua-runtime_git-24.332.79522-a493155_x86_64.ipk</span><br><span class="line">Configuring liblua5.1.5.</span><br><span class="line">Configuring lua.</span><br><span class="line">Configuring luci-lib-nixio.</span><br><span class="line">Configuring luci-lib-ip.</span><br><span class="line">Configuring luci-lib-jsonc.</span><br><span class="line">Configuring liblucihttp-lua.</span><br><span class="line">Configuring luci-lib-base.</span><br><span class="line">Configuring libubus-lua.</span><br><span class="line">Configuring ucode-mod-lua.</span><br><span class="line">Configuring luci-lua-runtime.</span><br><span class="line">Configuring luci-compat.</span><br><span class="line"></span><br><span class="line">root@OpenWRT:~# opkg install luci-lib-ipkg</span><br><span class="line">Installing luci-lib-ipkg (git-24.332.79522-a493155) to root...</span><br><span class="line">Downloading https://downloads.openwrt.org/releases/23.05.5/packages/x86_64/luci/luci-lib-ipkg_git-24.332.79522-a493155_all.ipk</span><br><span class="line">Configuring luci-lib-ipkg.</span><br><span class="line"></span><br><span class="line">root@OpenWRT:~# wget --no-check-certificate -O luci-theme-argon.ipk https://github.com/jerrykuku/luci-theme-argon/releases/download/v2.3.1/luci-theme-argon_2.3.1_all.ipk</span><br><span class="line">root@OpenWRT:~# wget --no-check-certificate -O luci-app-argon-config.ipk https://github.com/jerrykuku/luci-app-argon-config/releases/download/v0.9/luci-app-argon-config_0.9_all.ipk</span><br></pre></td></tr></table></figure>

<p>There are ERRORS:</p>
<ul>
<li><em>&#x2F;&#x2F;usr&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;luci-theme-argon.postinst: .: line 2: can’t open ‘&#x2F;etc&#x2F;uci-defaults&#x2F;30_luci-theme-argon’: No such file or directory</em></li>
<li><em>&#x2F;&#x2F;usr&#x2F;lib&#x2F;opkg&#x2F;info&#x2F;luci-app-argon-config.postinst: .: line 2: can’t open ‘&#x2F;etc&#x2F;uci-defaults&#x2F;luci-argon-config’: No such file or directory</em></li>
</ul>
<p>thrown when try to install these packages.</p>
<p>A workaround solution is modify <strong>&#x2F;lib&#x2F;functions.sh</strong> file, replace line: 282:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">( [ -f &quot;$i&quot; ] &amp;&amp; cd &quot;$(dirname $i)&quot; &amp;&amp; . &quot;$i&quot; ) &amp;&amp; rm -f &quot;$i&quot;</span><br></pre></td></tr></table></figure>

<p>with: </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">( [ -f &quot;$i&quot; ] &amp;&amp; cd &quot;$(dirname $i)&quot; &amp;&amp; . &quot;$i&quot; ) &amp;&amp; echo</span><br></pre></td></tr></table></figure>

<p>temporarily. Then run installation:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@OpenWRT:~# opkg install luci-theme-argon.ipk </span><br><span class="line">Installing luci-theme-argon (2.3.1) to root...</span><br><span class="line">Configuring luci-theme-argon.</span><br><span class="line"></span><br><span class="line">root@OpenWRT:~# opkg install luci-app-argon-config.ipk </span><br><span class="line">Installing luci-app-argon-config (0.9) to root...</span><br><span class="line">Configuring luci-app-argon-config.</span><br></pre></td></tr></table></figure>

<ul>
<li>Upgrade</li>
</ul>
<p>To upgrade all of the <code>OpenWRT</code> packages:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@OpenWRT:~# opkg list-upgradable | cut -f 1 -d &#x27; &#x27; | xargs -r opkg upgrade  </span><br></pre></td></tr></table></figure>


<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li>Run an OpenWRT VM on Proxmox VE, <em><a target="_blank" rel="noopener" href="https://i12bretro.github.io/tutorials/0405.html">https://i12bretro.github.io/tutorials/0405.html</a></em></li>
<li>My Mobile HomeLab! (Travel Router with Proxmox, Docker, and OpenWRT), <em><a target="_blank" rel="noopener" href="https://technotim.live/posts/mobile-homelab/">https://technotim.live/posts/mobile-homelab/</a></em></li>
</ul>

        
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          


        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Fixing-Multimedia-Audio-Controller-driver-missing-issue-in-Windows-11" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2024/11/25/Fixing-Multimedia-Audio-Controller-driver-missing-issue-in-Windows-11/">Fixing Multimedia Audio Controller driver missing issue in Windows 11</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2024-11-25T06:21:43.000Z" itemprop="datePublished">2024-11-25</time>
</span>
      
      
      
<a href="/blog/2024/11/25/Fixing-Multimedia-Audio-Controller-driver-missing-issue-in-Windows-11/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Error thrown while missing <strong>Multimedia Audio Driver</strong> driver in Device Manager in Windows 11:</p>
<p><img src="/blog/img/Windows%20-%20Multimedia%20Audio%20Controller.png" alt="Windows - Multimedia Audio Controller" title="Windows - Multimedia Audio Controller"></p>
<p>when runs on an Intel i3 N305 Mini PC <em><a target="_blank" rel="noopener" href="https://www.aliexpress.com/item/1005007278560105.html">https://www.aliexpress.com/item/1005007278560105.html</a></em> </p>
<p><img src="/blog/img/Intel%20Network%20-%20Mini%20PC.png" alt="Intel Network - Mini PC" title="Intel Network - Mini PC"></p>
<p>Need this handy tool to find all the missing parts:</p>
<p><img src="/blog/img/Windows%20-%20Driver%20Identifier.png" alt="Windows - Driver Identifier" title="Windows - Driver Identifier"></p>
<p><code>Driver Identifier</code>, a digital assistant for your system’s hardware, can scan the device, identifies outdated or missing drivers, and provides a customized list of updates for your specific hardware:</p>
<p><img src="/blog/img/Windows%20-%20Drivers.png" alt="Windows - Drivers" title="Windows - Drivers"></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li>DriverIdentifier is a powerful tool that takes the hassle out of managing and updating drivers on your computer, <em><a target="_blank" rel="noopener" href="https://www.driveridentifier.com/">https://www.driveridentifier.com/</a></em></li>
</ul>

        
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          


        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Setting-up-DNS-Server-in-OPNsense" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2024/11/21/Setting-up-DNS-Server-in-OPNsense/">Setting up DNS Server in OPNsense</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2024-11-20T23:21:28.000Z" itemprop="datePublished">2024-11-21</time>
</span>
      
      
      
<a href="/blog/2024/11/21/Setting-up-DNS-Server-in-OPNsense/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Want to access Homelab network switches’ web based administrator interface in a user friendly way, i.e., access via <a target="_blank" rel="noopener" href="http://tl-sx3016f.local/">http://TL-SX3016F.local/</a>, <a target="_blank" rel="noopener" href="http://tl-sx3008f.local/">http://TL-SX3008F.local/</a> and <a target="_blank" rel="noopener" href="http://mikrotik.local/">http://MikroTik.local/</a>.</p>
<p>In TP-Link Deco, which is the main Homelab network backbone, also provides DHCP service, firstly is to reserve IP addresses for these switches:</p>
<p><img src="/blog/img/DNS%20-%20TP-Link%20Deco%20Reservation.jpg" alt="DNS - TP-Link Deco Reservation" title="DNS - TP-Link Deco Reservation"></p>
<p>Then setup entries in <code>OPNsense Unbound DNS</code> server:</p>
<p><img src="/blog/img/DNS%20-%20Host%20Overrides.png" alt="DNS - Host Overrides" title="DNS - Host Overrides"></p>
<p>Then lookup a host on local network:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$ cat /etc/resolv.conf</span><br><span class="line">#</span><br><span class="line"># macOS Notice</span><br><span class="line">#</span><br><span class="line"># This file is not consulted for DNS hostname resolution, address</span><br><span class="line"># resolution, or the DNS query routing mechanism used by most</span><br><span class="line"># processes on this system.</span><br><span class="line">#</span><br><span class="line"># To view the DNS configuration used by this system, use:</span><br><span class="line">#   scutil --dns</span><br><span class="line">#</span><br><span class="line"># SEE ALSO</span><br><span class="line">#   dns-sd(1), scutil(8)</span><br><span class="line">#</span><br><span class="line"># This file is automatically generated.</span><br><span class="line">#</span><br><span class="line">search local</span><br><span class="line">nameserver 2403:5802:8c44:3:be24:11ff:fe21:3ce0</span><br><span class="line">nameserver 192.168.68.1</span><br><span class="line"></span><br><span class="line">$ nslookup MikroTik.local</span><br><span class="line">Server:		2403:5802:8c44:3:be24:11ff:fe21:3ce0</span><br><span class="line">Address:	2403:5802:8c44:3:be24:11ff:fe21:3ce0#53</span><br><span class="line"></span><br><span class="line">Name:	MikroTik.local</span><br><span class="line">Address: 192.168.68.54</span><br></pre></td></tr></table></figure>

        
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          


        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Enable-SR-IOV-in-Intel-82599ES-10Gbps-Ethernet-Controller" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2024/11/08/Enable-SR-IOV-in-Intel-82599ES-10Gbps-Ethernet-Controller/">Enable SR-IOV in Intel 82599ES 10Gbps Ethernet Controller</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2024-11-08T10:06:48.000Z" itemprop="datePublished">2024-11-08</time>
</span>
      
      
      
<a href="/blog/2024/11/08/Enable-SR-IOV-in-Intel-82599ES-10Gbps-Ethernet-Controller/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><strong>Intel® 82599ES 10Gbps Ethernet Controller</strong> <em><a target="_blank" rel="noopener" href="https://ark.intel.com/content/www/us/en/ark/products/41282/intel-82599es-10-gigabit-ethernet-controller.html">https://ark.intel.com/content/www/us/en/ark/products/41282/intel-82599es-10-gigabit-ethernet-controller.html</a></em> supports <strong>SR-IOV</strong>, which is Intel® Virtualization Technology for Connectivity (VT-c) solution.</p>
<blockquote>
<p><strong>NOTE:</strong> Intel VT Virtualization Features</p>
</blockquote>
<ul>
<li><strong>VT-x</strong>, Intel Virtualization Technology for IA-32 and Intel 64 Processors</li>
<li><strong>VT-d</strong>, Intel Virtualization Technology for Directed I&#x2F;O</li>
<li><strong>VT-c</strong>, Intel Virtualization Technology for Connectivity</li>
</ul>
<p>The following step by step instructions is made in <code>Proxmox</code>.</p>
<p>Intel i3 N305 Mini PC <em><a target="_blank" rel="noopener" href="https://www.aliexpress.com/item/1005007278560105.html">https://www.aliexpress.com/item/1005007278560105.html</a></em> </p>
<p><img src="/blog/img/Intel%20Network%20-%20Mini%20PC.png" alt="Intel Network - Mini PC" title="Intel Network - Mini PC"></p>
<p>equips with two 10G SFP+ (Intel 82599ES) and two 2.5G (Intel i226-V) network cards:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# lspci -v </span><br><span class="line">...</span><br><span class="line">01:00.0 Ethernet controller: Intel Corporation 82599ES 10-Gigabit SFI/SFP+ Network Connection (rev 01)</span><br><span class="line">        Flags: bus master, fast devsel, latency 0, IRQ 16, IOMMU group 12</span><br><span class="line">        Memory at 80a20000 (64-bit, non-prefetchable) [size=128K]</span><br><span class="line">        I/O ports at 3020 [disabled] [size=32]</span><br><span class="line">        Memory at 80a44000 (64-bit, non-prefetchable) [size=16K]</span><br><span class="line">        Capabilities: [40] Power Management version 3</span><br><span class="line">        Capabilities: [50] MSI: Enable- Count=1/1 Maskable+ 64bit+</span><br><span class="line">        Capabilities: [70] MSI-X: Enable+ Count=64 Masked-</span><br><span class="line">        Capabilities: [a0] Express Endpoint, MSI 00</span><br><span class="line">        Capabilities: [e0] Vital Product Data</span><br><span class="line">        Capabilities: [100] Advanced Error Reporting</span><br><span class="line">        Capabilities: [140] Device Serial Number a8-b8-e0-ff-ff-05-96-4d</span><br><span class="line">        Capabilities: [150] Alternative Routing-ID Interpretation (ARI)</span><br><span class="line">        Capabilities: [160] Single Root I/O Virtualization (SR-IOV)</span><br><span class="line">        Kernel driver in use: ixgbe</span><br><span class="line">        Kernel modules: ixgbe</span><br><span class="line"></span><br><span class="line">01:00.1 Ethernet controller: Intel Corporation 82599ES 10-Gigabit SFI/SFP+ Network Connection (rev 01)</span><br><span class="line">        Flags: bus master, fast devsel, latency 0, IRQ 17, IOMMU group 13</span><br><span class="line">        Memory at 80a00000 (64-bit, non-prefetchable) [size=128K]</span><br><span class="line">        I/O ports at 3000 [disabled] [size=32]</span><br><span class="line">        Memory at 80a40000 (64-bit, non-prefetchable) [size=16K]</span><br><span class="line">        Capabilities: [40] Power Management version 3</span><br><span class="line">        Capabilities: [50] MSI: Enable- Count=1/1 Maskable+ 64bit+</span><br><span class="line">        Capabilities: [70] MSI-X: Enable+ Count=64 Masked-</span><br><span class="line">        Capabilities: [a0] Express Endpoint, MSI 00</span><br><span class="line">        Capabilities: [e0] Vital Product Data</span><br><span class="line">        Capabilities: [100] Advanced Error Reporting</span><br><span class="line">        Capabilities: [140] Device Serial Number a8-b8-e0-ff-ff-05-96-4d</span><br><span class="line">        Capabilities: [150] Alternative Routing-ID Interpretation (ARI)</span><br><span class="line">        Capabilities: [160] Single Root I/O Virtualization (SR-IOV)</span><br><span class="line">        Kernel driver in use: ixgbe</span><br><span class="line">        Kernel modules: ixgbe</span><br><span class="line"></span><br><span class="line">01:10.0 Ethernet controller: Intel Corporation 82599 Ethernet Controller Virtual Function (rev 01)</span><br><span class="line">        Flags: bus master, fast devsel, latency 0, IOMMU group 18</span><br><span class="line">        Memory at 4017000000 (64-bit, prefetchable) [virtual] [size=16K]</span><br><span class="line">        Memory at 4017100000 (64-bit, prefetchable) [virtual] [size=16K]</span><br><span class="line">        Capabilities: [70] MSI-X: Enable+ Count=3 Masked-</span><br><span class="line">        Capabilities: [a0] Express Endpoint, MSI 00</span><br><span class="line">        Capabilities: [100] Advanced Error Reporting</span><br><span class="line">        Capabilities: [150] Alternative Routing-ID Interpretation (ARI)</span><br><span class="line">        Kernel driver in use: vfio-pci</span><br><span class="line">        Kernel modules: ixgbevf</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">02:00.0 Ethernet controller: Intel Corporation Ethernet Controller I226-V (rev 04)</span><br><span class="line">        Subsystem: Intel Corporation Ethernet Controller I226-V</span><br><span class="line">        Flags: bus master, fast devsel, latency 0, IRQ 18, IOMMU group 14</span><br><span class="line">        Memory at 80600000 (32-bit, non-prefetchable) [size=1M]</span><br><span class="line">        Memory at 80700000 (32-bit, non-prefetchable) [size=16K]</span><br><span class="line">        Capabilities: [40] Power Management version 3</span><br><span class="line">        Capabilities: [50] MSI: Enable- Count=1/1 Maskable+ 64bit+</span><br><span class="line">        Capabilities: [70] MSI-X: Enable+ Count=5 Masked-</span><br><span class="line">        Capabilities: [a0] Express Endpoint, MSI 00</span><br><span class="line">        Capabilities: [100] Advanced Error Reporting</span><br><span class="line">        Capabilities: [140] Device Serial Number a8-b8-e0-ff-ff-05-96-4f</span><br><span class="line">        Capabilities: [1c0] Latency Tolerance Reporting</span><br><span class="line">        Capabilities: [1f0] Precision Time Measurement</span><br><span class="line">        Capabilities: [1e0] L1 PM Substates</span><br><span class="line">        Kernel driver in use: igc</span><br><span class="line">        Kernel modules: igc</span><br><span class="line"></span><br><span class="line">03:00.0 Ethernet controller: Intel Corporation Ethernet Controller I226-V (rev 04)</span><br><span class="line">        Subsystem: Intel Corporation Ethernet Controller I226-V</span><br><span class="line">        Flags: bus master, fast devsel, latency 0, IRQ 16, IOMMU group 15</span><br><span class="line">        Memory at 80400000 (32-bit, non-prefetchable) [size=1M]</span><br><span class="line">        Memory at 80500000 (32-bit, non-prefetchable) [size=16K]</span><br><span class="line">        Capabilities: [40] Power Management version 3</span><br><span class="line">        Capabilities: [50] MSI: Enable- Count=1/1 Maskable+ 64bit+</span><br><span class="line">        Capabilities: [70] MSI-X: Enable+ Count=5 Masked-</span><br><span class="line">        Capabilities: [a0] Express Endpoint, MSI 00</span><br><span class="line">        Capabilities: [100] Advanced Error Reporting</span><br><span class="line">        Capabilities: [140] Device Serial Number a8-b8-e0-ff-ff-05-96-50</span><br><span class="line">        Capabilities: [1c0] Latency Tolerance Reporting</span><br><span class="line">        Capabilities: [1f0] Precision Time Measurement</span><br><span class="line">        Capabilities: [1e0] L1 PM Substates</span><br><span class="line">        Kernel driver in use: igc</span><br><span class="line">        Kernel modules: igc</span><br><span class="line"></span><br><span class="line">04:00.0 Network controller: Intel Corporation Wi-Fi 7(802.11be) AX1775*/AX1790*/BE20*/BE401/BE1750* 2x2 (rev 1a)</span><br><span class="line">        Subsystem: Intel Corporation Wi-Fi 7(802.11be) AX1775*/AX1790*/BE20*/BE401/BE1750* 2x2 (BE200 320MHz [Gale Peak])</span><br><span class="line">        Flags: bus master, fast devsel, latency 0, IRQ 17, IOMMU group 16</span><br><span class="line">        Memory at 80900000 (64-bit, non-prefetchable) [size=16K]</span><br><span class="line">        Capabilities: [40] Power Management version 3</span><br><span class="line">        Capabilities: [50] MSI: Enable- Count=1/1 Maskable- 64bit+</span><br><span class="line">        Capabilities: [70] Express Endpoint, MSI 00</span><br><span class="line">        Capabilities: [b0] MSI-X: Enable+ Count=32 Masked-</span><br><span class="line">        Capabilities: [100] Advanced Error Reporting</span><br><span class="line">        Capabilities: [148] Secondary PCI Express</span><br><span class="line">        Capabilities: [158] Physical Layer 16.0 GT/s &lt;?&gt;</span><br><span class="line">        Capabilities: [17c] Lane Margining at the Receiver &lt;?&gt;</span><br><span class="line">        Capabilities: [188] Latency Tolerance Reporting</span><br><span class="line">        Capabilities: [190] L1 PM Substates</span><br><span class="line">        Capabilities: [1a0] Vendor Specific Information: ID=0002 Rev=4 Len=100 &lt;?&gt;</span><br><span class="line">        Capabilities: [2a0] Data Link Feature &lt;?&gt;</span><br><span class="line">        Capabilities: [2ac] Precision Time Measurement</span><br><span class="line">        Capabilities: [2b8] Vendor Specific Information: ID=0003 Rev=1 Len=054 &lt;?&gt;</span><br><span class="line">        Capabilities: [500] Vendor Specific Information: ID=0023 Rev=1 Len=010 &lt;?&gt;</span><br><span class="line">        Kernel driver in use: iwlwifi</span><br><span class="line">        Kernel modules: iwlwifi</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">root@sense:~# ip a</span><br><span class="line">...</span><br><span class="line">2: enp2s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq master vmbr2 state UP group default qlen 1000</span><br><span class="line">    link/ether a8:b8:e0:05:96:4f brd ff:ff:ff:ff:ff:ff</span><br><span class="line">3: enp3s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq master vmbr3 state UP group default qlen 1000</span><br><span class="line">    link/ether a8:b8:e0:05:96:50 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">4: enp1s0f0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq master vmbr0 state UP group default qlen 1000</span><br><span class="line">    link/ether a8:b8:e0:05:96:4d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">5: enp1s0f1: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc mq master vmbr1 state DOWN group default qlen 1000</span><br><span class="line">    link/ether a8:b8:e0:05:96:4e brd ff:ff:ff:ff:ff:ff</span><br><span class="line">7: enp1s0f0v1: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000</span><br><span class="line">    link/ether 7a:de:19:c7:c2:ce brd ff:ff:ff:ff:ff:ff    </span><br><span class="line">...</span><br><span class="line">22: wlp4s0f0: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000</span><br><span class="line">    link/ether e0:8f:4c:b2:58:95 brd ff:ff:ff:ff:ff:ff</span><br></pre></td></tr></table></figure>

<p>Verify Intel 82599ES network card status:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# ethtool enp1s0f0</span><br><span class="line">Settings for enp1s0f0:</span><br><span class="line">        Supported ports: [ FIBRE ]</span><br><span class="line">        Supported link modes:   10000baseT/Full</span><br><span class="line">        Supported pause frame use: Symmetric</span><br><span class="line">        Supports auto-negotiation: No</span><br><span class="line">        Supported FEC modes: Not reported</span><br><span class="line">        Advertised link modes:  10000baseT/Full</span><br><span class="line">        Advertised pause frame use: Symmetric</span><br><span class="line">        Advertised auto-negotiation: No</span><br><span class="line">        Advertised FEC modes: Not reported</span><br><span class="line">        Speed: 10000Mb/s</span><br><span class="line">        Duplex: Full</span><br><span class="line">        Auto-negotiation: off</span><br><span class="line">        Port: FIBRE</span><br><span class="line">        PHYAD: 0</span><br><span class="line">        Transceiver: internal</span><br><span class="line">        Supports Wake-on: d</span><br><span class="line">        Wake-on: d</span><br><span class="line">        Current message level: 0x00000007 (7)</span><br><span class="line">                               drv probe link</span><br><span class="line">        Link detected: yes</span><br><span class="line"></span><br><span class="line">root@sense:~# ethtool -i enp1s0f0</span><br><span class="line">driver: ixgbe</span><br><span class="line">version: 6.8.12-2-pve</span><br><span class="line">firmware-version: 0x800003de</span><br><span class="line">expansion-rom-version: </span><br><span class="line">bus-info: 0000:01:00.0</span><br><span class="line">supports-statistics: yes</span><br><span class="line">supports-test: yes</span><br><span class="line">supports-eeprom-access: yes</span><br><span class="line">supports-register-dump: yes</span><br><span class="line">supports-priv-flags: yes</span><br></pre></td></tr></table></figure>

<p>Enable <strong>IOMMU</strong> in <code>Proxmox</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# cat /etc/default/grub | grep GRUB_CMDLINE_LINUX_DEFAULT</span><br><span class="line">GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet intel_iommu=on iommu=pt&quot;</span><br></pre></td></tr></table></figure>

<p>IOMMU PT mode improves the performance of other PCIe devices in the system when passthrough is being used.</p>
<p>Update GRUB:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# update-grub</span><br><span class="line">Generating grub configuration file ...</span><br><span class="line">Found linux image: /boot/vmlinuz-6.8.12-2-pve</span><br><span class="line">Found initrd image: /boot/initrd.img-6.8.12-2-pve</span><br><span class="line">Found linux image: /boot/vmlinuz-6.8.4-2-pve</span><br><span class="line">Found initrd image: /boot/initrd.img-6.8.4-2-pve</span><br><span class="line">Found memtest86+ 64bit EFI image: /boot/memtest86+x64.efi</span><br><span class="line">Adding boot menu entry for UEFI Firmware Settings ...</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p>Reboot <code>Proxmox</code> and verify <strong>IOMMU</strong> is enabled:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# dmesg | grep -i IOMMU</span><br><span class="line">[    0.000000] Command line: BOOT_IMAGE=/boot/vmlinuz-6.8.12-2-pve root=/dev/mapper/pve-root ro quiet intel_iommu=on iommu=pt</span><br><span class="line">[    0.053988] Kernel command line: BOOT_IMAGE=/boot/vmlinuz-6.8.12-2-pve root=/dev/mapper/pve-root ro quiet intel_iommu=on iommu=pt</span><br><span class="line">[    0.054043] DMAR: IOMMU enabled</span><br><span class="line">[    0.145258] DMAR-IR: IOAPIC id 2 under DRHD base  0xfed91000 IOMMU 1</span><br><span class="line">[    0.403235] pci 0000:00:02.0: DMAR: Skip IOMMU disabling for graphics</span><br><span class="line">[    0.440538] iommu: Default domain type: Translated</span><br><span class="line">[    0.440538] iommu: DMA domain TLB invalidation policy: lazy mode</span><br><span class="line">[    0.483908] DMAR: IOMMU feature fl1gp_support inconsistent</span><br><span class="line">[    0.483909] DMAR: IOMMU feature pgsel_inv inconsistent</span><br><span class="line">[    0.483910] DMAR: IOMMU feature nwfs inconsistent</span><br><span class="line">[    0.483911] DMAR: IOMMU feature dit inconsistent</span><br><span class="line">[    0.483912] DMAR: IOMMU feature sc_support inconsistent</span><br><span class="line">[    0.483912] DMAR: IOMMU feature dev_iotlb_support inconsistent</span><br><span class="line">[    0.493686] pci 0000:00:02.0: Adding to iommu group 0</span><br><span class="line">[    0.493726] pci 0000:00:00.0: Adding to iommu group 1</span><br><span class="line">[    0.493739] pci 0000:00:0d.0: Adding to iommu group 2</span><br><span class="line">[    0.493764] pci 0000:00:14.0: Adding to iommu group 3</span><br><span class="line">[    0.493774] pci 0000:00:14.2: Adding to iommu group 3</span><br><span class="line">[    0.493786] pci 0000:00:16.0: Adding to iommu group 4</span><br><span class="line">[    0.493793] pci 0000:00:17.0: Adding to iommu group 5</span><br><span class="line">[    0.493806] pci 0000:00:1c.0: Adding to iommu group 6</span><br><span class="line">[    0.493820] pci 0000:00:1c.6: Adding to iommu group 7</span><br><span class="line">[    0.493831] pci 0000:00:1d.0: Adding to iommu group 8</span><br><span class="line">[    0.493842] pci 0000:00:1d.1: Adding to iommu group 9</span><br><span class="line">[    0.493859] pci 0000:00:1d.3: Adding to iommu group 10</span><br><span class="line">[    0.493878] pci 0000:00:1f.0: Adding to iommu group 11</span><br><span class="line">[    0.493886] pci 0000:00:1f.3: Adding to iommu group 11</span><br><span class="line">[    0.493895] pci 0000:00:1f.4: Adding to iommu group 11</span><br><span class="line">[    0.493903] pci 0000:00:1f.5: Adding to iommu group 11</span><br><span class="line">[    0.493918] pci 0000:01:00.0: Adding to iommu group 12</span><br><span class="line">[    0.493934] pci 0000:01:00.1: Adding to iommu group 13</span><br><span class="line">[    0.493945] pci 0000:02:00.0: Adding to iommu group 14</span><br><span class="line">[    0.493956] pci 0000:03:00.0: Adding to iommu group 15</span><br><span class="line">[    0.493982] pci 0000:04:00.0: Adding to iommu group 16</span><br><span class="line">[    0.493993] pci 0000:05:00.0: Adding to iommu group 17</span><br><span class="line">[    3.684070] pci 0000:01:10.1: Adding to iommu group 18</span><br><span class="line">[    3.684303] pci 0000:01:10.3: Adding to iommu group 19</span><br><span class="line">[    3.684501] pci 0000:01:10.5: Adding to iommu group 20</span><br><span class="line">[    3.684685] pci 0000:01:10.7: Adding to iommu group 21</span><br><span class="line">[    3.684885] pci 0000:01:11.1: Adding to iommu group 22</span><br><span class="line">[    3.685096] pci 0000:01:11.3: Adding to iommu group 23</span><br><span class="line">[    3.685296] pci 0000:01:11.5: Adding to iommu group 24</span><br><span class="line">[    3.685473] pci 0000:01:11.7: Adding to iommu group 25</span><br><span class="line">[    3.755233] pci 0000:01:10.0: Adding to iommu group 26</span><br><span class="line">[    3.755462] pci 0000:01:10.2: Adding to iommu group 27</span><br><span class="line">[    3.755761] pci 0000:01:10.4: Adding to iommu group 28</span><br><span class="line">[    3.755939] pci 0000:01:10.6: Adding to iommu group 29</span><br><span class="line">[    3.756107] pci 0000:01:11.0: Adding to iommu group 30</span><br><span class="line">[    3.756276] pci 0000:01:11.2: Adding to iommu group 31</span><br><span class="line">[    3.756444] pci 0000:01:11.4: Adding to iommu group 32</span><br><span class="line">[    3.756628] pci 0000:01:11.6: Adding to iommu group 33</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>ATTENTION:</strong>  IOMMU Group not order by PCI BUS IDs</p>
</blockquote>
<p>This is an <strong><em>ISSUE</em></strong> CAN’T setup PCI Device Resource Mappings, because of errors, e.g., “Configuration for iommugroup not correct (‘21’ !&#x3D; ‘’27)” thrown, sometime, after <code>Proxmox</code> reboot! </p>
<p>Work around solution is go to <strong>Resource Mappings</strong> in <code>Proxmox</code>, edit, make no change and save:</p>
<p><img src="/blog/img/Intel%20Network%20-%20Resource%20Mappings.png" alt="Intel Network - Resource Mappings" title="Intel Network - Resource Mappings"></p>
<p>Filter out network card <strong>udev</strong> information, e.g., <strong>enp1s0f1</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# udevadm info -e </span><br><span class="line">...</span><br><span class="line">P: /devices/pci0000:00/0000:00:1c.0/0000:01:00.1/net/enp1s0f1</span><br><span class="line">M: enp1s0f1</span><br><span class="line">R: 1</span><br><span class="line">U: net</span><br><span class="line">I: 5</span><br><span class="line">E: DEVPATH=/devices/pci0000:00/0000:00:1c.0/0000:01:00.1/net/enp1s0f1</span><br><span class="line">E: SUBSYSTEM=net</span><br><span class="line">E: INTERFACE=enp1s0f1</span><br><span class="line">E: IFINDEX=5</span><br><span class="line">E: USEC_INITIALIZED=2364228</span><br><span class="line">E: ID_NET_NAMING_SCHEME=v252</span><br><span class="line">E: ID_NET_NAME_MAC=enxa8b8e005964e</span><br><span class="line">E: ID_OUI_FROM_DATABASE=Changwang Technology inc.</span><br><span class="line">E: ID_NET_NAME_PATH=enp1s0f1</span><br><span class="line">E: ID_BUS=pci</span><br><span class="line">E: ID_VENDOR_ID=0x8086</span><br><span class="line">E: ID_MODEL_ID=0x10fb</span><br><span class="line">E: ID_PCI_CLASS_FROM_DATABASE=Network controller</span><br><span class="line">E: ID_PCI_SUBCLASS_FROM_DATABASE=Ethernet controller</span><br><span class="line">E: ID_VENDOR_FROM_DATABASE=Intel Corporation</span><br><span class="line">E: ID_MODEL_FROM_DATABASE=82599ES 10-Gigabit SFI/SFP+ Network Connection</span><br><span class="line">E: ID_PATH=pci-0000:01:00.1</span><br><span class="line">E: ID_PATH_TAG=pci-0000_01_00_1</span><br><span class="line">E: ID_NET_DRIVER=ixgbe</span><br><span class="line">E: ID_NET_LINK_FILE=/usr/lib/systemd/network/99-default.link</span><br><span class="line">E: ID_NET_NAME=enp1s0f1</span><br><span class="line">E: SYSTEMD_ALIAS=/sys/subsystem/net/devices/enp1s0f1</span><br><span class="line">E: TAGS=:systemd:</span><br><span class="line">E: CURRENT_TAGS=:systemd:</span><br><span class="line"></span><br><span class="line">P: /devices/pci0000:00/0000:00:1c.0/0000:01:00.1/net/enp1s0f1/ixgbe-mdio-0000:01:00.1</span><br><span class="line">M: ixgbe-mdio-0000:01:00.1</span><br><span class="line">R: 1</span><br><span class="line">U: mdio_bus</span><br><span class="line">E: DEVPATH=/devices/pci0000:00/0000:00:1c.0/0000:01:00.1/net/enp1s0f1/ixgbe-mdio-0000:01:00.1</span><br><span class="line">E: SUBSYSTEM=mdio_bus</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>Important information like: <strong>SUBSYSTEM&#x3D;net</strong>, <strong>INTERFACE&#x3D;enp1s0f1</strong>, <strong>ID_NET_DRIVER&#x3D;ixgbe</strong>, <strong>ID_NET_NAME&#x3D;enp1s0f1</strong> …</p>
<p>Assign <strong>8</strong> Virtual Network Cards:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# echo 8 &gt; /sys/class/net/enp1s0f0/device/sriov_numvfs </span><br><span class="line">root@sense:~# echo 8 &gt; /sys/class/net/enp1s0f1/device/sriov_numvfs </span><br></pre></td></tr></table></figure>

<p>Verify network cards again:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# lspci | grep Ethernet</span><br><span class="line">01:00.0 Ethernet controller: Intel Corporation 82599ES 10-Gigabit SFI/SFP+ Network Connection (rev 01)</span><br><span class="line">01:00.1 Ethernet controller: Intel Corporation 82599ES 10-Gigabit SFI/SFP+ Network Connection (rev 01)</span><br><span class="line">01:10.0 Ethernet controller: Intel Corporation 82599 Ethernet Controller Virtual Function (rev 01)</span><br><span class="line">...</span><br><span class="line">01:10.7 Ethernet controller: Intel Corporation 82599 Ethernet Controller Virtual Function (rev 01)</span><br><span class="line">01:11.0 Ethernet controller: Intel Corporation 82599 Ethernet Controller Virtual Function (rev 01)</span><br><span class="line">...</span><br><span class="line">01:11.7 Ethernet controller: Intel Corporation 82599 Ethernet Controller Virtual Function (rev 01)</span><br><span class="line">02:00.0 Ethernet controller: Intel Corporation Ethernet Controller I226-V (rev 04)</span><br><span class="line">03:00.0 Ethernet controller: Intel Corporation Ethernet Controller I226-V (rev 04)</span><br></pre></td></tr></table></figure>

<p>Persist number of SR_IOV Virtual Functions after <code>Proxmox</code> reboot:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@sense:~# cat /etc/udev/rules.d/enp.rules </span><br><span class="line">ACTION==&quot;add&quot;, SUBSYSTEM==&quot;net&quot;, ENV&#123;INTERFACE&#125;==&quot;enp1s0f0&quot;, ATTR&#123;device/sriov_numvfs&#125;=&quot;8&quot;</span><br><span class="line">ACTION==&quot;add&quot;, SUBSYSTEM==&quot;net&quot;, ENV&#123;INTERFACE&#125;==&quot;enp1s0f1&quot;, ATTR&#123;device/sriov_numvfs&#125;=&quot;8&quot;</span><br></pre></td></tr></table></figure>

<p>Add Mapped PCI Devices into Virtual Machine in <code>Proxmox</code>:</p>
<p><img src="/blog/img/Intel%20Network%20-%20Mapped%20PCI%20Devices.png" alt="Intel Network - Mapped PCI Devices" title="Intel Network - Mapped PCI Devices"></p>
<p>Virtual Network Cards can be set up as Network Cards, with hardware direct access, from a Network Cards pool (shared by other Virtual Machines), when the first Network Card is available.</p>
<p><img src="/blog/img/Intel%20Network%20-%20Virtual%20Network%20Cards.png" alt="Intel Network - Virtual Network Cards" title="Intel Network - Virtual Network Cards"></p>
<p>Virtual Machine’s <code>Proxmox</code> configuration file:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">root@sense:/etc/pve/qemu-server# cat 101.conf</span><br><span class="line">agent: 1</span><br><span class="line">bios: ovmf</span><br><span class="line">boot: order=scsi0;ide2;net0</span><br><span class="line">cores: 8</span><br><span class="line">cpu: x86-64-v2-AES,flags=+aes</span><br><span class="line">efidisk0: local-lvm:vm-101-disk-0,efitype=4m,size=4M</span><br><span class="line">hostpci0: mapping=enp0_vf</span><br><span class="line">hostpci1: mapping=enp1_vf</span><br><span class="line">ide2: local:iso/OPNsense-24.7-dvd-amd64.iso,media=cdrom,size=2131548K</span><br><span class="line">machine: q35</span><br><span class="line">memory: 8192</span><br><span class="line">meta: creation-qemu=9.0.2,ctime=1731054484</span><br><span class="line">name: LINKsense</span><br><span class="line">net0: virtio=BC:24:11:0C:52:4B,bridge=vmbr2,firewall=1,queues=4</span><br><span class="line">net1: virtio=BC:24:11:21:3C:E0,bridge=vmbr3,firewall=1,queues=4</span><br><span class="line">numa: 0</span><br><span class="line">ostype: l26</span><br><span class="line">scsi0: local-lvm:vm-101-disk-1,discard=on,iothread=1,size=128G,ssd=1</span><br><span class="line">scsihw: virtio-scsi-single</span><br><span class="line">smbios1: uuid=3e913d90-c284-47d7-881a-599013fa21a4</span><br><span class="line">sockets: 1</span><br><span class="line">vmgenid: aab228d8-bccc-46c1-b627-927271ad20b6</span><br></pre></td></tr></table></figure>


<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li>Overview of the Intel VT Virtualization Features, <em><a target="_blank" rel="noopener" href="https://www.thomas-krenn.com/en/wiki/Overview_of_the_Intel_VT_Virtualization_Features">https://www.thomas-krenn.com/en/wiki/Overview_of_the_Intel_VT_Virtualization_Features</a></em></li>
<li>How to Pass-through PCIe NICs with Proxmox VE on Intel and AMD, <em><a target="_blank" rel="noopener" href="https://www.servethehome.com/how-to-pass-through-pcie-nics-with-proxmox-ve-on-intel-and-amd/">https://www.servethehome.com/how-to-pass-through-pcie-nics-with-proxmox-ve-on-intel-and-amd/</a></em></li>
<li>Persisting SR-IOV virtual functions after reboot, <em><a target="_blank" rel="noopener" href="https://www.reddit.com/r/homelab/comments/hf12mv/persisting_sriov_virtual_functions_after_reboot/">https://www.reddit.com/r/homelab/comments/hf12mv/persisting_sriov_virtual_functions_after_reboot/</a></em></li>
<li>Chapter 11. Managing virtual devices, <em><a target="_blank" rel="noopener" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_and_managing_virtualization/managing-virtual-devices_configuring-and-managing-virtualization">https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8/html/configuring_and_managing_virtualization/managing-virtual-devices_configuring-and-managing-virtualization</a></em></li>
</ul>

        
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          


        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Homelab-Router-OPNsense-and-IPv6" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2024/11/01/Homelab-Router-OPNsense-and-IPv6/">Homelab Router OPNsense and IPv6</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2024-11-01T10:25:50.000Z" itemprop="datePublished">2024-11-01</time>
</span>
      
      
      
<a href="/blog/2024/11/01/Homelab-Router-OPNsense-and-IPv6/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Current IPv6 setting on TP-Link Router, connecting to <strong>Buddy Telco &#x2F; Aussie Broadband</strong> ISP.</p>
<p><img src="/blog/img/OPNsense%20-%20TP-Link%20IPv6.png" alt="OPNsense - TP-Link IPv6" title="OPNsense - TP-Link IPv6"></p>
<h2 id="Setup-OPNsense-VM"><a href="#Setup-OPNsense-VM" class="headerlink" title="Setup OPNsense VM"></a>Setup OPNsense VM</h2><p>Create a new VM for OPNsense in Proxmox:</p>
<p><img src="/blog/img/OPNsense%20-%20VM%20General.png" alt="OPNsense - VM General" title="OPNsense - VM General"></p>
<p><img src="/blog/img/OPNsense%20-%20VM%20OS.png" alt="OPNsense - VM OS" title="OPNsense - VM OS"></p>
<p><img src="/blog/img/OPNsense%20-%20VM%20System.png" alt="OPNsense - VM System" title="OPNsense - VM System"></p>
<p><img src="/blog/img/OPNsense%20-%20VM%20Disks.png" alt="OPNsense - VM Disks" title="OPNsense - VM Disks"></p>
<p><img src="/blog/img/OPNsense%20-%20VM%20CPU.png" alt="OPNsense - VM CPU" title="OPNsense - VM CPU"></p>
<p><img src="/blog/img/OPNsense%20-%20VM%20Memory.png" alt="OPNsense - VM Memory" title="OPNsense - VM Memory"></p>
<p><img src="/blog/img/OPNsense%20-%20VM%20Network%20WAN.png" alt="OPNsense - VM Network WAN" title="OPNsense - VM Network WAN"></p>
<p><img src="/blog/img/OPNsense%20-%20VM%20Network%20LAN.png" alt="OPNsense - VM Network LAN" title="OPNsense - VM Network LAN"></p>
<p><img src="/blog/img/OPNsense%20-%20VM%20Network%20OPT1.png" alt="OPNsense - VM Network OPT1" title="OPNsense - VM Network OPT1"></p>
<p><img src="/blog/img/OPNsense%20-%20VM%20In%20Proxmox.png" alt="OPNsense - VM In Proxmox" title="OPNsense - VM In Proxmox"></p>
<p><img src="/blog/img/OPNsense%20-%20Proxmox%20Network.png" alt="OPNsense - Proxmox Network" title="OPNsense - Proxmox Network"></p>
<h2 id="Setup-IPv6"><a href="#Setup-IPv6" class="headerlink" title="Setup IPv6"></a>Setup IPv6</h2><p>Step by step to enable IPv6 with <strong>Buddy Telco &#x2F; Aussie Broadband</strong> ISP.</p>
<p><img src="/blog/img/OPNsense%20-%20Interfaces%20Settings.png" alt="OPNsense - Interfaces Settings" title="OPNsense - Interfaces Settings"></p>
<p><img src="/blog/img/OPNsense%20-%20WAN.png" alt="OPNsense - WAN" title="OPNsense - WAN"></p>
<ul>
<li>Enable DHCP&#x2F;DHCPv6 for IPv4&#x2F;IPv6 Configuration Type</li>
<li>Set ISP’s <strong>Prefix delegation size</strong> to <code>48</code></li>
<li>Enable <strong>Send prefix hint</strong></li>
</ul>
<p><img src="/blog/img/OPNsense%20-%20Router%20Advertisements.png" alt="OPNsense - Router Advertisements" title="OPNsense - Router Advertisements"></p>
<ul>
<li>Set <strong>Router Advertisements</strong> to <code>Unmanaged</code></li>
<li>Set <strong>Router Priority</strong> to <code>Normal</code></li>
</ul>
<h2 id="Setup-OPNsense-Optional-Port"><a href="#Setup-OPNsense-Optional-Port" class="headerlink" title="Setup OPNsense Optional Port"></a>Setup OPNsense Optional Port</h2><p>For example, setup <strong>OPT1</strong> interface after <code>OPNsense</code> installed in <code>Proxmox</code>.</p>
<ul>
<li>Enable <strong>OPT1</strong> Interface</li>
<li>Select <strong>Static IPv4</strong> for IPv4 Configuration Type</li>
<li>Select <strong>Track Interface</strong> for IPv6 Configuration Type</li>
<li>IPv4 address set to <strong>192.168.2.1&#x2F;24</strong></li>
<li>IPv6 parent interface set to <strong>WAN</strong></li>
<li>IPv6 prefix ID set to <strong>0x1</strong>. <strong>0x0</strong> has been assigned to <strong>LAN</strong></li>
<li>Enable <strong>Allow manual adjustment of DHCPv6 and Router Advertisements</strong></li>
</ul>
<p><img src="/blog/img/OPNsense%20-%20OPT1%20Interface.png" alt="OPNsense - OPT1 Interface" title="OPNsense - OPT1 Interface"></p>
<ul>
<li>Enable DHCP server on the OPT1 interface</li>
<li>Set IP range from <strong>192.168.2.10</strong> to <strong>192.168.2.245</strong></li>
</ul>
<p><img src="/blog/img/OPNsense%20-%20OPT1%20DHCP.png" alt="OPNsense - OPT1 DHCP" title="OPNsense - OPT1 DHCP"></p>
<ul>
<li>Add Firewall Rule</li>
<li>Set TCP&#x2F;IP version</li>
<li>Select <strong>OPT1 net</strong> from dropdown menu as Source</li>
</ul>
<p><img src="/blog/img/OPNsense%20-%20OPT1%20Firewall%20Rule.png" alt="OPNsense - OPT1 Firewall Rule" title="OPNsense - OPT1 Firewall Rule"></p>
<ul>
<li>Setup Firewall Rule for IPv4 on <strong>OPT1</strong> interface, then</li>
<li>Setup Firewall Rule for IPv6 on <strong>OPT1</strong> interface</li>
</ul>
<p><img src="/blog/img/OPNsense%20-%20OPT1%20Firewall.png" alt="OPNsense - OPT1 Firewall" title="OPNsense - OPT1 Firewall"></p>
<h2 id="VLAN"><a href="#VLAN" class="headerlink" title="VLAN"></a>VLAN</h2><p>Setup Trusted and Untrusted VLAN.</p>
<p><img src="/blog/img/OPNsense%20-%20VLAN.png" alt="OPNsense - VLAN" title="OPNsense - VLAN"></p>
<p><img src="/blog/img/OPNsense%20-%20VLAN%20Interfaces.png" alt="OPNsense - VLAN Interfaces" title="OPNsense - VLAN Interfaces"></p>
<p><img src="/blog/img/OPNsense%20-%20Trusted%20VLAN.png" alt="OPNsense - Trusted VLAN" title="OPNsense - Trusted VLAN"></p>
<p><img src="/blog/img/OPNsense%20-%20Untrusted%20VLAN.png" alt="OPNsense - Untrusted VLAN" title="OPNsense - Untrusted VLAN"></p>
<p>Then,</p>
<ul>
<li>Set <strong>Router Advertisements</strong> to <code>Unmanaged</code></li>
<li>Set <strong>Router Priority</strong> to <code>Normal</code></li>
</ul>
<p>for both VLANs. </p>
<h2 id="Running"><a href="#Running" class="headerlink" title="Running"></a>Running</h2><p>After all the change made above, reboot <code>OPNsense</code> instance.</p>
<p><img src="/blog/img/OPNsense%20-%20Run%20In%20Proxmox.png" alt="OPNsense - Run In Proxmox" title="OPNsense - Run In Proxmox"></p>
<p><img src="/blog/img/OPNsense%20-%20Interfaces%20Overview.png" alt="OPNsense - Interfaces Overview" title="OPNsense - Interfaces Overview"></p>
<p><img src="/blog/img/OPNsense%20-%20Dashboard.png" alt="OPNsense - Dashboard" title="OPNsense - Dashboard"></p>
<h2 id="IPv6-Test"><a href="#IPv6-Test" class="headerlink" title="IPv6 Test"></a>IPv6 Test</h2><ul>
<li><em><a target="_blank" rel="noopener" href="https://test-ipv6.com/">https://test-ipv6.com/</a></em></li>
</ul>
<p><img src="/blog/img/OPNsense%20-%20Test%20IPv6.png" alt="OPNsense - Test IPv6" title="OPNsense - Test IPv6"></p>
<ul>
<li><em><a target="_blank" rel="noopener" href="https://ipv6-test.com/">https://ipv6-test.com/</a></em></li>
</ul>
<p><img src="/blog/img/OPNsense%20-%20IPv6%20Test.png" alt="OPNsense - IPv6 Test" title="OPNsense - Test Test"></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li>Virtualize OPNsense on Proxmox as Your Primary Router, <em><a target="_blank" rel="noopener" href="https://homenetworkguy.com/how-to/virtualize-opnsense-on-proxmox-as-your-primary-router/">https://homenetworkguy.com/how-to/virtualize-opnsense-on-proxmox-as-your-primary-router/</a></em></li>
<li>How to Configure IPv6 in Your Home Network with ISP such as Comcast Xfinity, <em><a target="_blank" rel="noopener" href="https://homenetworkguy.com/how-to/configure-ipv6-opnsense-with-isp-such-as-comcast-xfinity/">https://homenetworkguy.com/how-to/configure-ipv6-opnsense-with-isp-such-as-comcast-xfinity/</a></em></li>
<li>Beginner’s Guide to Set Up a Home Network Using OPNsense, <em><a target="_blank" rel="noopener" href="https://homenetworkguy.com/how-to/beginners-guide-to-set-up-home-network-using-opnsense/">https://homenetworkguy.com/how-to/beginners-guide-to-set-up-home-network-using-opnsense/</a></em></li>
<li>OPNsense Optional Port Configuration, <em><a target="_blank" rel="noopener" href="https://kb.protectli.com/kb/opnsense-optional-port-configuration/">https://kb.protectli.com/kb/opnsense-optional-port-configuration/</a></em></li>
<li>IPv6 setup, <em><a target="_blank" rel="noopener" href="https://docs.opnsense.org/manual/ipv6.html">https://docs.opnsense.org/manual/ipv6.html</a></em></li>
<li>Anyone have IPv6 working with OPNSense? <em><a target="_blank" rel="noopener" href="https://www.reddit.com/r/AussieBroadband/comments/10qldin/anyone_have_ipv6_working_with_opnsense/">https://www.reddit.com/r/AussieBroadband/comments/10qldin/anyone_have_ipv6_working_with_opnsense/</a></em>, <em><a target="_blank" rel="noopener" href="https://f001.backblazeb2.com/b2api/v1/b2_download_file_by_id?fileId=4_zd344e4de4b297a128d680f16_f1019c6ea32f55c8f_d20240526_m042719_c001_v0001101_t0001_u01716697639553">https://f001.backblazeb2.com/b2api/v1/b2_download_file_by_id?fileId=4_zd344e4de4b297a128d680f16_f1019c6ea32f55c8f_d20240526_m042719_c001_v0001101_t0001_u01716697639553</a></em></li>
<li>Common Router Settings (Part of the Aussie Broadband article), <em><a target="_blank" rel="noopener" href="https://whirlpool.net.au/wiki/aussie_broadband_ipv6_router_settings">https://whirlpool.net.au/wiki/aussie_broadband_ipv6_router_settings</a></em></li>
<li>Aussie Broadband IPv6 deployment journey, <em><a target="_blank" rel="noopener" href="https://2022.apricot.net/assets/files/APNT374/aussie-broadband-ipv6-deployment-journey.pdf">https://2022.apricot.net/assets/files/APNT374/aussie-broadband-ipv6-deployment-journey.pdf</a></em></li>
<li>IPv6 Chart &#x2F; IPv4 CIDR Chart, <em><a target="_blank" rel="noopener" href="https://www.ripe.net/media/documents/IPv6_Chart_2015.pdf">https://www.ripe.net/media/documents/IPv6_Chart_2015.pdf</a></em></li>
</ul>
<p><img src="/blog/img/OPNsense%20-%20IPv6%20Chart.png" alt="OPNsense - IPv6 Chart" title="OPNsense - IPv6 Chart"></p>
<p><img src="/blog/img/OPNsense%20-%20IPv4%20CIDR%20Chart.png" alt="OPNsense - IPv4 CIDR Chart" title="OPNsense - IPv4 CIDR Chart"></p>

        
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          


        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Turn-On-and-Turn-Off-Recall-in-Windows-11" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2024/10/26/Turn-On-and-Turn-Off-Recall-in-Windows-11/">Turn On and Turn Off Recall in Windows 11</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2024-10-25T14:15:03.000Z" itemprop="datePublished">2024-10-26</time>
</span>
      
      
      
<a href="/blog/2024/10/26/Turn-On-and-Turn-Off-Recall-in-Windows-11/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Turn On <strong>Recall</strong> feature in <code>Windows 11 24H2</code>, by running Widnows Power Shell as <strong>Administrator</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">PS C:\&gt; DISM /Online /Get-FeatureInfo /FeatureName:Recall</span><br><span class="line"></span><br><span class="line">Deployment Image Servicing and Management tool</span><br><span class="line">Version: 10.0.26100.1150</span><br><span class="line"></span><br><span class="line">Image Version: 10.0.26100.2033</span><br><span class="line"></span><br><span class="line">Feature Information:</span><br><span class="line"></span><br><span class="line">Feature Name : Recall</span><br><span class="line">Display Name : Recall</span><br><span class="line">Description : Recall application.</span><br><span class="line">Restart Required : Possible</span><br><span class="line">State : Enabled</span><br><span class="line"></span><br><span class="line">Custom Properties:</span><br><span class="line"></span><br><span class="line">(No custom properties found)</span><br><span class="line"></span><br><span class="line">The operation completed successfully.</span><br></pre></td></tr></table></figure>

<p>Turn Off <strong>Recall</strong> in <code>Windows 11 24H2</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PS C:\&gt; DISM /Online /Disable-Feature /FeatureName:Recall</span><br><span class="line"></span><br><span class="line">Deployment Image Servicing and Management tool</span><br><span class="line">Version: 10.0.26100.1150</span><br><span class="line"></span><br><span class="line">Image Version: 10.0.26100.2033</span><br><span class="line"></span><br><span class="line">Disabling feature(s)</span><br><span class="line">[==========================100.0%==========================]</span><br><span class="line">The operation completed successfully.</span><br></pre></td></tr></table></figure>

        
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          


        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-Running-latest-MacOS-Sequoia-in-VMWare-on-Windows-11" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2024/10/16/Running-latest-MacOS-Sequoia-in-VMWare-on-Windows-11/">Running latest MacOS Sequoia in VMware on Windows 11</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2024-10-16T05:06:59.000Z" itemprop="datePublished">2024-10-16</time>
</span>
      
      
      
<a href="/blog/2024/10/16/Running-latest-MacOS-Sequoia-in-VMWare-on-Windows-11/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>This is the step by step guide, the fastest and easiest way install and run latest <code>MacOS Sequoia 15.0.1</code> in <code>VMware Workstation Pro</code> on <code>Windows 11</code>.</p>
<p>Due to <code>MacOS Sequoia</code> has added detection whether OS is running in Virtual Machine, so it’s better install <code>MacOS Sonoma</code> at first, then upgrade to latest version <code>MacOS Sequoia</code>.</p>
<p><img src="/blog/img/VMware%20-%20Apple%20ID.png" alt="VMware - Apple ID" title="VMware - Apple ID"></p>
<ul>
<li>Build a bootable MacOS ISO image</li>
</ul>
<p>Do it on a Mac. </p>
<p>Clone <code>gibmasOS</code> repo <em><a target="_blank" rel="noopener" href="https://github.com/corpnewt/gibMacOS">https://github.com/corpnewt/gibMacOS</a></em> and run:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">$ ./gibMacOS.command</span><br><span class="line">#######################################################</span><br><span class="line">#                      gibMacOS                       #</span><br><span class="line">#######################################################</span><br><span class="line"></span><br><span class="line">Available Products:</span><br><span class="line"></span><br><span class="line">1. macOS Sequoia 15.0.1 (24A348)</span><br><span class="line">   - 072-01382 - Added 2024-10-03 21:26:40 - 14.48 GB</span><br><span class="line">2. macOS Ventura 13.7 (22H123)</span><br><span class="line">   - 062-78643 - Added 2024-09-16 17:44:05 - 12.22 GB</span><br><span class="line">3. macOS Sonoma 14.7 (23H124)</span><br><span class="line">   - 062-78824 - Added 2024-09-16 17:42:25 - 13.68 GB</span><br><span class="line">4. macOS Sequoia 15.0 (24A335)</span><br><span class="line">   - 062-78429 - Added 2024-09-16 17:30:21 - 14.48 GB</span><br><span class="line">5. macOS Monterey 12.7.6 (21H1320)</span><br><span class="line">   - 062-40406 - Added 2024-08-14 20:45:56 - 12.42 GB</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">24. macOS High Sierra 10.13.6 (17G66)</span><br><span class="line">   - 041-91758 - Added 2019-10-19 18:19:55 - 5.71 GB</span><br><span class="line">25. macOS Mojave 10.14.6 (18G103)</span><br><span class="line">   - 061-26589 - Added 2019-10-14 20:51:08 - 6.52 GB</span><br><span class="line">26. macOS Mojave 10.14.5 (18F2059)</span><br><span class="line">   - 061-26578 - Added 2019-10-14 20:38:26 - 6.52 GB</span><br><span class="line"></span><br><span class="line">M. Change Max-OS Version (Currently 12)</span><br><span class="line">C. Change Catalog (Currently publicrelease)</span><br><span class="line">I. Only Print URLs (Currently Off)</span><br><span class="line">S. Set Current Catalog to SoftwareUpdate Catalog</span><br><span class="line">L. Clear SoftwareUpdate Catalog</span><br><span class="line">R. Toggle Recovery-Only (Currently Off)</span><br><span class="line">U. Show Catalog URL</span><br><span class="line">Q. Quit</span><br><span class="line"></span><br><span class="line">Please select an option: 3</span><br><span class="line"></span><br><span class="line">Downloading InstallAssistant.pkg for 062-78824 - 14.7 macOS Sonoma (23H124)...</span><br><span class="line"></span><br><span class="line">1.35 GB/14.48 GB | =                    9.34% | 101.7 MB/s | 00:02:10 left</span><br><span class="line"></span><br><span class="line">Succeeded:</span><br><span class="line">  InstallAssistant.pkg</span><br><span class="line">  MajorOSInfo.pkg</span><br><span class="line">  com_apple_MobileAsset_MacSoftwareUpdate.plist</span><br><span class="line">  InstallInfo.plist</span><br><span class="line">  UpdateBrain.zip</span><br><span class="line"></span><br><span class="line">Failed:</span><br><span class="line">  None</span><br><span class="line"></span><br><span class="line">Files saved to:</span><br><span class="line">  /Users/terrence/Projects/gibMacOS/macOS Downloads/publicrelease/062-78824 - 14.7 macOS Sonoma (23H124)</span><br></pre></td></tr></table></figure>

<p>Run <code>InstallAssistant.pkg</code> from above MacOS download directory. It will be using to build ISO image.</p>
<p>Create a disk image with size 16GB:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hdiutil create -o /tmp/MacOS -size 16000m -volname MacOS -layout SPUD -fs HFS+J</span><br><span class="line">created: /tmp/MacOS.dmg</span><br></pre></td></tr></table></figure>

<p> Mount the disk image created above:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> $ hdiutil attach /tmp/MacOS.dmg -noverify -mountpoint /Volumes/MacOSISO</span><br><span class="line">/dev/disk6          	Apple_partition_scheme         	</span><br><span class="line">/dev/disk6s1        	Apple_partition_map            	</span><br><span class="line">/dev/disk6s2        	Apple_HFS                      	/Volumes/MacOSISO</span><br></pre></td></tr></table></figure>

<p>Create ISO image from <code>Install masOS app</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ sudo /Applications/Install\ macOS\ Sonoma.app/Contents/Resources/createinstallmedia --volume /Volumes/MacOSISO --nointeraction</span><br><span class="line">Erasing disk: 0%... 10%... 20%... 30%... 100%</span><br><span class="line">Copying essential files...</span><br><span class="line">Copying the macOS RecoveryOS...</span><br><span class="line">Making disk bootable...</span><br><span class="line">Copying to disk: 0%... 10%... 20%... 30%... 40%... 50%... 60%... 100%</span><br><span class="line">Install media now available at &quot;/Volumes/Install macOS Sonoma&quot;</span><br></pre></td></tr></table></figure>

<p>Unmount disk image and convert to an ISO image:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ hdiutil detach -force /Volumes/Install\ macOS\ Sonoma</span><br><span class="line">&quot;disk6&quot; ejected.</span><br><span class="line"></span><br><span class="line">$ ls -al /tmp/MacOS.dmg</span><br><span class="line">-rw-r--r--@ 1 terrence  wheel  16777216000 15 Oct 21:54 /tmp/MacOS.dmg</span><br><span class="line"></span><br><span class="line">$ hdiutil convert /tmp/MacOS.dmg -format UDTO -o /tmp/MacOS-Sonoma-14.7.cdr</span><br><span class="line">Reading Driver Descriptor Map (DDM : 0)…</span><br><span class="line">Reading Apple (Apple_partition_map : 1)…</span><br><span class="line">Reading  (Apple_Free : 2)…</span><br><span class="line">Reading disk image (Apple_HFS : 3)…</span><br><span class="line">........................................</span><br><span class="line">Elapsed Time: 19.139s</span><br><span class="line">Speed: 835.9MB/s</span><br><span class="line">Savings: 0.0%</span><br><span class="line">created: /tmp/MacOS-Sonoma-14.7.cdr</span><br><span class="line"></span><br><span class="line">$ mv /tmp/MacOS-Sonoma-14.7.cdr /tmp/MacOS-Sonoma-14.7.iso</span><br><span class="line"></span><br><span class="line">$ rm /tmp/MacOS.dmg</span><br></pre></td></tr></table></figure>


<ul>
<li>Install VMware Workstation Pro</li>
</ul>
<p>Download VMware Workstation Pro from e.g. <em><a target="_blank" rel="noopener" href="https://softwareupdate.vmware.com/cds/vmw-desktop/ws/17.6.1/24319023/windows/core/VMware-workstation-17.6.1-24319023.exe.tar">https://softwareupdate.vmware.com/cds/vmw-desktop/ws/17.6.1/24319023/windows/core/VMware-workstation-17.6.1-24319023.exe.tar</a></em></p>
<ul>
<li>Patch VMware Workstation Pro</li>
</ul>
<p>Clone <code>unlocker</code> <em><a target="_blank" rel="noopener" href="https://github.com/paolo-projects/unlocker">https://github.com/paolo-projects/unlocker</a></em> repo on Windows and enable <strong>Apple macOS</strong> option in <code>VMware Workstation Pro</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Projects\unlocker&gt; .\win-install.cmd</span><br><span class="line"></span><br><span class="line">Unlocker 3.0.2 for VMware Workstation</span><br><span class="line">=====================================</span><br><span class="line">(c) Dave Parsons 2011-18</span><br><span class="line"></span><br><span class="line">Set encoding parameters...</span><br><span class="line">Active code page: 850</span><br><span class="line"></span><br><span class="line">VMware is installed at: C:\Program Files (x86)\VMware\VMware Workstation\</span><br><span class="line">VMware product version: 17.6.1.24319023</span><br><span class="line"></span><br><span class="line">Stopping VMware services...</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Starting VMware services...</span><br><span class="line"></span><br><span class="line">Finished!</span><br></pre></td></tr></table></figure>

<p><img src="/blog/img/VMware%20-%20Apple%20macOS.png" alt="VMware - Apple macOS" title="VMware - Apple macOS"></p>
<ul>
<li>Add <code>VMware Tools</code></li>
</ul>
<p>Copy <code>darwin.iso</code> and <code>darwinPre15.iso</code> files extracted from <code>VMware Fusion</code> e.g. _<a target="_blank" rel="noopener" href="https://softwareupdate.vmware.com/cds/vmw-desktop/fusion/12.2.5/20904517/x86/core/com.vmware.fusion.zip.tar">https://softwareupdate.vmware.com/cds/vmw-desktop/fusion/12.2.5/20904517/x86/core/com.vmware.fusion.zip.tar</a> _ into <code>VMware Workstation Pro</code> directory:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Projects\unlocker\tools\darwin.iso -&gt; C:\Program Files (x86)\VMware\VMware Workstation\darwin.iso</span><br><span class="line">C:\Projects\unlocker\tools\darwinPre15.iso -&gt; C:\Program Files (x86)\VMware\VMware Workstation\darwinPre15.iso</span><br></pre></td></tr></table></figure>


<ul>
<li>Create Virtual Machine for MacOS 14 Sonoma and update the settings</li>
</ul>
<p>Add: </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smc.version = &quot;0&quot;</span><br></pre></td></tr></table></figure>

<p>into <strong>MacOS Sonoma.vmx</strong> file.</p>
<p>Clone <code>GenSMBIOS</code> repo <em><a target="_blank" rel="noopener" href="https://github.com/corpnewt/GenSMBIOS">https://github.com/corpnewt/GenSMBIOS</a></em> and generate serial number on Windows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">$ ./GenSMBIOS.bat</span><br><span class="line">#######################################################</span><br><span class="line">#                     GenSMBIOS                       #</span><br><span class="line">#######################################################</span><br><span class="line"></span><br><span class="line">MacSerial not found!</span><br><span class="line">Remote Version v2.1.8</span><br><span class="line">Current plist: None</span><br><span class="line">Plist type:    Unknown</span><br><span class="line"></span><br><span class="line">1. Install/Update MacSerial</span><br><span class="line">2. Select config.plist</span><br><span class="line">3. Generate SMBIOS</span><br><span class="line">4. Generate UUID</span><br><span class="line">5. Generate ROM</span><br><span class="line">6. List Current SMBIOS</span><br><span class="line">7. Generate ROM With SMBIOS (Currently Enabled)</span><br><span class="line"></span><br><span class="line">Q. Quit</span><br><span class="line"></span><br><span class="line">Please select an option:  3</span><br><span class="line"></span><br><span class="line">Please type the SMBIOS to gen and the number</span><br><span class="line">of times to generate [max 20] (i.e. iMac18,3 5): MacBookPro16,4</span><br><span class="line"></span><br><span class="line">Type:         MacBookPro16,4</span><br><span class="line">Serial:       C..........T</span><br><span class="line">Board Serial: C0.............FB</span><br><span class="line">SmUUID:       A0D50403-F256-4E17-A2EC-29964D889A1D</span><br><span class="line">Apple ROM:    6..........7</span><br></pre></td></tr></table></figure>

<p>Copy <strong>Serial</strong>, <strong>Board Serial</strong> and <strong>Apple ROM</strong> number, apply to:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">board-id = &quot;Mac-A61BADE1FDAD7B05&quot;</span><br><span class="line">hw.model.reflectHost = &quot;FALSE&quot;</span><br><span class="line">hw.model = &quot;MacBookPro16,4&quot;</span><br><span class="line">serialNumber.reflectHost = &quot;FALSE&quot;</span><br><span class="line">serialNumber = &quot;C..........T&quot;</span><br><span class="line">smbios.reflectHost = &quot;FALSE&quot;</span><br><span class="line">efi.nvram.var.ROM.reflectHost = &quot;FALSE&quot;</span><br><span class="line">efi.nvram.var.MLB.reflectHost = &quot;FALSE&quot;</span><br><span class="line">efi.nvram.var.ROM = &quot;6..........7&quot;</span><br><span class="line">efi.nvram.var.MLB = &quot;C0.............FB&quot;</span><br></pre></td></tr></table></figure>

<p>then add above block into <strong>MacOS Sonoma.vmx</strong> file.</p>
<p>Based on Apple Ethernet MAC Address range <em><a target="_blank" rel="noopener" href="https://hwaddress.com/company/apple-inc/">https://hwaddress.com/company/apple-inc/</a></em>, change and add network settings from:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ethernet0.addressType = &quot;generated&quot;</span><br></pre></td></tr></table></figure>

<p>to:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ethernet0.addressType = &quot;static&quot;</span><br><span class="line">ethernet0.address = &quot;00:21:E9:c0:92:76&quot;</span><br><span class="line">ethernet0.checkMacAddress = &quot;FALSE&quot;</span><br></pre></td></tr></table></figure>

<p>in <strong>MacOS Sonoma.vmx</strong> file.</p>
<p><img src="/blog/img/VMware%20-%20MacOS%20Sonoma.png" alt="VMware - MacOS Sonoma" title="VMware - MacOS Sonoma"></p>
<ul>
<li>Mount MacOS ISO image and install</li>
</ul>
<p><img src="/blog/img/VMware%20-%20MacOS%20Sonoma%20settings.png" alt="VMware - MacOS Sonoma settings" title="VMware - MacOS Sonoma settings"></p>
<p><strong>DON’T enable Location Service</strong> during the installation! Otherwise, you can’t setup Time Zone, Date Time based on your area. You can login with your <strong>Apple ID</strong> during the installation.</p>
<p><img src="/blog/img/VMware%20-%20Apple%20ID%20login.png" alt="VMware - Apple ID login" title="VMware - Apple ID login"></p>
<ul>
<li>Install <code>VMware Tools</code></li>
</ul>
<p>After MacOS installed and VM restarted, mount <code>darwin.iso</code> and install <code>VMware Tools</code>. Then Display Memory in MacOS becomes 128 MB, and support the <strong>Full Screen</strong> mode.</p>
<ul>
<li>Upgrade MacOS</li>
</ul>
<p>After <code>MacOS Sonoma</code> installed, make sure everything is OK, then copy the whole <strong>MacOS Sonoma</strong> directory to a new directory <strong>MacOS Sequoia (Upgraded)</strong>. Open the new directory in VMware, and select <strong>I copied it</strong>, then you can upgrade MacOS to latest verion in <em>System Settings -&gt; Software Update</em>.</p>
<ul>
<li>Run MacOS in <code>VMware Player</code>:</li>
</ul>
<p><img src="/blog/img/VMware%20-%20Player.png" alt="VMware - Player" title="VMware - Player"></p>
<p><img src="/blog/img/VMware%20-%20In%20Action.png" alt="VMware - In Action" title="VMware - In Action"></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li>How to Install macOS Sequoia on VMware on Windows PC, <em><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=0ohUXE0Pj_U">https://www.youtube.com/watch?v=0ohUXE0Pj_U</a></em></li>
<li>The Definitive Guide to Running MacOS in Proxmox, <em><a target="_blank" rel="noopener" href="https://klabsdev.com/definitive-guide-to-running-macos-in-proxmox/">https://klabsdev.com/definitive-guide-to-running-macos-in-proxmox/</a></em></li>
<li>List of Mac BoardID, DeviceID, Model Identifiers &amp; Machine Models, <em><a target="_blank" rel="noopener" href="https://mrmacintosh.com/list-of-mac-boardid-deviceid-model-identifiers-machine-models/">https://mrmacintosh.com/list-of-mac-boardid-deviceid-model-identifiers-machine-models/</a></em></li>
</ul>

        
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          


        </div>
      
      
      
    </footer>
  </div>
</article>


  <article id="post-How-to-access-Ollama-runs-on-localhost-from-internet" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/blog/2024/10/12/How-to-access-Ollama-runs-on-localhost-from-internet/">How to access Ollama runs on localhost from internet</a>
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2024-10-12T11:53:37.000Z" itemprop="datePublished">2024-10-12</time>
</span>
      
      
      
<a href="/blog/2024/10/12/How-to-access-Ollama-runs-on-localhost-from-internet/#comments" class="article-comment-link">
  
  <i class="fa fa-commt"></i>
  Guestbook
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>By default, <code>Ollama</code> is only accessible from <strong>localhost</strong>. CORS error and HTTP 403 returned if try to invoke from other hosts.</p>
<p>To enable <code>Ollama</code> can be visited from hosts on intranet, run:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ launchctl setenv OLLAMA_HOST &quot;0.0.0.0&quot;</span><br></pre></td></tr></table></figure>

<p>in MacOS. Then restart <code>Ollama</code>. Then invoke it from hosts on intranet.</p>
<p>To enable <code>Ollama</code> can be visited from internet, with the help from <code>ngrok</code>, run:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ ngrok http 11434</span><br><span class="line"></span><br><span class="line">ngrok                                                     (Ctrl+C to quit)</span><br><span class="line"></span><br><span class="line">Session Status  online</span><br><span class="line">Account         Terrence Miao (Plan: Free)</span><br><span class="line">Version         3.17.0</span><br><span class="line">Region          Australia (au)</span><br><span class="line">Web Interface   http://127.0.0.1:4040</span><br><span class="line">Forwarding      https://294b-2403-5802-1c44-0-341c-aae8-a501-8b73.ngrok-free.app -&gt; http://localhost:11434</span><br><span class="line"></span><br><span class="line">Connections     ttl     opn     rt1     rt5     p50     p90</span><br><span class="line">                0       0       0.00    0.00    0.00    0.00</span><br></pre></td></tr></table></figure>

<p>Then can visit <code>Ollama</code> on <strong>localhost</strong> from internet. <code>11434</code> is default port of <code>Ollama</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">$ curl --location &#x27;https://294b-2403-5802-1c44-0-341c-aae8-a501-8b73.ngrok-free.app/v1/models&#x27;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;object&quot;: &quot;list&quot;,</span><br><span class="line">    &quot;data&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: &quot;codellama:latest&quot;,</span><br><span class="line">            &quot;object&quot;: &quot;model&quot;,</span><br><span class="line">            &quot;created&quot;: 1728736149,</span><br><span class="line">            &quot;owned_by&quot;: &quot;library&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: &quot;deepseek-coder-v2:latest&quot;,</span><br><span class="line">            &quot;object&quot;: &quot;model&quot;,</span><br><span class="line">            &quot;created&quot;: 1728735883,</span><br><span class="line">            &quot;owned_by&quot;: &quot;library&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: &quot;mxbai-embed-large:latest&quot;,</span><br><span class="line">            &quot;object&quot;: &quot;model&quot;,</span><br><span class="line">            &quot;created&quot;: 1713401203,</span><br><span class="line">            &quot;owned_by&quot;: &quot;library&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: &quot;nomic-embed-text:latest&quot;,</span><br><span class="line">            &quot;object&quot;: &quot;model&quot;,</span><br><span class="line">            &quot;created&quot;: 1708780687,</span><br><span class="line">            &quot;owned_by&quot;: &quot;library&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To write some code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">$ curl --location &#x27;https://294b-2403-5802-1c44-0-341c-aae8-a501-8b73.ngrok-free.app/v1/chat/completions&#x27; \</span><br><span class="line">--header &#x27;Content-Type: application/json&#x27; \</span><br><span class="line">--data &#x27;&#123;</span><br><span class="line">    &quot;model&quot;: &quot;deepseek-coder-v2&quot;,</span><br><span class="line">    &quot;messages&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;role&quot;: &quot;system&quot;,</span><br><span class="line">            &quot;content&quot;: &quot;You are a helpful assistant.&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;role&quot;: &quot;user&quot;,</span><br><span class="line">            &quot;content&quot;: &quot;Write a function that outputs the fibonacci sequence in TypeScript.&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;&#x27;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;id&quot;: &quot;chatcmpl-174&quot;,</span><br><span class="line">  &quot;object&quot;: &quot;chat.completion&quot;,</span><br><span class="line">  &quot;created&quot;: 1728738926,</span><br><span class="line">  &quot;model&quot;: &quot;deepseek-coder-v2&quot;,</span><br><span class="line">  &quot;system_fingerprint&quot;: &quot;fp_ollama&quot;,</span><br><span class="line">  &quot;choices&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;index&quot;: 0,</span><br><span class="line">      &quot;message&quot;: &#123;</span><br><span class="line">        &quot;role&quot;: &quot;assistant&quot;,</span><br><span class="line">        &quot;content&quot;: &quot;</span><br><span class="line">        Certainly! Below is a TypeScript function that outputs the Fibonacci sequence up to a specified number of terms:</span><br><span class="line"></span><br><span class="line">        This function starts with the initial terms of the Fibonacci sequence `[0, 1]` and then iteratively calculates each subsequent term</span><br><span class="line">        by summing the two preceding terms. The function returns an array containing the first `n` terms of the Fibonacci sequence.</span><br><span class="line">        &quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;finish_reason&quot;: &quot;stop&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;usage&quot;: &#123;</span><br><span class="line">    &quot;prompt_tokens&quot;: 29,</span><br><span class="line">    &quot;completion_tokens&quot;: 243,</span><br><span class="line">    &quot;total_tokens&quot;: 272</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function fibonacciSequence(n: number): number[] &#123;</span><br><span class="line">  if (n &lt;= 0) return [];</span><br><span class="line">  if (n === 1) return [0];</span><br><span class="line"></span><br><span class="line">  const result: number[] = [0, 1];</span><br><span class="line"></span><br><span class="line">  for (let i = 2; i &lt; n; i++) &#123;</span><br><span class="line">    result.push(result[i - 1] + result[i - 2]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Example usage: console.log(fibonacciSequence(10));</span><br><span class="line">// Output: [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]</span><br></pre></td></tr></table></figure>

<p>Check <code>Ollama</code> log:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tail -f ~/.ollama/logs/server.log</span><br></pre></td></tr></table></figure>

<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li>Ollama FAQ, <em><a target="_blank" rel="noopener" href="https://github.com/ollama/ollama/blob/main/docs/faq.md">https://github.com/ollama/ollama/blob/main/docs/faq.md</a></em></li>
</ul>

        
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
          


        </div>
      
      
      
    </footer>
  </div>
</article>



    <nav id="page-nav">

<span class="page-number current">1</span><a class="page-number" href="/blog/page/2/">2</a><a class="page-number" href="/blog/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/12/">12</a><a class="extend next" rel="next" href="/blog/page/2/">Next</a>
</nav>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-posts"></i> Recent</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2024/12/21/How-to-install-and-run-ZeroTier-client-on-OpenWrt/">How to install and run ZeroTier client on OpenWrt</a>
          </li>
        
          <li>
            <a href="/blog/2024/12/05/Connecting-OpenWRT-to-internet/">Connecting OpenWRT to internet</a>
          </li>
        
          <li>
            <a href="/blog/2024/12/03/Running-OpenWRT-on-Proxmox/">Running OpenWRT on Proxmox</a>
          </li>
        
          <li>
            <a href="/blog/2024/11/25/Fixing-Multimedia-Audio-Controller-driver-missing-issue-in-Windows-11/">Fixing Multimedia Audio Controller driver missing issue in Windows 11</a>
          </li>
        
          <li>
            <a href="/blog/2024/11/21/Setting-up-DNS-Server-in-OPNsense/">Setting up DNS Server in OPNsense</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-archive"></i> Archive</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2024/">2024</a><span class="archive-list-count">29</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2023/">2023</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2022/">2022</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2021/">2021</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2020/">2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/">2019</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/">2018</a><span class="archive-list-count">31</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2017/">2017</a><span class="archive-list-count">25</span></li></ul>
    </div>
  </div>


  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-link"></i> Blogroll</h3>
    <div class="widget">
      <ul>
      
        <li>
          <a target="_blank" rel="noopener" href="https://www.linkedin.com/in/terrencemiao/">LinkedIn</a>
        </li>
      
        <li>
          <a target="_blank" rel="noopener" href="https://github.com/TerrenceMiao">GitHub</a>
        </li>
      
        <li>
          <a target="_blank" rel="noopener" href="https://twitter.com/TerrenceMiao">Twitter</a>
        </li>
      
      </ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <a id="totop" href="#top"></a>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      <p>
        <a href="/blog/sitemap.xml">Site Map</a>
        <span> | </span><a href="/blog/atom.xml">Subscribe to this site</a>
        <span> | </span><a href="/blog/about/">Contact the blogger</a>
      </p>
      
        <p>
          <i class="fa fa-visitors"></i>
          <i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>
          ，
          <i class="fa fa-views"></i>
          <i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>
        </p>
      
      <p>
        <span>Copyright &copy; 2024 Terrence Miao.</span>
        <span>Theme by <a href="https://github.com/chaooo/hexo-theme-BlueLake/" target="_blank">BlueLake.</a></span>
        <span>Powered by <a href="https://hexo.io/" target="_blank">Hexo.</a></span>
      </p>
    </div>
  </div>
</footer>

    </div>
  </div>
  
<script src="/blog/js/jquery-3.4.1.min.js"></script>


<script src="/blog/js/search.json.js"></script>


  
<script src="/blog/fancybox/jquery.fancybox.min.js"></script>




<script src="/blog/js/script.js"></script>






  
<script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>








  



  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>
  <script src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML" async type="text/javascript"></script>

</body>
</html>